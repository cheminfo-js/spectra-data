!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.spectraData=i():t.spectraData=i()}(this,function(){return function(t){function i(o){if(r[o])return r[o].exports;var e=r[o]={exports:{},id:o,loaded:!1};return t[o].call(e.exports,e,e.exports,i),e.loaded=!0,e.exports}var r={};return i.m=t,i.c=r,i.p="",i(0)}([function(t,i,r){"use strict";i.SD=r(1),i.NMR=r(8),i.NMR2D=r(50),i.ACS=r(54),i.JAnalyzer=r(10)},function(t,i,r){"use strict";function o(t){this.DATACLASS_XY=1,this.DATACLASS_PEAK=2,this.sd=t,this.activeElement=0}var e=r(2),n=r(3),s=r(5),a=r(7);o.fromJcamp=function(t,i){i=i||{xy:!0,keepSpectra:!0,keepRecordsRegExp:/^.+$/};var r=n.convert(t,i);return new o(r)},o.prototype.setActiveElement=function(t){this.activeElement=t},o.prototype.getActiveElement=function(){return this.activeElement},o.prototype.getXUnits=function(){return this.getSpectrum().xUnit},o.prototype.setXUnits=function(t){this.getSpectrum().xUnit=t},o.prototype.getYUnits=function(){return this.getSpectrum().yUnit},o.prototype.getSpectraVariable=function(t){return this.sd.ntuples[t]},o.prototype.getNbPoints=function(t){return this.getSpectrumData(t).y.length},o.prototype.getFirstX=function(t){return t=t||this.activeElement,this.sd.spectra[t].firstX},o.prototype.setFirstX=function(t,i){i=i||this.activeElement,this.sd.spectra[i].firstX=t},o.prototype.getLastX=function(t){return t=t||this.activeElement,this.sd.spectra[t].lastX},o.prototype.setLastX=function(t,i){i=i||this.activeElement,this.sd.spectra[i].lastX=t},o.prototype.getFirstY=function(t){return t=t||this.activeElement,this.sd.spectra[t].firstY},o.prototype.setFirstY=function(t,i){i=i||this.activeElement,this.sd.spectra[i].firstY=t},o.prototype.getLastY=function(t){return t=t||this.activeElement,this.sd.spectra[t].lastY},o.prototype.setLastY=function(t,i){i=i||this.activeElement,this.sd.spectra[i].lastY=t},o.prototype.setDataClass=function(t){t==this.DATACLASS_PEAK&&(this.getSpectrum().isPeaktable=!0,this.getSpectrum().isXYdata=!1),t==this.DATACLASS_XY&&(this.getSpectrum().isXYdata=!0,this.getSpectrum().isPeaktable=!1)},o.prototype.isDataClassPeak=function(){return this.getSpectrum().isPeaktable?this.getSpectrum().isPeaktable:!1},o.prototype.isDataClassXY=function(){return this.getSpectrum().isXYdata?this.getSpectrum().isXYdata:!1},o.prototype.setDataType=function(t){this.getSpectrum().dataType=t},o.prototype.getDataType=function(){return this.getSpectrum().dataType},o.prototype.getSpectrumData=function(t){return t=t||this.activeElement,this.sd.spectra[t].data[0]},o.prototype.getSpectrum=function(t){return t=t||this.activeElement,this.sd.spectra[t]},o.prototype.getNbSubSpectra=function(){return this.sd.spectra.length},o.prototype.getXData=function(t){return this.getSpectrumData(t).x},o.prototype.getYData=function(t){return this.getSpectrumData(t).y},o.prototype.getX=function(t){return this.getXData()[t]},o.prototype.getY=function(t){return this.getYData()[t]},o.prototype.getXYData=function(t){return[this.getXData(t),this.getYData(t)]},o.prototype.getTitle=function(t){return this.getSpectrum(t).title},o.prototype.setTitle=function(t,i){this.getSpectrum(i).title=t},o.prototype.getMinY=function(t){return e.min(this.getYData(t))},o.prototype.getMaxY=function(t){return e.max(this.getYData(t))},o.prototype.getMinMaxY=function(t){return e.minMax(this.getYData(t))},o.prototype.getNoiseLevel=function(){var t=0,i=0,r=this.getYData(),o=this.getNbPoints(),e=0;for(e=0;o>e;e++)t+=r[e];t/=this.getNbPoints();var n=new Array(o);for(e=0;o>e;e++)n[e]=Math.abs(r[e]-t);return n.sort(),i=o%2==1?n[(o-1)/2]/.6745:.5*(n[o/2]+n[o/2-1])/.6745,i*this.getNMRPeakThreshold(this.getNucleus(1))},o.prototype.arrayPointToUnits=function(t){return this.getFirstX()-t*(this.getFirstX()-this.getLastX())/(this.getNbPoints()-1)},o.prototype.unitsToArrayPoint=function(t){if(this.isDataClassXY())return Math.round((this.getFirstX()-t)*(-1/this.getDeltaX()));if(this.isDataClassPeak()){var i,r=0,o=this.getNbPoints()-1,e=0;if(this.getFirstX()>this.getLastX()){if(o=0,e=this.getNbPoints()-1,t>this.getFirstX())return this.getNbPoints();if(t<this.getLastX())return-1}else{if(t<this.getFirstX())return-1;if(t>this.getLastX())return this.getNbPoints()}for(;Math.abs(o-e)>1;){if(i=Math.round(Math.floor((o+e)/2)),this.getX(i)==t)return i;this.getX(i)>t?o=i:e=i}return r=e,Math.abs(this.getX(e)-t)>Math.abs(this.getX(o)-t)&&(r=o),r}return 0},o.prototype.getDeltaX=function(){return(this.getLastX()-this.getFirstX())/(this.getNbPoints()-1)},o.prototype.setMinMax=function(t,i){for(var r=this.getYData(),o=e.minMax(r),n=(i-t)/(o.max-o.min),s=0;s<r.length;s++)r[s]=(r[s]-o.min)*n+t},o.prototype.setMin=function(t){for(var i=this.getYData(),r=e.min(i),o=t/r,n=0;n<i.length;n++)i[n]*=o},o.prototype.setMax=function(t){for(var i=this.getYData(),r=e.max(i),o=t/r,n=0;n<i.length;n++)i[n]*=o},o.prototype.YShift=function(t){var i=this.getSpectrumData().y,r=this.getNbPoints(),o=0;for(o=0;r>o;o++)i[o]+=t;this.getSpectrum().firstY+=t,this.getSpectrum().lastY+=t},o.prototype.shift=function(t){for(var i=0;i<this.getNbSubSpectra();i++){this.setActiveElement(i);var r=this.getSpectrumData().x,o=this.getNbPoints(),i=0;for(i=0;o>i;i++)r[i]+=t;this.getSpectrum().firstX+=t,this.getSpectrum().lastX+=t}},o.prototype.fillWith=function(t,i,r){var o,e,n,s,a;if(t>i){var o=t;t=i,i=o}for(var l=0;l<this.getNbSubSpectra();l++)for(this.setActiveElement(l),s=this.getXData(),a=this.getYData(),e=this.unitsToArrayPoint(t),n=this.unitsToArrayPoint(i),e>n&&(o=e,e=n,n=o),0>e&&(e=0),n>=this.getNbPoints&&(n=this.getNbPoints-1),l=e;n>=l;l++)a[l]=r},o.prototype.suppressZone=function(t,i){var r,o,e,n,s;if(t>i){var r=t;t=i,i=r}for(var a=0;a<this.getNbSubSpectra();a++)for(this.setActiveElement(a),n=this.getXData(),s=this.getYData(),o=this.unitsToArrayPoint(t),e=this.unitsToArrayPoint(i),o>e&&(r=o,o=e,e=r),0>o&&(o=0),e>=this.getNbPoints&&(e=this.getNbPoints-1),a=e;a>=o;a--)s.splice(a,1),n.splice(a,1);this.setDataClass(this.DATACLASS_PEAK)},o.prototype.simplePeakPicking=function(t){},o.prototype.getMaxPeak=function(){for(var t=this.getSpectraDataY(),i=t[0],r=0,o=0;o<t.length;o++)i<t[o]&&(i=t[o],r=o);return[this.getX(r),i]},o.prototype.getParamDouble=function(t,i){var r=this.sd.info[t];return r||(r=i),r},o.prototype.getParamString=function(t,i){var r=this.sd.info[t];return r||(r=i),r+""},o.prototype.getParamInt=function(t,i){var r=this.sd.info[t];return r||(r=i),r},o.prototype.getParam=function(t,i){var r=this.sd.info[t];return r||(r=i),r},o.prototype.containsParam=function(t){return this.sd.info[t]?!0:!1},o.prototype.getSpectraDataY=function(){return this.getYData()},o.prototype.getSpectraDataX=function(){return this.getXData()},o.prototype.resetMinMax=function(){},o.prototype.putParam=function(t,i){this.sd.info[t]=i},o.prototype.getArea=function(t,i){var r=this.unitsToArrayPoint(t),o=this.unitsToArrayPoint(i),e=0;if(r>o){var n=r;r=o,o=n}r=0>r?0:r,o=o>=this.getNbPoints()?this.getNbPoints()-1:o;for(var s=r;o>s;s++)e+=this.getY(s);return e*Math.abs(this.getDeltaX())},o.prototype.getVector=function(t,i,r){var o=this.getSpectraDataX(),e=this.getSpectraDataY(),n=0,s=o.length-1,a=1,l=!1;if(o[0]>o[1]&&(a=-1,n=o.length-1,s=0),t>i){var u=t;t=i,i=u,l=!0}if(o[n]>i||o[s]<t)return[];for(;o[n]<t;)n+=a;for(;o[s]>i;)s-=a;var h=Math.abs(s-n)+1;r||(r=h);var f=new Array(r),c=new Array(r),p=0;-1==a&&(p=r-1);for(var m=h/r,g=n-a,y=0;r>y;y++)g+=Math.round(m*a),f[p]=o[g],c[p]=e[g],p+=a;return[f,c]},o.prototype.is2D=function(){return"undefined"==typeof this.sd.twoD?!1:this.sd.twoD},o.prototype.toJcamp=function(t){var i={encode:"DIFDUP",yFactor:1,type:"SIMPLE",keep:[]};return t=a({},i,t),s.convert(this,t.encode,t.yFactor,t.type,t.keep)},t.exports=o},function(t,i){"use strict";function r(t,i){return t-i}i.sum=function o(t){for(var o=0,i=0;i<t.length;i++)o+=t[i];return o},i.max=function e(t){for(var e=-(1/0),i=t.length,r=0;i>r;r++)t[r]>e&&(e=t[r]);return e},i.min=function n(t){for(var n=1/0,i=t.length,r=0;i>r;r++)t[r]<n&&(n=t[r]);return n},i.minMax=function(t){for(var i=1/0,r=-(1/0),o=t.length,e=0;o>e;e++)t[e]<i&&(i=t[e]),t[e]>r&&(r=t[e]);return{min:i,max:r}},i.arithmeticMean=function(t){for(var i=0,r=t.length,o=0;r>o;o++)i+=t[o];return i/r},i.mean=i.arithmeticMean,i.geometricMean=function(t){for(var i=1,r=t.length,o=0;r>o;o++)i*=t[o];return Math.pow(i,1/r)},i.logMean=function(t){for(var i=0,r=t.length,o=0;r>o;o++)i+=Math.log(t[o]);return i/r},i.grandMean=function(t,i){for(var r=0,o=0,e=t.length,n=0;e>n;n++)r+=i[n]*t[n],o+=i[n];return r/o},i.truncatedMean=function(t,i,o){void 0===o&&(o=!1),o||(t=t.slice().sort(r));for(var e=t.length,n=Math.floor(e*i),s=0,a=n;e-n>a;a++)s+=t[a];return s/(e-2*n)},i.harmonicMean=function(t){for(var i=0,r=t.length,o=0;r>o;o++){if(0===t[o])throw new RangeError("value at index "+o+"is zero");i+=1/t[o]}return r/i},i.contraHarmonicMean=function(t){for(var i=0,r=0,o=t.length,e=0;o>e;e++)i+=t[e]*t[e],r+=t[e];if(0>r)throw new RangeError("sum of values is negative");return i/r},i.median=function(t,i){void 0===i&&(i=!1),i||(t=t.slice().sort(r));var o=t.length,e=Math.floor(o/2);return o%2===0?.5*(t[e-1]+t[e]):t[e]},i.variance=function(t,r){void 0===r&&(r=!0);for(var o=i.mean(t),e=0,n=t.length,s=0;n>s;s++){var a=t[s]-o;e+=a*a}return r?e/(n-1):e/n},i.standardDeviation=function(t,r){return Math.sqrt(i.variance(t,r))},i.standardError=function(t){return i.standardDeviation(t)/Math.sqrt(t.length)},i.quartiles=function(t,o){"undefined"==typeof o&&(o=!1),o||(t=t.slice(),t.sort(r));var e=t.length/4,n=t[Math.ceil(e)-1],s=i.median(t,!0),a=t[Math.ceil(3*e)-1];return{q1:n,q2:s,q3:a}},i.pooledStandardDeviation=function(t,r){return Math.sqrt(i.pooledVariance(t,r))},i.pooledVariance=function(t,r){"undefined"==typeof r&&(r=!0);for(var o=0,e=0,n=t.length,s=0;n>s;s++){var a=t[s],l=i.variance(a);o+=(a.length-1)*l,e+=r?a.length-1:a.length}return o/e},i.mode=function(t){var i,r=t.length,o=new Array(r);for(i=0;r>i;i++)o[i]=0;var e=new Array(r),n=0;for(i=0;r>i;i++){var s=e.indexOf(t[i]);s>=0?o[s]++:(e[n]=t[i],o[n]=1,n++)}var a=0,l=0;for(i=0;n>i;i++)o[i]>a&&(a=o[i],l=i);return e[l]},i.covariance=function(t,r,o){"undefined"==typeof o&&(o=!0);var e=i.mean(t),n=i.mean(r);if(t.length!==r.length)throw"Vectors do not have the same dimensions";for(var s=0,a=t.length,l=0;a>l;l++){var u=t[l]-e,h=r[l]-n;s+=u*h}return o?s/(a-1):s/a},i.skewness=function(t,r){"undefined"==typeof r&&(r=!0);for(var o=i.mean(t),e=0,n=0,s=t.length,a=0;s>a;a++){var l=t[a]-o;e+=l*l,n+=l*l*l}var u=e/s,h=n/s,f=h/Math.pow(u,1.5);if(r){var c=Math.sqrt(s*(s-1)),p=s-2;return c/p*f}return f},i.kurtosis=function(t,r){"undefined"==typeof r&&(r=!0);for(var o=i.mean(t),e=t.length,n=0,s=0,a=0;e>a;a++){var l=t[a]-o;n+=l*l,s+=l*l*l*l}var u=n/e,h=s/e;if(r){var f=n/(e-1),c=e*(e+1)/((e-1)*(e-2)*(e-3)),p=s/(f*f),m=(e-1)*(e-1)/((e-2)*(e-3));return c*p-3*m}return h/(u*u)-3},i.entropy=function(t,i){"undefined"==typeof i&&(i=0);for(var r=0,o=t.length,e=0;o>e;e++)r+=t[e]*Math.log(t[e]+i);return-r},i.weightedMean=function(t,i){for(var r=0,o=t.length,e=0;o>e;e++)r+=t[e]*i[e];return r},i.weightedStandardDeviation=function(t,r){return Math.sqrt(i.weightedVariance(t,r))},i.weightedVariance=function(t,r){for(var o=i.weightedMean(t,r),e=0,n=t.length,s=0,a=0,l=0;n>l;l++){var u=t[l]-o,h=r[l];e+=h*(u*u),a+=h,s+=h*h}return e*(a/(a*a-s))},i.center=function(t,r){"undefined"==typeof r&&(r=!1);var o=t;r||(o=t.slice());for(var e=i.mean(o),n=o.length,s=0;n>s;s++)o[s]-=e},i.standardize=function(t,r,o){"undefined"==typeof r&&(r=i.standardDeviation(t)),"undefined"==typeof o&&(o=!1);for(var e=t.length,n=o?t:new Array(e),s=0;e>s;s++)n[s]=t[s]/r;return n},i.cumulativeSum=function(t){var i=t.length,r=new Array(i);r[0]=t[0];for(var o=1;i>o;o++)r[o]=r[o-1]+t[o];return r}},function(t,i,r){"use strict";function o(){function t(t){for(var i=t.length,r=new Array(i),o=0;i>o;o++)r[o]=parseFloat(t[o]);return r}function i(){}function r(r,u){u=u||{};var f=/^$/;u.keepRecordsRegExp&&(f=u.keepRecordsRegExp);var g,y,v,d,w,b,C,M,x,H=Date.now(),A={},D={};D.profiling=[],D.logs=[];var S=[];D.spectra=S,D.info={};var E=new i;if("string"!=typeof r)return D;for(D.profiling&&D.profiling.push({action:"Before split to LDRS",time:Date.now()-H}),d=r.split(/[\r\n]+##/),D.profiling&&D.profiling.push({action:"Split to LDRS",time:Date.now()-H}),d[0]&&(d[0]=d[0].replace(/^[\r\n ]*##/,"")),w=0,b=d.length;b>w;w++){if(g=d[w],C=g.indexOf("="),C>0?(y=g.substring(0,C),v=g.substring(C+1).trim()):(y=g,v=""),y=y.replace(/[_ -]/g,"").toUpperCase(),"DATATABLE"===y&&(M=v.indexOf("\n"),-1===M&&(M=v.indexOf("\r")),M>0)){var R=-1,X=-1;if(x=v.substring(0,M).split(/[ ,;\t]+/),x[0].indexOf("++")>0){var k=x[0].replace(/.*\(([a-zA-Z0-9]+)\+\+.*/,"$1"),F=x[0].replace(/.*\.\.([a-zA-Z0-9]+).*/,"$1");R=A.symbol.indexOf(k),X=A.symbol.indexOf(F)}-1===R&&(R=0),-1===X&&(X=0),A.first&&(A.first.length>R&&(E.firstX=A.first[R]),A.first.length>X&&(E.firstY=A.first[X])),A.last&&(A.last.length>R&&(E.lastX=A.last[R]),A.last.length>X&&(E.lastY=A.last[X])),A.vardim&&A.vardim.length>R&&(E.nbPoints=A.vardim[R]),A.factor&&(A.factor.length>R&&(E.xFactor=A.factor[R]),A.factor.length>X&&(E.yFactor=A.factor[X])),A.units&&(A.units.length>R&&(E.xUnit=A.units[R]),A.units.length>X&&(E.yUnit=A.units[X])),E.datatable=x[0],x[1]&&x[1].indexOf("PEAKS")>-1?y="PEAKTABLE":x[1]&&(x[1].indexOf("XYDATA")||x[0].indexOf("++")>0)&&(y="XYDATA",E.deltaX=(E.lastX-E.firstX)/(E.nbPoints-1))}if("TITLE"===y)E.title=v;else if("DATATYPE"===y)E.dataType=v,v.indexOf("nD")>-1&&(D.twoD=!0);else if("NTUPLES"===y)v.indexOf("nD")>-1&&(D.twoD=!0);else if("XUNITS"===y)E.xUnit=v;else if("YUNITS"===y)E.yUnit=v;else if("FIRSTX"===y)E.firstX=parseFloat(v);else if("LASTX"===y)E.lastX=parseFloat(v);else if("FIRSTY"===y)E.firstY=parseFloat(v);else if("LASTY"===y)E.lastY=parseFloat(v);else if("NPOINTS"===y)E.nbPoints=parseFloat(v);else if("XFACTOR"===y)E.xFactor=parseFloat(v);else if("YFACTOR"===y)E.yFactor=parseFloat(v);else if("DELTAX"===y)E.deltaX=parseFloat(v);else if(".OBSERVEFREQUENCY"===y||"$SFO1"===y)E.observeFrequency||(E.observeFrequency=parseFloat(v));else if(".OBSERVENUCLEUS"===y)E.xType||(D.xType=v.replace(/[^a-zA-Z0-9]/g,""));else if("$SFO2"===y)D.indirectFrequency||(D.indirectFrequency=parseFloat(v));else if("$OFFSET"===y)D.shiftOffsetNum=0,D.shiftOffsetVal||(D.shiftOffsetVal=parseFloat(v));else if("$REFERENCEPOINT"===y);else if("VARNAME"===y)A.varname=v.split(m);else if("SYMBOL"===y)A.symbol=v.split(m);else if("VARTYPE"===y)A.vartype=v.split(m);else if("VARFORM"===y)A.varform=v.split(m);else if("VARDIM"===y)A.vardim=t(v.split(m));else if("UNITS"===y)A.units=v.split(m);else if("FACTOR"===y)A.factor=t(v.split(m));else if("FIRST"===y)A.first=t(v.split(m));else if("LAST"===y)A.last=t(v.split(m));else if("MIN"===y)A.min=t(v.split(m));else if("MAX"===y)A.max=t(v.split(m));else if(".NUCLEUS"===y)D.twoD&&(D.yType=v.split(m)[0]);else if("PAGE"===y){E.page=v.trim(),E.pageValue=parseFloat(v.replace(/^.*=/,"")),E.pageSymbol=E.page.replace(/=.*/,"");var P=A.symbol.indexOf(E.pageSymbol),N="";A.units&&A.units[P]&&(N=A.units[P]),D.indirectFrequency&&"PPM"!==N&&(E.pageValue/=D.indirectFrequency)}else"RETENTIONTIME"===y?E.pageValue=parseFloat(v):"XYDATA"===y?(a(D,E),v.match(/.*\+\+.*/)?u.fastParse===!1?l(E,v,D):(E.deltaX||(E.deltaX=(E.lastX-E.firstX)/(E.nbPoints-1)),c(E,v,D)):p(E,v,D),S.push(E),E=new i):"PEAKTABLE"===y?(a(D,E),p(E,v,D),S.push(E),E=new i):e(y)&&(E[o(y)]=v);y.match(f)&&(D.info[y]=v.trim())}if(D.profiling&&D.profiling.push({action:"Finished parsing",time:Date.now()-H}),Object.keys(A).length>0){for(var O=[],Y=Object.keys(A),w=0;w<Y.length;w++)for(var T=Y[w],_=A[T],I=0;I<_.length;I++)O[I]||(O[I]={}),O[I][T]=_[I];D.ntuples=O}D.twoD&&(h(D,u),D.profiling&&D.profiling.push({action:"Finished countour plot calculation",time:Date.now()-H}),u.keepSpectra||delete D.spectra);var V=S.length>1&&(!S[0].dataType||S[0].dataType.match(/.*mass.*/i));if(V&&u.newGCMS&&(u.xy=!0),u.xy&&S.length>0)for(var w=0;w<S.length;w++){var E=S[w];if(E.data.length>0)for(var I=0;I<E.data.length;I++){for(var z=E.data[I],U={x:new Array(z.length/2),y:new Array(z.length/2)},L=0;L<z.length;L+=2)U.x[L/2]=z[L],U.y[L/2]=z[L+1];E.data[I]=U}}return V&&(u.newGCMS?n(D):s(D),D.profiling&&D.profiling.push({action:"Finished GCMS calculation",time:Date.now()-H})),D.profiling&&D.profiling.push({action:"Total time",time:Date.now()-H}),D}function o(t){return t.toLowerCase().replace(/[^a-z0-9]/g,"")}function e(t){return-1!==g.indexOf(t)}function n(t){var i,r=t.spectra,e=r.length,n={times:new Array(e),series:[{name:"ms",dimension:2,data:new Array(e)}]},s=[];for(i=0;i<g.length;i++){var a=o(g[i]);r[0][a]&&(s.push(a),n.series.push({name:a,dimension:1,data:new Array(e)}))}for(i=0;e>i;i++){var l=r[i];n.times[i]=l.pageValue;for(var u=0;u<s.length;u++)n.series[u+1].data[i]=parseFloat(l[s[u]]);l.data&&(n.series[0].data[i]=[l.data[0].x,l.data[0].y])}t.gcms=n}function s(t){var i,r=t.spectra,e=[];for(i=0;i<g.length;i++){var n=o(g[i]);r[0][n]&&e.push(n)}if(0!==e.length){var s={};for(s.gc={},s.ms=[],i=0;i<e.length;i++)s.gc[e[i]]=[];for(i=0;i<r.length;i++){for(var a=r[i],l=0;l<e.length;l++)s.gc[e[l]].push(a.pageValue),s.gc[e[l]].push(parseFloat(a[e[l]]));a.data&&(s.ms[i]=a.data[0])}t.gcms=s}}function a(t,i){if(i.xFactor||(i.xFactor=1),i.yFactor||(i.yFactor=1),i.observeFrequency&&i.xUnit&&"HZ"===i.xUnit.toUpperCase()&&(i.xUnit="PPM",i.xFactor=i.xFactor/i.observeFrequency,i.firstX=i.firstX/i.observeFrequency,i.lastX=i.lastX/i.observeFrequency,i.deltaX=i.deltaX/i.observeFrequency),t.shiftOffsetVal){var r=i.firstX-t.shiftOffsetVal;i.firstX=i.firstX-r,i.lastX=i.lastX-r}}function u(t){for(var i=0,r=t[0].data[0][0],o=r,e=t.length,n=t[0].data[0].length/2,s=new Array(e),a=0;e>a;a++){s[a]=new Array(n);for(var l=t[a].data[0],u=0;n>u;u++){var h=l[2*u+1];s[a][u]=h,r>h&&(r=h),h>o&&(o=h),0!==a&&0!==u&&(i+=Math.abs(h-s[a][u-1])+Math.abs(h-s[a-1][u]))}}return{z:s,minX:t[0].data[0][0],maxX:t[0].data[0][t[0].data[0].length-2],minY:t[0].pageValue,maxY:t[e-1].pageValue,minZ:r,maxZ:o,noise:i/((e-1)*(n-1)*2)}}function h(t,i){var r=u(t.spectra);t.contourLines=f(r,i),delete r.z,t.minMax=r}function f(t,i){for(var r,o,e,n,s,a,l,u,h,f,c,p,m,g=t.noise,y=t.z,v=[],d=i.nbContourLevels||7,w=void 0===i.noiseMultiplier?5:i.noiseMultiplier,b=y.length,C=y[0].length,M=t.minX,x=t.maxX,H=(x-M)/(C-1),A=t.minY,D=t.maxY,S=(D-A)/(b-1),E=t.minZ,R=t.maxZ,X=0;2*d>X;X++){var k={};v[X]=k;var F=X%2,P=(R-w*g)*Math.exp((X>>1)-d);m=0===F?P+w*g:-P-w*g;var N=[];if(k.zValue=m,k.lines=N,!(E>=m||m>=R))for(var O=0;b-1>O;O++)for(var Y=y[O],T=y[O+1],_=0;C-1>_;_++)r=Y[_],o=Y[_+1],e=T[_],n=T[_+1],s=r>m,a=o>m,l=e>m,u=n>m,s!==a&&s!==l&&(h=_+(m-r)/(o-r),f=O,c=_,p=O+(m-r)/(e-r),N.push(h*H+M),N.push(f*S+A),N.push(c*H+M),N.push(p*S+A)),u!==a&&u!==l&&(h=_+1,f=O+1-(m-n)/(o-n),c=_+1-(m-n)/(e-n),p=O+1,N.push(h*H+M),N.push(f*S+A),N.push(c*H+M),N.push(p*S+A)),a!==l&&(h=(_+1-(m-o)/(e-o))*H+M,f=(O+(m-o)/(e-o))*S+A,a!==s&&(c=_+1-(m-o)/(r-o),p=O,N.push(h),N.push(f),N.push(c*H+M),N.push(p*S+A)),l!==s&&(c=_,p=O+1-(m-e)/(r-e),N.push(h),N.push(f),N.push(c*H+M),N.push(p*S+A)),a!==u&&(c=_+1,p=O+(m-o)/(n-o),N.push(h),N.push(f),N.push(c*H+M),N.push(p*S+A)),l!==u&&(c=_+(m-e)/(n-e),p=O+1,N.push(h),N.push(f),N.push(c*H+M),N.push(p*S+A)))}return{minX:t.minX,maxX:t.maxX,minY:t.minY,maxY:t.maxY,segments:v}}function c(t,i){var r=t.yFactor,o=t.deltaX;t.isXYdata=!0;var e=[],n=0;t.data=[e];for(var s=t.firstX,a=t.firstY,l=!1,u=0;u<i.length;u++){var h=i.charCodeAt(u);if(13===h||10===h)l=!0;else if(l)break}for(var h,f=!0,c=!1,p=!1,m=0,g=!1,y=!1,v=0,d=!1,w=!1,b=!1,C=0;u<=i.length;u++)if(h=u===i.length?13:i.charCodeAt(u),y)(13===h||10===h)&&(f=!0,y=!1);else if(57>=h&&h>=48)w=!0,C>0?v+=(h-48)/Math.pow(10,C++):(v*=10,v+=h-48);else if(44===h||46===h)w=!0,C++;else{if(w){if(f)f=!1,p&&(b=!0);else if(b)b=!1;else{c&&(m=0===v?0:d?-v:v,p=!0,c=!1);for(var M=g?v-1:1,x=0;M>x;x++)p?a+=m:a=0===v?0:d?-v:v,e[n++]=s,e[n++]=a*r,s+=o}d=!1,v=0,C=0,w=!1,g=!1}if(74>h&&h>63)w=!0,p=!1,v=h-64;else if(h>96&&106>h)w=!0,p=!1,v=h-96,d=!0;else if(115===h)w=!0,g=!0,v=9;else if(h>82&&91>h)w=!0,g=!0,v=h-82;else if(h>73&&83>h)w=!0,c=!0,v=h-73;else if(h>105&&115>h)w=!0,c=!0,v=h-105,d=!0;else if(36===h&&36===i.charCodeAt(u+1))w=!0,y=!0;else if(37===h)w=!0,c=!0,v=0,d=!1;else if(45===h){var H=i.charCodeAt(u+1);(H>=48&&57>=H||44===H||46===H)&&(w=!0,p=!1,d=!0)}else(13===h||10===h)&&(f=!0,y=!1)}}function p(t,i,r){var o=/\$\$.*/,e=/[,\t ]+/;t.isPeaktable=!0;var n,s,a,l,u,h=[];t.data=[h];var f=i.split(/,? *,?[;\r\n]+ */),c=0;for(n=1,s=f.length;s>n;n++)if(u=f[n].trim().replace(o,"").split(e),u.length%2===0)for(a=0,l=u.length;l>a;a+=2)h[c++]=parseFloat(u[a])*t.xFactor,h[c++]=parseFloat(u[a+1])*t.yFactor;else r.logs.push("Format error: "+u)}var m=/[, \t]{1,}/,g=["TIC",".RIC","SCANNUMBER"];return r}function e(t,i,r){return"boolean"==typeof i&&(r=i,i={}),r?n(t,i):u(t,i)}function n(t,i){return a||s(),new Promise(function(r){var o=Date.now()+""+Math.random();h[o]=r,a.postMessage(JSON.stringify({stamp:o,input:t,options:i}))})}function s(){var t=URL.createObjectURL(new Blob(["var getConverter ="+o.toString()+";var convert = getConverter(); onmessage = function (event) { var data = JSON.parse(event.data); postMessage(JSON.stringify({stamp: data.stamp, output: convert(data.input, data.options)})); };"],{type:"application/javascript"}));a=new Worker(t),URL.revokeObjectURL(t),a.addEventListener("message",function(t){var i=JSON.parse(t.data),r=i.stamp;h[r]&&h[r](i.output)})}var a,l=r(4),u=o(),h={};t.exports={convert:e}},function(t,i){"use strict";var r=/[,\t \+-]*(?=[^\d,\t \.])|[ \t]+(?=[\d+\.-])/,o=/\$\$.*/,e=!1;t.exports=function(t,i,n){t.deltaX||(t.deltaX=(t.lastX-t.firstX)/(t.nbPoints-1)),t.isXYdata=!0;var s=[],a=0;t.data=[s];var l,u,h,f=t.firstX,c=t.firstY,p=i.split(/[\r\n]+/);u=[];for(var m=1,g=p.length;g>m;m++)if(u=p[m].trim().replace(o,"").split(r),u.length>0){if(e){t.firstPoint||(t.firstPoint=+u[0]);var y=(u[0]-t.firstPoint)*t.xFactor+t.firstX;(l||0===l)&&(y+=t.deltaX),n.logs.push("Checking X value: currentX: "+f+" - expectedCurrentX: "+y)}for(var v=1,d=u.length;d>v;v++)if(1!==v||!l&&0!==l){if(u[v].length>0)if(h=u[v].charCodeAt(0),43===h||45===h||46===h||h>47&&58>h)l=null,c=+u[v],s[a++]=f,s[a++]=c*t.yFactor,f+=t.deltaX;else if(h>63&&74>h)l=null,c=+(String.fromCharCode(h-16)+u[v].substring(1)),s[a++]=f,s[a++]=c*t.yFactor,f+=t.deltaX;else if(h>96&&106>h)l=null,c=1*-(String.fromCharCode(h-48)+u[v].substring(1)),s[a++]=f,s[a++]=c*t.yFactor,f+=t.deltaX;else if(h>82&&91>h||115===h){var w=String.fromCharCode(h-34)+u[v].substring(1)-1;115===h&&(w="9"+u[v].substring(1)-1);for(var b=0;w>b;b++)l&&(c+=l),s[a++]=f,s[a++]=c*t.yFactor,f+=t.deltaX}else 37===h?(l=+("0"+u[v].substring(1)),c+=l,s[a++]=f,s[a++]=c*t.yFactor,f+=t.deltaX):h>73&&83>h?(l=1*(String.fromCharCode(h-25)+u[v].substring(1)),c+=l,s[a++]=f,s[a++]=c*t.yFactor,f+=t.deltaX):h>105&&115>h&&(l=1*-(String.fromCharCode(h-57)+u[v].substring(1)),c+=l,s[a++]=f,s[a++]=c*t.yFactor,f+=t.deltaX)}else l=null,h=u[v].charCodeAt(0)}}},function(t,i,r){"use strict";var o=r(6),e=function(){const t={MAX_VALUE:2e31,MIN_VALUE:-2e31},i="\r\n",r="Cheminfo tools, March 2016";var e=function(o,e,a,l,u){e=e.toUpperCase().trim(),(null===l||0==l.length)&&(l="SIMPLE");var h="";o.setActiveElement(0);var f=a/o.getParamDouble("YFACTOR",1);o.getMaxY()*f>=t.MAX_VALUE/2&&(f=t.MAX_VALUE/(2*o.getMaxY())),Math.abs(o.getMaxY()-o.getMinY())*f<16&&(f=16/Math.abs(o.getMaxY()-o.getMinY()));var c=Math.abs(1/o.getDeltaX());return h+="##TITLE= "+o.getTitle()+i,h+="##JCAMP-DX= 5.00	$$"+r+i,h+="##OWNER= "+o.getParamString("##OWNER=","")+i,h+="##DATA TYPE= "+o.getDataType()+i,"NTUPLES"==l&&(h+=n(o,f,c,e,u)),"SIMPLE"==l&&(h+=s(o,f,c,e,u)),h},n=function(t,r,e,n,s){var a="",l=t.getSpectraVariable(0),u=t.getSpectraVariable(1),h=t.getSpectraVariable(2);a+="##DATA CLASS= NTUPLES\r\n",a+="##NUM DIM= 2\r\n";var f,c=t.getDataType().trim(),p={};for(f=0;f<t.getNbSubSpectra();f++)t.setActiveElement(f),p[t.getXUnits()]?p[t.getXUnits()].value++:p[t.getXUnits()]={value:1,index:f};var m=Object.keys(p),g=m[0],y=0;for(f=1;f<m.length;f++)p[m[f]].value>p[g].value&&(g=m[f],y=p[m[f]].index);var v=!1;t.setActiveElement(y);var d=t.getDataType().indexOf("NMR")>=0;d&&(a+="##.OBSERVE FREQUENCY= "+t.getParamDouble("observefrequency",0)+i,a+="##.OBSERVE NUCLEUS= ^"+t.getNucleus()+i,a+="##$DECIM= "+t.getParamDouble("$DECIM",0)+i,a+="##$DSPFVS= "+t.getParamDouble("$DSPFVS",0)+i,a+="##$FCOR= "+Math.floor(t.getParamDouble("$FCOR",0))+i,t.containsParam("$SW_h")?a+="##$SW_h= "+t.getParamDouble("$SW_h",0)+i:t.containsParam("$SW_p")&&(a+="##$SW_p= "+t.getParamDouble("$SW_p",0)+i),a+="##$SW= "+t.getParamDouble("$SW",0)+i,a+="##$TD= "+Math.floor(t.getParamDouble("$TD",0))+i,a+="##$BF1= "+t.getParamDouble("$BF1",0)+i,a+="##$GRPDLY= "+t.getParamDouble("$GRPDLY",0)+i,a+="##.DIGITISER RES= "+t.getParamInt(".DIGITISER RES",0)+i,a+="##.PULSE SEQUENCE= "+t.getParamString(".PULSE SEQUENCE","")+i,a+="##.SOLVENT NAME= "+t.getSolventName()+i,a+="##$NUC1= <"+t.getNucleus()+">"+i,a+=t.containsParam("2D_X_FREQUENCY")?"##$SFO1= "+t.getParamDouble("2D_X_FREQUENCY",0)+i:"##$SFO1= "+t.getParamDouble("$SFO1",0)+i,t.containsParam("2D_X_OFFSET")&&(a+="##$OFFSET= "+t.getParamDouble("2D_X_OFFSET",0)+i),t.is2D()&&(a+="$$Parameters for 2D NMR Spectrum\r\n",a+="##$NUC1= <"+t.getNucleus(2)+">"+i,t.containsParam("2D_Y_FREQUENCY")&&(a+="##$SFO1= "+t.getParamDouble("2D_Y_FREQUENCY",0)+i,a+="##$SFO2= "+t.getParamDouble("2D_Y_FREQUENCY",0)+i,a+="##$BF2= "+t.getParamDouble("2D_Y_FREQUENCY",0)+i),t.containsParam("2D_Y_OFFSET")&&(a+="##$OFFSET= "+t.getParamDouble("2D_Y_OFFSET",0)+i),a+="$$End of Parameters for 2D NMR Spectrum\r\n")),a+="##NTUPLES=	"+c+i;var w=1,b=1;if(!t.is2D()&&t.getNbSubSpectra()>1&&d&&(v=!0),v?(a+="##VAR_NAME=	"+t.getXUnits()+",	"+c.substring(4)+"/REAL,	"+c.substring(4)+"/IMAG"+i,a+="##SYMBOL=	X,	R,	I\r\n",a+="##VAR_TYPE=	INDEPENDENT,	DEPENDENT,	DEPENDENT\r\n",a+="CSV"!=n||"PAC"!=n?"##VAR_FORM=	AFFN,	ASDF,	ASDF\r\n":"##VAR_FORM=	AFFN,	AFFN,	AFFN\r\n",a+="##VAR_DIM=	"+t.getNbPoints()+",	"+t.getNbPoints()+",	"+t.getNbPoints()+i,a+="##UNITS=	HZ,	"+t.getYUnits()+",	"+h.units+i,a+="##FACTOR=	"+1/e+",	"+1/r+",	"+1/r+i,"PPM"==t.getXUnits()&&(w=t.observeFrequencyX()),a+="##FIRST=	"+t.getFirstX()*w+",	"+t.getY(0)+",	0"+i,a+="##LAST=	"+t.getLastX()*w+",	"+t.getLastY()+",	0"+i):(w=1,t.is2D()?(a+="##VAR_NAME=	FREQUENCY1,	FREQUENCY2,	SPECTRUM\r\n",a+="##SYMBOL=	F1,	F2,	Y\r\n",a+="##.NUCLEUS=	"+t.getNucleus(2)+",	"+t.getNucleus(1)+i,a+="##VAR_TYPE=	INDEPENDENT,	INDEPENDENT,	DEPENDENT\r\n",a+="##VAR_FORM=	AFFN,	AFFN,	ASDF\r\n",a+="##VAR_DIM=	"+t.getNbSubSpectra()+",	"+t.getNbPoints()+",	"+t.getNbPoints()+i,a+="##UNITS=	HZ,	HZ,	"+t.getYUnits()+i,"PPM"==t.getXUnits()&&(w=t.getParamDouble("2D_Y_FREQUENCY",1)),"PPM"==t.getYUnits()&&(b=t.getParamDouble("2D_X_FREQUENCY",1)),a+="##FACTOR=	1,	"+b/e+",	"+1/r+i,a+="##FIRST=	"+t.getParamDouble("firstY",0)*w+",	"+t.getFirstX()*b+",	"+t.getY(0)+i,a+="##LAST=	"+t.getParamDouble("lastY",0)*w+",	"+t.getLastX()*b+",	"+t.getY(t.getNbPoints()-1)+i):(a+="##VAR_NAME=	"+l.varname+",	"+u.varname+",	"+l.varname+i,a+="##SYMBOL=	"+l.symbol+",	"+u.symbol+",	"+h.symbol+i,a+="##VAR_TYPE=	"+l.vartype+",	"+u.vartype+",	"+h.vartype+i,a+="CSV"!=n||"PAC"!=n?"##VAR_FORM=	AFFN,	ASDF,	ASDF\r\n":"##VAR_FORM=	AFFN,	AFFN,	AFFN\r\n",a+="##VAR_DIM=	"+l.vardim+",	"+u.vardim+",	"+h.vardim+i,a+="##UNITS=	HZ,	"+t.getYUnits()+",	"+h.units+i,"PPM"==t.getXUnits()&&(w=t.observeFrequencyX()),a+="##FACTOR=	"+1/e+",	"+1/r+i,a+="##FIRST=	"+l.first*w+",	"+u.first+",	"+h.first+i,a+="##LAST=	"+l.last*w+",	"+u.last+",	"+h.last+i)),null!=s)for(var C=s.length-1;C>=0;C--)t.containsParam(s[C])&&(a+="##"+s[C]+"= "+t.getParam(s[C],"")+i);var M=0,x=0,H=0;for(t.is2D()&&d&&(M=t.getParamDouble("firstY",0)*w,x=t.getParamDouble("lastY",0)*w,H=(x-M)/(t.getNbSubSpectra()-1)),f=0;f<t.getNbSubSpectra();f++)if(t.setActiveElement(f),a+="##PAGE= "+t.page+i,M+=H,t.is2D()&&d&&(a+="##FIRST=	"+t.getParamDouble("firstY",0)*w+",	"+t.getFirstX()*b+",	"+t.getY(0)+i),a+="##DATA TABLE= ",t.isDataClassPeak()){a+="(XY..XY), PEAKS\r\n";for(var A=0;A<t.getNbPoints();A++)a+=t.getX(A)+", "+t.getY(A)+i}else if(t.isDataClassXY()){a+=d?t.is2D()?"(F2++(Y..Y)), PROFILE\r\n":f%2==0?"(X++(R..R)), XYDATA\r\n":"(X++(I..I)), XYDATA\r\n":"(X++(Y..Y)), XYDATA\r\n";for(var D="",S=new Array(t.getNbPoints()),A=S.length-1;A>=0;A--)S[A]=Math.round(t.getY(A)*r);D+=o.encode(S,t.getFirstX()*e,t.getDeltaX()*e,n),a+=D+i}return a+="##END NTUPLES= "+c+i,a+="##END= ",t.setActiveElement(0),a},s=function(t,r,e,n,s){var a=(t.getSpectraVariable(0),t.getSpectraVariable(1),"");if(t.isDataClassPeak()&&(a+="##DATA CLASS= PEAK TABLE\r\n"),t.isDataClassXY()&&(a+="##DATA CLASS= XYDATA\r\n"),t.setActiveElement(0),t.getDataType().indexOf("NMR")>=0&&(a+="##.OBSERVE FREQUENCY= "+t.getParamDouble("observefrequency",0)+i,a+="##.OBSERVE NUCLEUS= ^"+t.getNucleus()+i,a+="##$DECIM= "+Math.round(t.getParamDouble("$DECIM",0))+i,a+="##$DSPFVS= "+Math.round(t.getParamDouble("$DSPFVS",0))+i,a+="##$FCOR= "+Math.round(t.getParamDouble("$FCOR",0))+i,a+="##$SW_h= "+t.getParamDouble("$SW_h",0)+i,a+="##$SW= "+t.getParamDouble("$SW",0)+i,a+="##$TD= "+Math.round(t.getParamDouble("$TD",0))+i,a+="##$GRPDLY= "+t.getParamDouble("$GRPDLY",0)+i,a+="##$BF1= "+t.getParamDouble("$BF1",0)+i,a+="##$SFO1= "+t.getParamDouble("$SFO1",0)+i,a+="##$NUC1= <"+t.getNucleus()+">"+i,a+="##.SOLVENT NAME= "+t.getSolventName()+i),a+="##XUNITS=	"+t.getXUnits()+i,a+="##YUNITS=	"+t.getYUnits()+i,a+="##NPOINTS=	"+t.getNbPoints()+i,a+="##FIRSTX=	"+t.getFirstX()+i,a+="##LASTX=	"+t.getLastX()+i,a+="##FIRSTY=	"+t.getFirstY()+i,a+="##LASTY=	"+t.getLastY()+i,t.isDataClassPeak()?(a+="##XFACTOR=1\r\n",a+="##YFACTOR=1\r\n"):t.isDataClassXY()&&(a+="##XFACTOR= "+1/e+i,a+="##YFACTOR= "+1/r+i),a+="##MAXY= "+t.getMaxY()+i,a+="##MINY= "+t.getMinY()+i,null!=s)for(var l=s.length-1;l>=0;l--)t.containsParam(s[l])&&(a+="##"+s[l]+"= "+t.getParam(s[l],"")+i);if(t.isDataClassPeak()){a+="##PEAK TABLE= (XY..XY)\r\n";for(var u=0;u<t.getNbPoints();u++)a+=t.getX(u)+", "+t.getY(u)+i;a+="##END "}else if(t.isDataClassXY()){a+="##DELTAX= "+t.getDeltaX()+i,a+="##XYDATA=(X++(Y..Y))\r\n";for(var h="",f=new Array(t.getNbPoints()),u=f.length-1;u>=0;u--)f[u]=Math.round(t.getY(u)*r);h+=o.encode(f,t.getFirstX()*e,t.getDeltaX()*e,n),a+=h+i,a+="##END= "}return t.setActiveElement(0),a};return{convert:e}}();t.exports=e},function(t,i){"use strict";var r=function(){var t="\r\n",i=[["0","1","2","3","4","5","6","7","8","9"],["@","A","B","C","D","E","F","G","H","I"],["@","a","b","c","d","e","f","g","h","i"],["%","J","K","L","M","N","O","P","Q","R"],["%","j","k","l","m","n","o","p","q","r"],[" ","S","T","U","V","W","X","Y","Z","s"]],r=1,o=2,e=3,n=4,s=5,a=100,l=function(t,i,r,o){return"FIX"==o?h(t,i,r):"SQZ"==o?c(t,i,r):"DIF"==o?m(t,i,r):"DIFDUP"==o?p(t,i,r):"CSV"==o?u(t,i,r):"PAC"==o?f(t,i,r):m(t,i,r)},u=function(t,i,r){return h(t,i,r,",")},h=function(i,r,o,e){e||(e=" ");for(var n,s="",a=0,l=i.length;l-7>a;){for(s+=Math.ceil(r+a*o),n=0;8>n;n++)s+=e+i[a++];s+=t}if(l>a)for(s+=Math.ceil(r+a*o),n=a;l>n;n++)s+=e+i[n];return s},f=function(i,r,o){for(var e,n="",s=0,a=i.length;a-7>s;){for(n+=Math.ceil(r+s*o),e=0;8>e;e++)n+=i[s]<0?"-"+i[s++]:"+"+i[s++];n+=t}if(a>s)for(n+=Math.ceil(r+s*o),e=s;a>e;e++)n+=i[e]<0?"-"+i[e]:"+"+i[e];return n},c=function(i,r,o){for(var e,n="",s=0,a=i.length;a-10>s;){for(n+=Math.ceil(r+s*o),e=0;10>e;e++)n+=g(i[s++].toString());n+=t}if(a>s)for(n+=Math.ceil(r+s*o),e=s;a>e;e++)n+=g(i[e].toString());return n},p=function(i,r,o){var e,n=0,s=0,l=0,u="",h="",f="",c=new Array(i.length-1);for(e=0;e<c.length;e++)c[e]=i[e+1]-i[e];for(var p=c.length;p>s;)0==l?(h=Math.ceil(r+s*o)+g(i[s].toString())+y(c[s].toString()),u+=h,l+=h.length):c[s-1]==c[s]?n++:n>0?(n++,h=v(n.toString()),u+=h,l+=h.length,n=0,s--):(h=y(c[s].toString()),h.length+l<a?(u+=h,l+=h.length):(u+=t,f=Math.ceil(r+s*o)+g(i[s].toString())+h,u+=f,l=f.length)),s++;return n>0&&(u+=v((n+1).toString())),u+=t+Math.ceil(r+s*o)+g(i[s].toString())},m=function(i,r,o){var e,n=0,s=0,l="",u="",h="",f=new Array(i.length-1);
for(e=0;e<f.length;e++)f[e]=i[e+1]-i[e];n=0;for(var c=f.length;c>n;)0==s?(u=Math.ceil(r+n*o)+g(i[n].toString())+y(f[n].toString()),l+=u,s+=u.length):(u=y(f[n].toString()),u.length+s<a?(l+=u,s+=u.length):(l+=t,h=Math.ceil(r+n*o)+g(i[n].toString())+u,l+=h,s=h.length)),n++;return l+=t+Math.ceil(r+n*o)+g(i[n].toString())},g=function(t){var e="";return"-"==t.charAt(0)?(e+=i[o][Number(t.charAt(1))],t.length>2&&(e+=t.substring(2))):(e+=i[r][Number(t.charAt(0))],t.length>1&&(e+=t.substring(1))),e},y=function(t){var r="";return"-"==t.charAt(0)?(r+=i[n][Number(t.charAt(1))],t.length>2&&(r+=t.substring(2))):(r+=i[e][Number(t.charAt(0))],t.length>1&&(r+=t.substring(1))),r},v=function(t){var r="";return r+=i[s][Number(t.charAt(0))],t.length>1&&(r+=t.substring(1)),r};return{encode:l,FIXencod:h,CSVencod:u,PACencod:f,SQZencod:c,DIFDUPencod:p,DIFencod:p}}();t.exports=r},function(t,i){"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,e=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===o.call(t)},n=function(t){if(!t||"[object Object]"!==o.call(t))return!1;var i=r.call(t,"constructor"),e=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!i&&!e)return!1;var n;for(n in t);return"undefined"==typeof n||r.call(t,n)};t.exports=function s(){var t,i,r,o,a,l,u=arguments[0],h=1,f=arguments.length,c=!1;for("boolean"==typeof u?(c=u,u=arguments[1]||{},h=2):("object"!=typeof u&&"function"!=typeof u||null==u)&&(u={});f>h;++h)if(t=arguments[h],null!=t)for(i in t)r=u[i],o=t[i],u!==o&&(c&&o&&(n(o)||(a=e(o)))?(a?(a=!1,l=r&&e(r)?r:[]):l=r&&n(r)?r:{},u[i]=s(c,l,o)):"undefined"!=typeof o&&(u[i]=o));return u}},function(t,i,r){"use strict";function o(t){e.call(this,t)}var e=r(1),n=r(9),s=r(3),a=(r(40),r(43));o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.fromJcamp=function(t,i){i=i||{xy:!0,keepSpectra:!0,keepRecordsRegExp:/^.+$/};var r=s.convert(t,i);return new o(r)},o.prototype.getNucleus=function(t){return t&&0!=t&&1!=t?"":this.sd.xType},o.prototype.getSolventName=function(){return(this.sd.info[".SOLVENTNAME"]||this.sd.info.$SOLVENT||"").replace("<","").replace(">","")},o.prototype.observeFrequencyX=function(){return this.sd.spectra[0].observeFrequency},o.prototype.getNMRPeakThreshold=function(t){return"1H"==t?3:"13C"==t?5:1},o.prototype.addNoise=function(t){},o.prototype.addSpectraDatas=function(t,i,r,o){},o.prototype.autoBaseline=function(){},o.prototype.fourierTransform=function(){return a.fourierTransform(this)},o.prototype.postFourierTransform=function(t){return a.phaseCorrection(0,t)},o.prototype.zeroFilling=function(t,i){return a.zeroFilling(this,t,i)},o.prototype.haarWhittakerBaselineCorrection=function(t,i){},o.prototype.whittakerBaselineCorrection=function(t,i){},o.prototype.brukerFilter=function(){return a.digitalFilter(this,{brukerFilter:!0})},o.prototype.digitalFilter=function(t){return a.digitalFilter(this,t)},o.prototype.apodization=function(t,i){return a.apodization(this,{functionName:t,lineBroadening:i})},o.prototype.echoAntiechoFilter=function(){},o.prototype.SNVFilter=function(){},o.prototype.powerFilter=function(t){var i=this.getMinY();1>t&&0>i&&(this.YShift(-1*i),console.warn("SD.powerFilter: The spectrum had negative values and was automatically shifted before applying the function."))},o.prototype.logarithmFilter=function(t){var i=this.getMinY();0>=i&&(this.YShift(-1*i+1),console.warn("SD.logarithmFilter: The spectrum had negative values and was automatically shifted before applying the function."))},o.prototype.correlationFilter=function(t){},o.prototype.phaseCorrection=function(t,i){return a.phaseCorrection(this,t,i)},o.prototype.automaticPhase=function(){},o.prototype.nmrPeakDetection=function(t){return n.peakPicking(this,t)},t.exports=o},function(t,i,r){"use strict";var o=r(10),e=r(11),n=r(7),s=r(39),a={impurities:[],maxJ:20,defaultOptions:{nH:99,clean:!0,realTop:!1,thresholdFactor:1,compile:!0,integralFn:0,optimize:!0,idPrefix:"",format:"old"},peakPicking:function(t,i){var r,a,l,u,h=n({},this.defaultOptions,i),f=Math.abs(t.getNoiseLevel())*h.thresholdFactor,c=n({},{noiseLevel:f,minMaxRatio:.01,broadRatio:.0025,smoothY:!0,nL:4,sgOptions:{windowSize:9,polynomial:3}},h.gsdOptions),p=t.getXYData(),m=e.gsd(p[0],p[1],c),m=e.post.joinBroadPeaks(m,{width:.25});h.optimize&&(m=e.post.optimizePeaks(m,p[0],p[1],c.nL,"lorentzian")),m=this.clearList(m,f);var g=this.detectSignals(m,t,h.nH,h.integralFn);if(h.clean)for(var r=g.length-1;r>=0;r--)g[r].integralData.value<.5&&g.splice(r,1);if(h.compile){for(r=0;r<g.length;r++)if(o.compilePattern(g[r]),g[r].maskPattern&&"m"!=g[r].multiplicity&&""!=g[r].multiplicity){l=0,u=0;var y=[];for(a=g[r].maskPattern.length-1;a>=0;a--)if(u+=this.area(g[r].peaks[a]),g[r].maskPattern[a]===!1){var v=g[r].peaks.splice(a,1)[0];y.push({x:v.x,y:v.intensity,width:v.width}),g[r].mask.splice(a,1),g[r].mask2.splice(a,1),g[r].maskPattern.splice(a,1),g[r].nbPeaks--,l+=this.area(v)}if(y.length>0){l=l*g[r].integralData.value/u,g[r].integralData.value-=l;for(var d=[],a=y.length-1;a>=0;a--)d.push(y[a]);var w=this.detectSignals(d,t,l,h.integralFn);for(a=0;a<w.length;a++)g.push(w[a])}}this.updateIntegrals(g,h.nH)}if(g.sort(function(t,i){return i.delta1-t.delta1}),h.clean)for(var r=g.length-1;r>=0;r--)g[r].integralData.value<.5&&g.splice(r,1);for(var r=0;r<g.length;r++)h.idPrefix&&h.idPrefix.length>0?g[r].signalID=h.idPrefix+"_"+(r+1):g[r].signalID=r+1+"",g[r]._highlight=[g[r].signalID];if(s(g,t.getSolventName(),h.nH),"new"===h.format){for(var w=new Array(g.length),r=0;r<g.length;r++){var b=g[r];w[r]={from:b.integralData.from,to:b.integralData.to,integral:b.integralData.value,signal:[{delta:b.delta1,nbAtoms:0,diaID:[],multiplicity:b.multiplicity,peak:b.peaks,kind:"",remark:""}],signalID:b.signalID,_highlight:b._highlight},b.nmrJs&&(w[r].signal[0].j=b.nmrJs)}g=w}return g},clearList:function(t,i){for(var r=t.length-1;r>=0;r--)Math.abs(t[r].y)<i&&t.splice(r,1);return t},sampling:function(t,i,r){var o,e,n,s,a,l=[];if(o>e){var u=o;o=e,e=u}for(s=0;s<i.length;s++)for(var h=!0,f=4;h;)if(o=t.unitsToArrayPoint(i[s][0]-i[s][2]*f),e=t.unitsToArrayPoint(i[s][0]+i[s][2]*f),n=t.unitsToArrayPoint(i[s][0]),o>e&&(u=o,o=e,e=u),o=0>o?0:o,e=e>=t.getNbPoints()?t.getNbPoints()-1:e,10>e-o){for(a=o;e>=a;a++)l.push([t.getX(a),t.getY(a)]);h=!1}else l.push([t.getX(o),t.getY(o)]),l.push([t.getX(e),t.getY(e)]),f>.5?f-=.5:f/=2;l.sort(function(t,i){return t[0]-i[0]});var c=[],p=[],m=0;if(r)for(c=[l[0][0]],p=[l[0][1]],s=1;s<l.length;s++)c[m]!=l[s][0]&&(c.push(l[s][0]),p.push(l[s][1]),m++);else for(c=[[l[0][0]]],p=[[l[0][1]]],s=1;s<l.length;s++)c[m][0]!=l[s][0]&&(c.push([l[s][0]]),p.push([l[s][1]]),m++);return[c,p]},getVector:function(t,i,r,o){var e=t.unitsToArrayPoint(i),n=t.unitsToArrayPoint(r),s=[],a=[];if(e>n){var l=e;e=n,n=l}e=0>e?0:e,n=n>=t.getNbPoints()?t.getNbPoints()-1:n;for(var u=e;n>u;u+=10)o?(a.push(t.getY(u)),s.push(t.getX(u))):(a.push([t.getY(u)]),s.push([t.getX(u)]));return[s,a]},updateLimits:function(t){if("m"!=t.multiplicity&&""!=t.multiplicity){for(var i=t.peaks,r=i.length,o=0,e=0,n=0;r>n;n++)t.maskPattern[n]===!1&&(e+=this.area(i[n])),o+=this.area(i[n]);o=t.integralData.value/o,t.integralData.value-=e*o}return t.integralData.value},updateIntegrals:function(t,i){var r,o=0,e=0;for(r=0;r<t.length;r++)e+=Math.round(t[r].integralData.value);if(e!=i)for(o=i/e,r=0;r<t.length;r++)t[r].integralData.value*=o},detectSignals:function(t,i,r,o){var e,n,s,a,l=i.observeFrequencyX(),u=[],h={},f={x:1e5,y:0,width:0},c=null,p=16/l,m=0;for(s=0;s<t.length;s++){if(Math.abs(t[s].x-f.x)>p)h={nbPeaks:1,units:"PPM",startX:t[s].x+t[s].width,stopX:t[s].x-t[s].width,multiplicity:"",pattern:"",observe:l,nucleus:"1H",integralData:{from:t[s].x-3*t[s].width,to:t[s].x+3*t[s].width},peaks:[]},h.peaks.push({x:t[s].x,intensity:t[s].y,width:t[s].width}),u.push(h);else{var g=t[s].x-t[s].width;h.stopX=Math.min(h.stopX,g),g=t[s].x+t[s].width,h.stopX=Math.max(h.stopX,g),h.nbPeaks++,h.peaks.push({x:t[s].x,intensity:t[s].y,width:t[s].width}),h.integralData.from=Math.min(h.integralData.from,t[s].x-3*t[s].width),h.integralData.to=Math.max(h.integralData.to,t[s].x+3*t[s].width)}f=t[s]}for(s=0;s<u.length;s++){c=u[s].peaks;var y=u[s].integralData;e=0,n=0;for(var a=0;a<c.length;a++)e+=c[a].x*this.area(c[a]),n+=this.area(c[a]);u[s].delta1=e/n,0==o?y.value=n:y.value=i.getArea(y.from,y.to),m+=y.value}for(var s=0;s<u.length;s++){var y=u[s].integralData;y.value*=r/m}return u},area:function(t){return Math.abs(t.intensity*t.width*1.57)},updateScore:function(t,i,r,o){for(var e,n,s="",a=0,l=(this.maxJ/o,0),u=0,h=0,f=t.length-1;f>=0;f--){if(s=t[f][1],a=t[f][2],e=t[f][4][0],s.indexOf("sep")>=0)i[e][1]>.33*r&&t.splice(f,1);else if(s.indexOf("s")>=0||s.indexOf("X")>=0){for(n=e-1,l=i[e][1],u=e;n>=0&&Math.abs(i[e][0]-i[n][0])<.025;)i[n][1]<l&&(l=i[n][1],u=n),n--;for(n=e+1;n<i.length&&Math.abs(i[e][0]-i[n][0])<.025;)i[n][1]<l&&(l=i[n][1],u=n),n++;t[f][4][0]=u,h+=1}if(s.indexOf("d")>=0&&e>0&&e<i.length-1){var c=Math.abs(Math.abs(i[e-1][0]-i[e][0])*o-a),p=Math.abs(Math.abs(i[e+1][0]-i[e][0])*o-a),m=Math.abs(Math.abs(i[e+1][0]-i[e-1][0])*o-a);(2>c||2>p||2>m)&&(p>c?m>c?(t[f][4]=[e-1,e],h+=1):(t[f][4]=[e-1,e+1],h+=1):m>p?(t[f][4]=[e,e+1],h+=1):(t[f][4]=[e-1,e+1],h+=1))}if(s.indexOf("t")>=0&&e>0&&e<i.length-1){var c=Math.abs(Math.abs(i[e-1][0]-i[e][0])*o-a),p=Math.abs(Math.abs(i[e+1][0]-i[e][0])*o-a),g=Math.abs(Math.abs(i[e+1][0]-i[e+2][0])*o-a);2>c&&(t[f][4]=[e-1,e],h+=.5),2>p&&(t[f][4].push(e+1),h+=.5),2>m&&(t[f][4].push(e+2),h+=.5)}if(s.indexOf("q")>=0&&e>1&&e<i.length-2){var c=Math.abs(Math.abs(i[e-2][0]-i[e-1][0])*o-a),p=Math.abs(Math.abs(i[e-1][0]-i[e][0])*o-a),m=Math.abs(Math.abs(i[e+1][0]-i[e][0])*o-a),g=Math.abs(Math.abs(i[e+2][0]-i[e+1][0])*o-a);2>c&&(t[f][4].push(e-2),h+=.25),2>p&&(t[f][4].push(e-1),h+=.25),2>m&&(t[f][4].push(e+1),h+=.25),2>g&&(t[f][4].push(e+2),h+=.25)}}if(h/t.length<.5){for(var f=t.length-1;f>=0;f--)t.splice(f,1);return 0}return 1},score:function(t,i){return Math.exp(-Math.pow(t/i,2)/2)}};t.exports=a},function(t,i){"use strict";var r={pascalTriangle:[[0],[1],[1,1],[1,2,1],[1,3,3,1],[1,4,6,4,1],[1,5,10,10,5,1],[1,6,15,20,15,6,1]],patterns:["s","d","t","q","quint","h","sept","o","n"],symRatio:1.5,maxErrorIter1:2.5,maxErrorIter2:1,DEBUG:!1,compilePattern:function(t){if(this.DEBUG&&console.log("Debugin..."),t.multiplicity="m",t.symRank=this.symmetrizeChoiseBest(t,this.maxErrorIter1,1),t.asymmetric=!0,t.symRank>=.95&&t.peaksComp.length<32){this.DEBUG&&console.log(t.delta1+" nbPeaks "+t.peaksComp.length),t.asymmetric=!1;var i,r,o,e,n,s,a=1,l=[];for(o=0;9>o;o++){this.DEBUG&&console.log("Trying "+o+" couplings");var u=this.normalize(t,o),h=!1;if(1==u.length&&0===o)h=!0;else if(u.length<=1)continue;var f=this.getRanges(u);n=Math.pow(2,o),this.DEBUG&&(console.log("ranges: "+JSON.stringify(f)),console.log("Target sum: "+n));for(var c=null;!h&&null!==(c=this.getNextCombination(f,n));){this.DEBUG&&(console.log("Possible pattern found with "+o+" couplings!!!"),console.log(c));var p=new Array(c.length);for(a=1,i=0;i<c.length;i++)for(p[i]=new Array(c[i]),r=0;r<c[i];r++)p[i][r]=a++;this.DEBUG&&console.log("Numbering: "+JSON.stringify(p)),l=[],r=1,l.push(u[1].x-u[0].x),e=u[0].x,p[0].splice(0,1),p[1].splice(0,1),a=1;var m=2;for(s=Math.pow(2,o)-1;l.length<o&&s>m&&a<u.length;){for(this.DEBUG&&(console.log("New Jc"+JSON.stringify(l)),console.log("Aval. numbering "+JSON.stringify(p))),r++;a<u.length&&0===p[a].length;)a++;if(a<u.length){l.push(u[a].x-u[0].x),p[a].splice(0,1),m++;for(var g=2;r>=g;g++){var y=0;for(i=0;g>i;i++)y+=l[i];for(i=1;i<p.length;i++)if(Math.abs(u[i].x-(e+y))<.25){p[i].splice(0,1),m++;break}}}}var v=this.idealPattern(l);for(h=!0,i=0;i<v.length;i++)v[i].intensity!=c[i]&&(h=!1);this.DEBUG&&(console.log("Jc "+JSON.stringify(l)),console.log("Heights "+JSON.stringify(c)),console.log("pattern "+JSON.stringify(v)),console.log("Valid? "+h))}h&&this.updateSignal(t,l)}}for(i=0;i<t.peaksComp.length;i++)t.peaksComp[i].x/=t.observe},updateSignal:function(t,i){var r=t.peaksComp,o=r.length;t.startX=r[0].x/t.observe+r[0].width,t.stopX=r[o-1].x/t.observe-r[o-1].width,t.integralData.to=r[0].x/t.observe+3*r[0].width,t.integralData.from=r[o-1].x/t.observe-3*r[o-1].width,t.maskPattern=t.mask2,t.multiplicity=this.abstractPattern(t,i),t.pattern=t.multiplicity,this.DEBUG&&console.log("Final j-couplings: "+JSON.stringify(i))},abstractPattern:function(t,i){var r,o=.05,e="",n=1,s=[];if(i&&i.length>0){for(i.sort(function(t,i){return t-i}),r=0;r<i.length-1;r++)Math.abs(i[r]-i[r+1])<o?n++:(s.push({coupling:Math.abs(i[r]),multiplicity:this.patterns[n]}),e+=this.patterns[n],n=1);s.push({coupling:Math.abs(i[r]),multiplicity:this.patterns[n]}),e+=this.patterns[n],t.nmrJs=s}else e="s",Math.abs(t.startX-t.stopX)*t.observe>16&&(e="br s");return e},idealPattern:function(t){var i,r,o=Math.pow(2,t.length),e=[{x:0,intensity:o}];for(i=0;i<t.length;i++)for(r=e.length-1;r>=0;r--)e.push({x:e[r].x+t[i]/2,intensity:e[r].intensity/2}),e[r].x=e[r].x-t[i]/2,e[r].intensity=e[r].intensity/2;for(e.sort(function(t,i){return t.x-i.x}),r=e.length-2;r>=0;r--)Math.abs(e[r].x-e[r+1].x)<.1&&(e[r].intensity+=e[r+1].intensity,e.splice(r+1,1));return e},getNextCombination:function(t,i){for(var r,o,e=Math.ceil(t.values.length/2),n=t.values.length,s=0;s!=i;){o=!1;for(;!o;)if(o=!0,t.currentIndex[t.active]++,t.currentIndex[t.active]>=t.values[t.active].length){if(t.active+1==e)return null;t.currentIndex[t.active]=0,o=!1,t.active++}else t.active=0;for(s=0,r=0;e>r;r++)s+=2*t.values[r][t.currentIndex[r]];t.values.length%2!==0&&(s-=t.values[e-1][t.currentIndex[e-1]]),this.DEBUG&&(console.log(t.currentIndex),console.log(s+" "+i))}if(s==i){var a=new Array(n);for(r=0;e>r;r++)a[r]=t.values[r][t.currentIndex[r]],a[n-r-1]=t.values[r][t.currentIndex[r]];return a}return null},getRanges:function(t){var i,r,o=new Array(t.length),e=new Array(t.length);o[0]=[1],o[t.length-1]=[1],e[0]=-1,e[t.length-1]=0;for(var n=1;n<t.length-1;n++){i=Math.round(.85*t[n].intensity),r=Math.round(1.15*t[n].intensity),o[n]=[];for(var s=i;r>=s;s++)o[n].push(s);e[n]=0}return{values:o,currentIndex:e,active:0}},symmetrizeChoiseBest:function(t,i,r){var o=this.symmetrize(t,i,r),e=t.peaksComp,n=t.mask,s=t.delta1;t.delta1=(t.peaks[0].x+t.peaks[t.peaks.length-1].x)/2;var a=this.symmetrize(t,i,r);return t.peaksComp.length>e.length?a:(t.delta1=s,t.peaksComp=e,t.mask=n,o)},symmetrize:function(t,i,r){var o,e,n,s,a,l,u=new Array(t.peaks.length);for(l=0;l<u.length;l++)u[l]={x:t.peaks[l].x*t.observe,intensity:t.peaks[l].intensity,width:t.peaks[l].width};for(l=u.length-2;l>=0;l--)Math.abs(u[l].x-u[l+1].x)<.25&&(u[l].x=u[l].x*u[l].intensity+u[l+1].x*u[l+1].intensity,u[l].intensity=u[l].intensity+u[l+1].intensity,u[l].x/=u[l].intensity,u[l].intensity/=2,u[l].width+=u[l+1].width,u.splice(l+1,1));t.peaksComp=u;var h=u.length,f=new Array(h);t.mask=f;var c=0,p=u.length-1,m=t.delta1*t.observe,g=[(u[0].x+u[h-1].x)/2,1];i=this.error(Math.abs(m-g[0]));for(var y=0,v=0;h>v;v++)f[v]=!0,y+=t.peaks[v].intensity;for(;p>=c;){if(f[c]=!0,f[p]=!0,c==p)h>2&&Math.abs(u[c].x-m)>i&&(f[c]=!1);else if(o=Math.max(u[c].intensity,u[p].intensity),e=Math.min(u[c].intensity,u[p].intensity),s=o/e,s>this.symRatio)u[c].intensity==e?(f[c]=!1,p++):(f[p]=!1,c--);else{var d=Math.abs(u[c].x-m),w=Math.abs(u[p].x-m);Math.abs(d-w)<i?(n=Math.min(u[c].intensity,u[p].intensity),a=Math.min(u[c].width,u[p].width),u[c].intensity=u[p].intensity=n,u[c].width=u[p].width=a,g=[g[0]+(u[p].x+u[c].x)/2,g[1]+1]):Math.max(d,w)==w?(f[p]=!1,c--):(f[c]=!1,p++),this.DEBUG&&(console.log("MaxError: "+i+" "+g[0]+" "+g[1]),console.log(r+" CS: "+m+" Hz "+m/t.observe+" PPM"),console.log("Middle: "+g[0]/g[1]+" Hz "+g[0]/g[1]/t.observe+" PPM"),console.log(d+" "+w),console.log(Math.abs(d-w)),console.log(JSON.stringify(u)),console.log(JSON.stringify(f)))}if(c++,p--,1==r&&(m=this.chemicalShift(u,f),isNaN(m)))return 0;i=this.error(Math.abs(m-g[0]/g[1]))}for(v=h-1;v>=0;v--)f[v]===!1&&u.splice(v,1);if(m=this.chemicalShift(u),isNaN(m))return 0;t.delta1=m/t.observe;var b=0,C=0;if(u.length>1){for(v=Math.ceil(u.length/2)-1;v>=0;v--)b+=(3+Math.min(Math.abs(u[v].x-m),Math.abs(u[u.length-1-v].x-m)))/(3+Math.max(Math.abs(u[v].x-m),Math.abs(u[u.length-1-v].x-m)))*u[v].intensity,C+=u[v].intensity;b/=C}else 1==u.length&&(b=1);var M=0;for(v=0;v<u.length;v++)M+=u[v].intensity;if(b-=(y-M)/y*.12,this.DEBUG&&(console.log("Penalty "+(y-M)/y*.12),console.log("cs: "+m/t.observe+" symFactor: "+b)),b>.8&&.97>b&&2>r)return this.symmetrize(t,this.maxErrorIter2,2);if(u.length>1){var x,C=0;for(v=Math.ceil(u.length/2)-1;v>=0;v--)x=(u[v].x-u[u.length-1-v].x)/2,u[v].x=m+x,u[u.length-1-v].x=m-x}return b},error:function(t){var i=2.5*t;return.75>i&&(i=.75),i>3&&(i=3),i},normalize:function(t,i){var r,o=JSON.parse(JSON.stringify(t.peaksComp)),e=0,n=0;for(r=0;r<o.length;r++)e+=o[r].intensity;e=Math.pow(2,i)/e,t.mask2=JSON.parse(JSON.stringify(t.mask));var s=t.mask2.length-1;for(r=o.length-1;r>=0;r--){for(o[r].intensity*=e;s>=0&&t.mask2[s]===!1;)s--;o[r].intensity<.75?(this.DEBUG&&console.log("Peak "+r+" does not seem to belong to this multiplet "+o[r].intensity),o.splice(r,1),t.mask2[s]=!1):n+=o[r].intensity,s--}for(n=Math.pow(2,i)/n,r=o.length-1;r>=0;r--)o[r].intensity*=n;return this.DEBUG&&console.log(JSON.stringify(o)),o},chemicalShift:function(t,i){var r,o,e=0,n=0;if(i)for(r=0;r<t.length;r++)i[r]===!0&&(o=this.area(t[r]),e+=o,n+=o*t[r].x);else for(r=0;r<t.length;r++)o=this.area(t[r]),e+=o,n+=o*t[r].x;return n/e},area:function(t){return Math.abs(t.intensity*t.width*1.57)}};t.exports=r},function(t,i,r){t.exports.post=r(12),t.exports.gsd=r(35)},function(t,i,r){function o(t,i,r,o,e){var n=r.length,s=[],a=[],l=Math.sign(r[1]-r[0]);-1==l&&(e[0]=r.length-1);for(var u=Math.abs(i-t)/2,h=(t+i)/2,f=!1,c=e[0];!f&&n>c&&c>=0;)Math.abs(r[c]-h)<=u?(s.push(r[c]),a.push(o[c]),c+=l):1==Math.sign(h-r[c])?c+=l:f=!0;return e[0]=c,[s,a]}function e(t,i,r,e,s){var l,u,h=[0],f=n(t,e),c=[],p=1;for("gaussian"==s&&(p=1.17741),l=0;l<f.length;l++){var m=f[l].group;if(m.length>1){var g=o(f[l].limits[0]-f[l].limits[1],f[l].limits[0]+f[l].limits[1],i,r,h);if(g[0].length>5){var y=m[0].width/1e3,v=[3,100,y,y,y,10*y,10*y,11,9,1],d=[];for("gaussian"==s?d=a.optimizeGaussianSum(g,m,v):"lorentzian"==s&&(d=a.optimizeLorentzianSum(g,m,v)),u=0;u<d.length;u++)c.push({x:d[u][0][0],y:d[u][1][0],width:d[u][2][0]*p})}}else{m=m[0];var g=o(m.x-e*m.width,m.x+e*m.width,i,r,h);if(g[0].length>5){var y=m.width/1e3,v=[3,100,y,y,y,10*y,10*y,11,9,1],w=[];if("gaussian"==s)var w=a.optimizeSingleGaussian([g[0],g[1]],m,v);else if("lorentzian"==s)var w=a.optimizeSingleLorentzian([g[0],g[1]],m,v);c.push({x:w[0][0],y:w[1][0],width:w[2][0]*p})}}}return c}function n(t,i){var r,o,e,n,s=[],a=[],l=[t[0].x,i*t[0].width];for(r=0;r<t.length;r++)Math.abs(t[r].x-l[0])<i*t[r].width+l[1]?(s.push(t[r]),e=l[0]+l[1],t[r].x+i*t[r].width>e&&(e=t[r].x+i*t[r].width),n=l[0]-l[1],t[r].x-i*t[r].width<n&&(n=t[r].x-i*t[r].width),l=[(e+n)/2,Math.abs(e-n)/2]):(a.push({limits:l,group:s}),s=[t[r]],l=[t[r].x,i*t[r].width]);for(a.push({limits:l,group:s}),r=a.length-2;r>=0;r--)if(Math.abs(a[r].limits[0]-a[r+1].limits[0])<(a[r].limits[1]+a[r+1].limits[1])/2){for(o=0;o<a[r+1].group.length;o++)a[r].group.push(a[r+1].group[o]);e=a[r].limits[0]+a[r].limits[1],a[r+1].limits[0]+a[r+1].limits[1]>e&&(e=a[r+1].limits[0]+a[r+1].limits[1]),n=a[r].limits[0]-a[r].limits[1],a[r+1].limits[0]-a[r+1].limits[1]<n&&(n=a[r+1].limits[0]-a[r+1].limits[1]),a[r].limits=[(e+n)/2,Math.abs(e-n)/2],a.splice(r+1,1)}return a}function s(t,i){for(var r=i.width,o=[],e=0,n=0,s=1,l=t.length-1;l>=0;l--)t[l].soft&&o.push(t.splice(l,1)[0]);o.push({x:Number.MAX_VALUE});for(var u=[[o[0].x,o[0].y]],h=[0],l=1;l<o.length;l++)if(Math.abs(o[l-1].x-o[l].x)<r)u.push([o[l].x,o[l].y]),o[l].y>e&&(e=o[l].y,n=l),h.push(l),s++;else{if(s>2){var f=a.optimizeSingleLorentzian(u,{x:o[n].x,y:e,width:Math.abs(u[0][0]-u[u.length-1][0])});t.push({x:f[0][0],y:f[1][0],width:f[2][0],soft:!1})}else h.map(function(i){t.push(o[i])});u=[[o[l].x,o[l].y]],h=[l],e=o[l].y,n=l,s=1}return t.sort(function(t,i){return t.x-i.x}),t}var a=r(13);t.exports={optimizePeaks:e,joinBroadPeaks:s}},function(t,i,r){"use strict";function o(t,i,r){var o,e,n,s,a=i.length/3,l=t.rows,u=p.zeros(t.length,1);for(e=0;a>e;e++)for(s=Math.pow(i[e+2*a][0]/2,2),o=i[e+a][0]*s,n=0;l>n;n++)u[n][0]+=o/(Math.pow(t[n][0]-i[e][0],2)+s);return u}function e(t,i,r){for(var o=i[1][0]*Math.pow(i[2][0]/2,2),e=t.rows,n=new p(t.rows,t.columns),s=0;e>s;s++)n[s][0]=o/(Math.pow(t[s][0]-i[0][0],2)+Math.pow(i[2][0]/2,2));return n}function n(t,i,r){for(var o=i[2][0]*i[2][0]/2,e=t.rows,n=new p(t.rows,t.columns),s=0;e>s;s++)n[s][0]=i[1][0]*Math.exp(-(t[s][0]-i[0][0])*(t[s][0]-i[0][0])/o);return n}function s(t,i,r){var o=h(t),n=o[0],s=o[1],a=o[2],l=n.columns,u=[l/Math.sqrt(s.dot(s))],r=Object.create(r||[3,100,.001,.001,.001,.01,.01,11,9,1]),c=[],m=Math.abs(n[0][0]-n[1][0]),g=new p([[-m/1e4],[-.001],[-m/1e4]]),y=new p([[i.x],[1],[i.width]]),v=new p([[i.x-m],[.75],[i.width/4]]),d=new p([[i.x+m],[1.25],[4*i.width]]),w=f.optimize(e,y,n,s,u,g,v,d,c,r);return w=w.p,[w[0],[w[1][0]*a],w[2]]}function a(t,i,r){var o=h(t),e=o[0],s=o[1],a=o[2],l=e.columns,u=[l/Math.sqrt(s.dot(s))],r=Object.create(r||[3,100,.001,.001,.001,.01,.01,11,9,1]),c=[],m=Math.abs(e[0][0]-e[1][0]),g=new p([[-m/1e4],[-.001],[-m/1e4]]),g=new p([[-Math.abs(e[0][0]-e[1][0])/1e3],[-.001],[-i.width/1e3]]),y=new p([[i.x],[1],[i.width]]),v=new p([[i.x-m],[.75],[i.width/4]]),d=new p([[i.x+m],[1.25],[4*i.width]]),w=f.optimize(n,y,e,s,u,g,v,d,c,r);return w=w.p,[w[0],[w[1][0]*a],w[2]]}function l(t,i,r){var e,n=h(t),s=n[0],a=n[1],l=n[2],u=s.columns,m=[u/c.sqrt(a.dot(a))],r=Object.create(r||[3,100,.001,.001,.001,.01,.01,11,9,1]),g=[],y=i.length,v=new p(3*y,1),d=new p(3*y,1),w=new p(3*y,1),b=new p(3*y,1),C=Math.abs(s[0][0]-s[1][0]);for(e=0;y>e;e++)v[e][0]=i[e].x,v[e+y][0]=1,v[e+2*y][0]=i[e].width,d[e][0]=i[e].x-C,d[e+y][0]=0,d[e+2*y][0]=i[e].width/4,w[e][0]=i[e].x+C,w[e+y][0]=1.5,w[e+2*y][0]=4*i[e].width,b[e][0]=-C/1e3,b[e+y][0]=-.001,b[e+2*y][0]=-C/1e3;var b=-Math.abs(s[0][0]-s[1][0])/1e4,M=f.optimize(o,v,s,a,m,b,d,w,g,r);M=M.p;var x=new Array(y);for(e=0;y>e;e++)x[e]=[M[e],[M[e+y][0]*l],M[e+2*y]];return x}function u(t,i,r){var e,n=h(t),s=n[0],a=n[1],l=n[2],u=s.rows,m=new p(u,1),g=u/c.sqrt(a.dot(a));for(e=0;u>e;e++)m[e][0]=g;var r=Object.create(r||[3,100,.001,.001,.001,.01,.01,11,9,2]),y=[],v=i.length,d=new p(3*v,1),w=new p(3*v,1),b=new p(3*v,1),C=new p(3*v,1),M=Math.abs(s[0][0]-s[1][0]);for(e=0;v>e;e++)d[e][0]=i[e].x,d[e+v][0]=i[e].y/l,d[e+2*v][0]=i[e].width,w[e][0]=i[e].x-M,w[e+v][0]=.8*i[e].y/l,w[e+2*v][0]=i[e].width/2,b[e][0]=i[e].x+M,b[e+v][0]=1.2*i[e].y/l,b[e+2*v][0]=2*i[e].width,C[e][0]=-M/1e3,C[e+v][0]=-.001,C[e+2*v][0]=-M/1e3;var x=f.optimize(o,d,s,a,m,C,w,b,y,r);x=x.p;var H=new Array(v);for(e=0;v>e;e++)H[e]=[x[e],[x[e+v][0]*l],x[e+2*v]];return H}function h(t){var i,r,o,e=t.length,n=null,s=null,a=0;if(2==e){var l=t[0].length;if(3>l)throw new SizeException(l);if(n=new p(l,1),s=new p(l,1),i=t[0],r=t[1],"number"==typeof i[0])for(o=0;l>o;o++)n[o][0]=i[o],s[o][0]=r[o],r[o]>a&&(a=r[o]);else if("object"==typeof i[0])for(o=0;l>o;o++)n[o][0]=i[o][0],s[o][0]=r[o][0],r[o][0]>a&&(a=r[o][0])}else{var l=e;if(3>l)throw new SizeException(l);for(n=new p(l,1),s=new p(l,1),o=0;l>o;o++)n[o][0]=t[o][0],s[o][0]=t[o][1],s[o][0]>a&&(a=s[o][0])}for(o=0;l>o;o++)s[o][0]/=a;return[n,s,a]}var f=r(14),c=f.Matrix.algebra,p=r(26);t.exports.optimizeSingleLorentzian=s,t.exports.optimizeLorentzianSum=l,t.exports.optimizeSingleGaussian=a,t.exports.optimizeGaussianSum=u,t.exports.singleGaussian=n,t.exports.singleLorentzian=e},function(t,i,r){"use strict";t.exports=r(15),t.exports.Matrix=r(16),t.exports.Matrix.algebra=r(25)},function(t,i,r){var o=r(16),e=r(25),n={optimize:function(t,i,r,n,s,a,l,u,h,f){var c=0,p=0;if("object"!=typeof i[0])for(var m=0;m<i.length;m++)i[m]=[i[m]];var m,g,y=-50,v=i.length,d=n.length,w=o.zeros(v,1),b=o.zeros(d,1),C=.01/y,M=.01/y,x=o.zeros(d,v);if(r.length!=n.length){console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=r.length,length_y_dat=n.length;var C=0;if(!c)return}s=s||Math.sqrt((d-v+1)/e.multiply(e.transpose(n),n)),a=a||.001,l=l||e.multiply(Math.abs(i),-100),u=u||e.multiply(Math.abs(i),100),h=h||1,f=f||[3,10*v,.001,.001,.001,.01,.01,11,9,1];var H=f[0],A=f[1],D=f[2],S=(f[3],f[4],f[5]),E=f[6],R=f[7],X=f[8],k=f[9];if(c&&3==H&&(H=2),!a.length||1==a.length){for(var F=new Array(v),m=0;v>m;m++)F[m]=[a];a=F}var P=[];for(m=0;m<a.length;m++)0!=a[m][0]&&P.push(m);var N=P.length,O=!1,Y=null;if(!s.length||s.length<d){var T=e.multiply(o.ones(d,1),s[0]);Y=e.dotMultiply(T,T)}else Y=e.dotMultiply(s,s);var _=this.lm_matx(t,r,w,b,1,x,i,n,Y,a,h),I=_.JtWJ,V=_.JtWdy,C=_.Chi_sq,z=_.y_hat,x=_.J;switch(Math.max(Math.abs(V))<D&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",D),O=!0),k){case 1:lambda=E;break;default:lambda=E*Math.max(e.diag(I)),nu=2}M=C;for(var U=null;!O&&A>=p;){switch(p+=1,k){case 1:U=e.solve(e.add(I,e.multiply(e.diag(e.diag(I)),lambda)),V);break;default:U=e.solve(e.add(I,e.multiply(o.eye(v),lambda)),V)}var L=new Array(P.length);for(g=0;g<P.length;g++)L[g]=U[P[g]];var q=e.add(i,L);for(g=0;g<q.length;g++)q[g][0]=Math.min(Math.max(l[g][0],q[g][0]),u[g][0]);var j=e.subtract(n,t(r,q,h)),$=e.multiply(e.transpose(j),e.dotMultiply(j,Y));if(2==k){var B=e.multiply(e.transpose(V),U),J=e.multiply(B,e.inv(e.add(e.multiply(e.subtract($-C),.5)),e.multiply(B,2)));U=e.multiply(J,U);for(var g=0;g<P.length;g++)L[g]=U[P[g]];q=e.add(i,L),q=e.min(e.max(l,q),u),j=e.subtract(n,t(r,q,h)),$=e.multiply(e.transpose(j),mat.dotMultiply(j,Y))}var G=(C-$)/e.multiply(e.multiply(e.transpose(U),2),e.add(e.multiply(lambda,U),V));if(G>S)switch(dX2=C-M,M=C,w=i,b=z,i=q,_=this.lm_matx(t,r,w,b,dX2,x,i,n,Y,a,h),I=_.JtWJ,V=_.JtWdy,C=_.Chi_sq,z=_.y_hat,x=_.J,k){case 1:lambda=Math.max(lambda/X,1e-7);break;case 2:lambda=Math.max(lambda/(1+J),1e-7);break;case 3:lambda=e.multiply(Math.max(1/3,1-(2*G-1)^3),lambda),nu=2}else switch(C=M,p%(2*v)==0&&(_=this.lm_matx(t,r,w,b,-1,x,i,n,Y,a,h),I=_.JtWJ,V=_.JtWdy,dX2=_.Chi_sq,z=_.y_hat,x=_.J),k){case 1:lambda=Math.min(lambda*R,1e7);break;case 2:lambda+=Math.abs(($-C)/2/J);break;case 3:lambda*=nu,nu=2*nu}}return Y=e.multiply(e.multiply(e.transpose(j),j),o.ones(d,1)),Y.apply(function(t,i){Y[t][i]=(d-N+1)/Y[t][i]}),_=this.lm_matx(t,r,w,b,-1,x,i,n,Y,a,h),I=_.JtWJ,V=_.JtWdy,C=_.Chi_sq,z=_.y_hat,x=_.J,{p:i,X2:C}},lm_FD_J:function(t,i,r,n,s,a){var l=n.length,u=r.length;s=s||e.multiply(o.ones(u,1),.001);for(var h=r.clone(),f=new o(l,u),c=new Array(u),p=0;u>p;p++){if(c[p]=s[p]*(1+Math.abs(r[p][0])),r[p]=[h[p][0]+c[p]],0!=c[p])if(y1=t(i,r,a),s[p][0]<0)for(var m=e.dotDivide(e.subtract(y1,n),c[p]),g=0;l>g;g++)f[g][p]=m[g][0];else{r[p][0]=h[p][0]-c[p];for(var m=e.dotDivide(e.subtract(y1,t(i,r,a)),2*c[p]),g=0;l>g;g++)f[g][p]=m[g][0]}r[p]=h[p]}return f},lm_Broyden_J:function(t,i,r,o,n){var s=e.subtract(o,t),a=e.transpose(s);return a.div(e.multiply(a,s)),r=e.add(r,e.multiply(e.subtract(n,e.add(i,e.multiply(r,s))),a))},lm_matx:function(t,i,r,n,s,a,l,u,h,f,c,p){var m=(u.length,l.length);f=f||.001;var g=t(i,l,c);a=p%(2*m)==0||s>0?this.lm_FD_J(t,i,l,g,f,c):this.lm_Broyden_J(r,n,a,l,g);var y=e.subtract(u,g),v=e.multiply(e.transpose(y),e.dotMultiply(y,h)),d=e.transpose(a),w=e.multiply(d,e.dotMultiply(a,e.multiply(h,o.ones(1,m)))),b=e.multiply(d,e.dotMultiply(h,y));return{JtWJ:w,JtWdy:b,Chi_sq:v,y_hat:g,J:a}}};t.exports=n},function(t,i,r){"use strict";t.exports=r(17),t.exports.Decompositions=t.exports.DC=r(18)},function(t,i){"use strict";function r(t){for(var i=0,r=t.length,o=new Array(r);r>i;i++)o[i]=t[i];return o}function o(t,i){var e,n,s=0;if(Array.isArray(t)){if(n=i,e=n?r(t):t,t=e.length,i=e[0].length,"undefined"==typeof i)throw new TypeError("Data must be a 2D array");if(!(t>0&&i>0))throw new RangeError("Invalid dimensions: "+t+"x"+i);for(;t>s;s++){if(e[s].length!==i)throw new RangeError("Inconsistent array dimensions");n&&(e[s]=r(e[s]))}}else{if("number"!=typeof t)throw new TypeError("Invalid arguments");if(!(t>0&&i>0))throw new RangeError("Invalid dimensions: "+t+"x"+i);for(e=new Array(t);t>s;s++)e[s]=new Array(i)}return Object.defineProperty(e,"rows",{writable:!0,value:t}),Object.defineProperty(e,"columns",{writable:!0,value:i}),e.__proto__=o.prototype,e}var e=Array.prototype.splice,n=Array.prototype.concat;o.from1DArray=function(t,i,r){var e,n,s=0;if(e=t*i,e!==r.length)throw new RangeError("Data length does not match given dimensions");for(n=new Array(t);t>s;s++)n[s]=r.slice(s*i,(s+1)*i);return new o(n)},o.rowVector=function(t){return new o([t])},o.columnVector=function(t){for(var i=t.length,r=new Array(i),e=0;i>e;e++)r[e]=[t[e]];return new o(r)},o.empty=function(t,i){return new o(t,i)},o.zeros=function(t,i){return o.empty(t,i).fill(0)},o.ones=function(t,i){return o.empty(t,i).fill(1)},o.rand=function(t,i){for(var r=o.empty(t,i),e=0,n=r.rows;n>e;e++)for(var s=0,a=r.columns;a>s;s++)r[e][s]=Math.random();return r},o.eye=function(t){for(var i=o.zeros(t,t),r=i.rows,e=0;r>e;e++)i[e][e]=1;return i},o.diag=function(t){for(var i=t.length,r=o.zeros(i,i),e=0;i>e;e++)r[e][e]=t[e];return r},o.indices=function(t,i){for(var r=new Array(i-t),o=0;o<r.length;o++)r[o]=t++;return r},o.stack=function(t){var i,r,e;if(o.isMatrix(t)){var n=0,s=0;for(i=0;i<arguments.length;i++)n+=arguments[i].rows,arguments[i].columns>s&&(s=arguments[i].columns);var a=o.zeros(n,s),l=0;for(i=0;i<arguments.length;i++){var u=arguments[i];for(r=0;r<u.rows;r++){for(e=0;e<u.columns;e++)a[l][e]=u[r][e];l++}}return a}if(Array.isArray(t)){var h=o.empty(arguments.length,t.length);for(i=0;i<arguments.length;i++)h.setRow(i,arguments[i]);return h}},o.expand=function(t,i){for(var r=[],e=0;e<i.length;e++)for(var n=0;n<i[e];n++)r.push(t[e]);return new o(r)},o.checkMatrix=function(t){if(!t)throw new TypeError("Argument has to be a matrix");return"Matrix"!==t.klass&&(t=new o(t)),t},o.isMatrix=function(t){return t?"Matrix"===t.klass:!1},Object.defineProperty(o.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(o.prototype,"size",{get:function(){return this.rows*this.columns}}),o.prototype.checkRowIndex=function(t){if(0>t||t>this.rows-1)throw new RangeError("Row index out of range.")},o.prototype.checkColumnIndex=function(t){if(0>t||t>this.columns-1)throw new RangeError("Column index out of range.")},o.prototype.checkDimensions=function(t){if(this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal.")},o.prototype.apply=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)t.call(this,o,e);return this},o.prototype.clone=function(){return new o(this.to2DArray())},o.prototype.to1DArray=function(){return n.apply([],this)},o.prototype.to2DArray=function(){for(var t=this.rows,i=new Array(t),o=0;t>o;o++)i[o]=r(this[o]);return i},o.prototype.isRowVector=function(){return 1===this.rows},o.prototype.isColumnVector=function(){return 1===this.columns},o.prototype.isVector=function(){return 1===this.rows||1===this.columns},o.prototype.isSquare=function(){return this.rows===this.columns},o.prototype.isSymmetric=function(){if(this.isSquare()){for(var t=this.rows,i=0;t>i;i++)for(var r=0;i>=r;r++)if(this[i][r]!==this[r][i])return!1;return!0}return!1},o.prototype.set=function(t,i,r){return this[t][i]=r,this},o.prototype.get=function(t,i){return this[t][i]},o.prototype.fill=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]=t;return this},o.prototype.neg=function(){return this.mulS(-1)},o.prototype.add=function(t){return"number"==typeof t?this.addS(t):(t=o.checkMatrix(t),this.addM(t))},o.prototype.addS=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]+=t;return this},o.prototype.addM=function(t){this.checkDimensions(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]+=t[o][e];return this},o.prototype.sub=function(t){return"number"==typeof t?this.subS(t):(t=o.checkMatrix(t),
this.subM(t))},o.prototype.subS=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]-=t;return this},o.prototype.subM=function(t){this.checkDimensions(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]-=t[o][e];return this},o.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):(t=o.checkMatrix(t),this.mulM(t))},o.prototype.mulS=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]*=t;return this},o.prototype.mulM=function(t){this.checkDimensions(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]*=t[o][e];return this},o.prototype.div=function(t){return"number"==typeof t?this.divS(t):(t=o.checkMatrix(t),this.divM(t))},o.prototype.divS=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]/=t;return this},o.prototype.divM=function(t){this.checkDimensions(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]/=t[o][e];return this},o.prototype.getRow=function(t){return this.checkRowIndex(t),r(this[t])},o.prototype.getRowVector=function(t){return o.rowVector(this.getRow(t))},o.prototype.setRow=function(t,i){if(this.checkRowIndex(t),o.isMatrix(i)&&(i=i.to1DArray()),i.length!==this.columns)throw new RangeError("Invalid row size");return this[t]=r(i),this},o.prototype.removeRow=function(t){if(this.checkRowIndex(t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,t,1),this.rows-=1,this},o.prototype.addRow=function(t,i){if("undefined"==typeof i&&(i=t,t=this.rows),0>t||t>this.rows)throw new RangeError("Row index out of range.");if(o.isMatrix(i)&&(i=i.to1DArray()),i.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,t,0,r(i)),this.rows+=1,this},o.prototype.swapRows=function(t,i){this.checkRowIndex(t),this.checkRowIndex(i);var r=this[t];return this[t]=this[i],this[i]=r,this},o.prototype.getColumn=function(t){this.checkColumnIndex(t);for(var i=this.rows,r=new Array(i),o=0;i>o;o++)r[o]=this[o][t];return r},o.prototype.getColumnVector=function(t){return o.columnVector(this.getColumn(t))},o.prototype.setColumn=function(t,i){this.checkColumnIndex(t),o.isMatrix(i)&&(i=i.to1DArray());var r=this.rows;if(i.length!==r)throw new RangeError("Invalid column size");for(var e=0;r>e;e++)this[e][t]=i[e];return this},o.prototype.removeColumn=function(t){if(this.checkColumnIndex(t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var i=0,r=this.rows;r>i;i++)this[i].splice(t,1);return this.columns-=1,this},o.prototype.addColumn=function(t,i){if("undefined"==typeof i&&(i=t,t=this.columns),0>t||t>this.columns)throw new RangeError("Column index out of range.");o.isMatrix(i)&&(i=i.to1DArray());var r=this.rows;if(i.length!==r)throw new RangeError("Invalid column size");for(var e=0;r>e;e++)this[e].splice(t,0,i[e]);return this.columns+=1,this},o.prototype.swapColumns=function(t,i){this.checkRowIndex(t),this.checkRowIndex(i);for(var r,o,e=this.rows,n=0;e>n;n++)o=this[n],r=o[t],o[t]=o[i],o[i]=r;return this},o.prototype.checkRowVector=function(t){if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return t},o.prototype.checkColumnVector=function(t){if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return t},o.prototype.addRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]+=t[e];return this},o.prototype.subRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]-=t[e];return this},o.prototype.mulRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]*=t[e];return this},o.prototype.divRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]/=t[e];return this},o.prototype.addColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]+=t[o];return this},o.prototype.subColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]-=t[o];return this},o.prototype.mulColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]*=t[o];return this},o.prototype.divColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]/=t[o];return this},o.prototype.mulRow=function(t,i){this.checkRowIndex(t);for(var r=0,o=this.columns;o>r;r++)this[t][r]*=i;return this},o.prototype.mulColumn=function(t,i){this.checkColumnIndex(t);for(var r=0,o=this.rows;o>r;r++)this[r][t]*=i},o.prototype.max=function(){for(var t=-(1/0),i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]>t&&(t=this[o][e]);return t},o.prototype.maxIndex=function(){for(var t=-(1/0),i={},r=this.rows,o=this.columns,e=0;r>e;e++)for(var n=0;o>n;n++)this[e][n]>t&&(t=this[e][n],i.row=e,i.column=n);return i},o.prototype.min=function(){for(var t=1/0,i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]<t&&(t=this[o][e]);return t},o.prototype.minIndex=function(){for(var t=1/0,i={},r=this.rows,o=this.columns,e=0;r>e;e++)for(var n=0;o>n;n++)this[e][n]<t&&(t=this[e][n],i.row=e,i.column=n);return i},o.prototype.maxRow=function(t){this.checkRowIndex(t);for(var i=-(1/0),r=0,o=this.columns;o>r;r++)this[t][r]>i&&(i=this[t][r]);return i},o.prototype.maxRowIndex=function(t){this.checkRowIndex(t);for(var i=-(1/0),r={row:t},o=0,e=this.columns;e>o;o++)this[t][o]>i&&(i=this[t][o],r.column=o);return r},o.prototype.minRow=function(t){this.checkRowIndex(t);for(var i=1/0,r=0,o=this.columns;o>r;r++)this[t][r]<i&&(i=this[t][r]);return i},o.prototype.minRowIndex=function(t){this.checkRowIndex(t);for(var i=1/0,r={row:t,column:0},o=0,e=this.columns;e>o;o++)this[t][o]<i&&(i=this[t][o],r.column=o);return r},o.prototype.maxColumn=function(t){this.checkColumnIndex(t);for(var i=-(1/0),r=0,o=this.rows;o>r;r++)this[r][t]>i&&(i=this[r][t]);return i},o.prototype.maxColumnIndex=function(t){this.checkColumnIndex(t);for(var i=-(1/0),r={row:0,column:t},o=0,e=this.rows;e>o;o++)this[o][t]>i&&(i=this[o][t],r.row=o);return r},o.prototype.minColumn=function(t){this.checkColumnIndex(t);for(var i=1/0,r=0,o=this.rows;o>r;r++)this[r][t]<i&&(i=this[r][t]);return i},o.prototype.minColumnIndex=function(t){this.checkColumnIndex(t);for(var i=1/0,r={row:0,column:t},o=0,e=this.rows;e>o;o++)this[o][t]<i&&(i=this[o][t],r.row=o);return r},o.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),t=0,i=this.rows;i>t;t++)s[t]=this[t][t];return s},o.prototype.sum=function(){for(var t=0,i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)t+=this[o][e];return t},o.prototype.mean=function(){return this.sum()/this.size},o.prototype.prod=function a(){for(var a=1,t=this.rows,i=this.columns,r=0;t>r;r++)for(var o=0;i>o;o++)a*=this[r][o];return a},o.prototype.cumulativeSum=function(){for(var t=0,i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)t+=this[o][e],this[o][e]=t;return this},o.prototype.dot=function l(t){if(this.size!==t.size)throw new RangeError("vectors do not have the same size");for(var i=this.to1DArray(),r=t.to1DArray(),l=0,o=i.length,e=0;o>e;e++)l+=i[e]*r[e];return l},o.prototype.mmul=function(t){if(!o.isMatrix(t))throw new TypeError('parameter "other" must be a matrix');this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var i,r,e,n=this.rows,s=this.columns,a=t.columns,l=new o(n,a),u=new Array(s);for(r=0;a>r;r++){for(e=0;s>e;e++)u[e]=t[e][r];for(i=0;n>i;i++){var h=this[i],f=0;for(e=0;s>e;e++)f+=h[e]*u[e];l[i][r]=f}}return l},o.prototype.sortRows=function(t){for(var i=0,r=this.rows;r>i;i++)this[i].sort(t);return this},o.prototype.sortColumns=function(t){for(var i=0,r=this.columns;r>i;i++)this.setColumn(i,this.getColumn(i).sort(t));return this},o.prototype.transpose=function(){for(var t=new o(this.columns,this.rows),i=this.rows,r=this.columns,e=0;i>e;e++)for(var n=0;r>n;n++)t[n][e]=this[e][n];return t},o.prototype.subMatrix=function(t,i,r,e){if(t>i||r>e||0>t||t>=this.rows||0>i||i>=this.rows||0>r||r>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range");for(var n=new o(i-t+1,e-r+1),s=t;i>=s;s++)for(var a=r;e>=a;a++)n[s-t][a-r]=this[s][a];return n},o.prototype.subMatrixRow=function(t,i,r){if("undefined"==typeof i?(i=0,r=this.columns-1):"undefined"==typeof r&&(r=this.columns-1),i>r||0>i||i>=this.columns||0>r||r>=this.columns)throw new RangeError("Argument out of range.");for(var e=t.length,n=this.rows,s=new o(e,r-i+1),a=0;e>a;a++)for(var l=i;r>=l;l++){if(t[a]<0||t[a]>=n)throw new RangeError("Argument out of range.");s[a][l-i]=this[t[a]][l]}return s},o.prototype.subMatrixColumn=function(t,i,r){if("undefined"==typeof i?(i=0,r=this.rows-1):"undefined"==typeof r&&(r=this.rows-1),i>r||0>i||i>=this.rows||0>r||r>=this.rows)throw new RangeError("Argument out of range.");for(var e=t.length,n=this.columns,s=new o(r-i+1,e),a=0;e>a;a++)for(var l=i;r>=l;l++){if(t[a]<0||t[a]>=n)throw new RangeError("Argument out of range.");s[l-i][a]=this[l][t[a]]}return s},o.prototype.trace=function u(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var u=0,t=0,i=this.rows;i>t;t++)u+=this[t][t];return u},o.prototype.abs=function(){for(var t=this.rows,i=this.columns,r=0;t>r;r++)for(var o=0;i>o;o++)this[r][o]=Math.abs(this[r][o])},t.exports=o},function(t,i,r){"use strict";function o(t){return e(t,n.eye(t.rows))}function e(t,i){return t.isSquare()?new l(t).solve(i):new u(t).solve(i)}var n=r(17),s=r(19),a=r(21),l=r(22),u=r(23),h=r(24);n.prototype.inverse=function(){return o(this)},n.prototype.solve=function(t){return e(this,t)},t.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:u,QR:u,CholeskyDecomposition:h,CHO:h,inverse:o,solve:e}},function(t,i,r){"use strict";function o(t,i){if(!(this instanceof o))return new o(t,i);t=e.checkMatrix(t),i=i||{};var r=t.clone(),s=t.rows,a=t.columns,l=Math.min(s,a),u=!0,h=!0;i.computeLeftSingularVectors===!1&&(u=!1),i.computeRightSingularVectors===!1&&(h=!1);var f=i.autoTranspose===!0,c=!1;if(a>s)if(f){r=r.transpose(),s=r.rows,a=r.columns,c=!0;var p=u;u=h,h=p}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var m,g,y,v,d,w,b,C,M,x,H,A,D,S,E,R,X,k,F,P,N,O=new Array(Math.min(s+1,a)),Y=e.zeros(s,l),T=e.zeros(a,a),_=new Array(a),I=new Array(s),V=Math.min(s-1,a),z=Math.max(0,Math.min(a-2,s));for(y=0,x=Math.max(V,z);x>y;y++){if(V>y){for(O[y]=0,m=y;s>m;m++)O[y]=n(O[y],r[m][y]);if(0!==O[y]){for(r[y][y]<0&&(O[y]=-O[y]),m=y;s>m;m++)r[m][y]/=O[y];r[y][y]+=1}O[y]=-O[y]}for(g=y+1;a>g;g++){if(V>y&&0!==O[y]){for(d=0,m=y;s>m;m++)d+=r[m][y]*r[m][g];for(d=-d/r[y][y],m=y;s>m;m++)r[m][g]+=d*r[m][y]}_[g]=r[y][g]}if(u&&V>y)for(m=y;s>m;m++)Y[m][y]=r[m][y];if(z>y){for(_[y]=0,m=y+1;a>m;m++)_[y]=n(_[y],_[m]);if(0!==_[y]){for(_[y+1]<0&&(_[y]=-_[y]),m=y+1;a>m;m++)_[m]/=_[y];_[y+1]+=1}if(_[y]=-_[y],s>y+1&&0!==_[y]){for(m=y+1;s>m;m++)I[m]=0;for(g=y+1;a>g;g++)for(m=y+1;s>m;m++)I[m]+=_[g]*r[m][g];for(g=y+1;a>g;g++)for(d=-_[g]/_[y+1],m=y+1;s>m;m++)r[m][g]+=d*I[m]}if(h)for(m=y+1;a>m;m++)T[m][y]=_[m]}}if(v=Math.min(a,s+1),a>V&&(O[V]=r[V][V]),v>s&&(O[v-1]=0),v>z+1&&(_[z]=r[z][v-1]),_[v-1]=0,u){for(g=V;l>g;g++){for(m=0;s>m;m++)Y[m][g]=0;Y[g][g]=1}for(y=V-1;y>=0;y--)if(0!==O[y]){for(g=y+1;l>g;g++){for(d=0,m=y;s>m;m++)d+=Y[m][y]*Y[m][g];for(d=-d/Y[y][y],m=y;s>m;m++)Y[m][g]+=d*Y[m][y]}for(m=y;s>m;m++)Y[m][y]=-Y[m][y];for(Y[y][y]=1+Y[y][y],m=0;y-1>m;m++)Y[m][y]=0}else{for(m=0;s>m;m++)Y[m][y]=0;Y[y][y]=1}}if(h)for(y=a-1;y>=0;y--){if(z>y&&0!==_[y])for(g=y+1;a>g;g++){for(d=0,m=y+1;a>m;m++)d+=T[m][y]*T[m][g];for(d=-d/T[y+1][y],m=y+1;a>m;m++)T[m][g]+=d*T[m][y]}for(m=0;a>m;m++)T[m][y]=0;T[y][y]=1}for(var U=v-1,L=0,q=Math.pow(2,-52);v>0;){for(y=v-2;y>=-1&&-1!==y;y--)if(Math.abs(_[y])<=q*(Math.abs(O[y])+Math.abs(O[y+1]))){_[y]=0;break}if(y===v-2)H=4;else{for(w=v-1;w>=y&&w!==y;w--)if(d=(w!==v?Math.abs(_[w]):0)+(w!==y+1?Math.abs(_[w-1]):0),Math.abs(O[w])<=q*d){O[w]=0;break}w===y?H=3:w===v-1?H=1:(H=2,y=w)}switch(y++,H){case 1:for(b=_[v-2],_[v-2]=0,g=v-2;g>=y;g--)if(d=n(O[g],b),C=O[g]/d,M=b/d,O[g]=d,g!==y&&(b=-M*_[g-1],_[g-1]=C*_[g-1]),h)for(m=0;a>m;m++)d=C*T[m][g]+M*T[m][v-1],T[m][v-1]=-M*T[m][g]+C*T[m][v-1],T[m][g]=d;break;case 2:for(b=_[y-1],_[y-1]=0,g=y;v>g;g++)if(d=n(O[g],b),C=O[g]/d,M=b/d,O[g]=d,b=-M*_[g],_[g]=C*_[g],u)for(m=0;s>m;m++)d=C*Y[m][g]+M*Y[m][y-1],Y[m][y-1]=-M*Y[m][g]+C*Y[m][y-1],Y[m][g]=d;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(O[v-1]),Math.abs(O[v-2])),Math.abs(_[v-2])),Math.abs(O[y])),Math.abs(_[y])),D=O[v-1]/A,S=O[v-2]/A,E=_[v-2]/A,R=O[y]/A,X=_[y]/A,k=((S+D)*(S-D)+E*E)/2,F=D*E*(D*E),P=0,(0!==k||0!==F)&&(P=Math.sqrt(k*k+F),0>k&&(P=-P),P=F/(k+P)),b=(R+D)*(R-D)+P,N=R*X,g=y;v-1>g;g++){if(d=n(b,N),C=b/d,M=N/d,g!==y&&(_[g-1]=d),b=C*O[g]+M*_[g],_[g]=C*_[g]-M*O[g],N=M*O[g+1],O[g+1]=C*O[g+1],h)for(m=0;a>m;m++)d=C*T[m][g]+M*T[m][g+1],T[m][g+1]=-M*T[m][g]+C*T[m][g+1],T[m][g]=d;if(d=n(b,N),C=b/d,M=N/d,O[g]=d,b=C*_[g]+M*O[g+1],O[g+1]=-M*_[g]+C*O[g+1],N=M*_[g+1],_[g+1]=C*_[g+1],u&&s-1>g)for(m=0;s>m;m++)d=C*Y[m][g]+M*Y[m][g+1],Y[m][g+1]=-M*Y[m][g]+C*Y[m][g+1],Y[m][g]=d}_[v-2]=b,L+=1;break;case 4:if(O[y]<=0&&(O[y]=O[y]<0?-O[y]:0,h))for(m=0;U>=m;m++)T[m][y]=-T[m][y];for(;U>y&&!(O[y]>=O[y+1]);){if(d=O[y],O[y]=O[y+1],O[y+1]=d,h&&a-1>y)for(m=0;a>m;m++)d=T[m][y+1],T[m][y+1]=T[m][y],T[m][y]=d;if(u&&s-1>y)for(m=0;s>m;m++)d=Y[m][y+1],Y[m][y+1]=Y[m][y],Y[m][y]=d;y++}L=0,v--}}if(c){var j=T;T=Y,Y=j}this.m=s,this.n=a,this.s=O,this.U=Y,this.V=T}var e=r(17),n=r(20).hypotenuse;o.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),i=Math.max(this.m,this.n)*this.s[0]*t,r=0,o=this.s,e=0,n=o.length;n>e;e++)o[e]>i&&r++;return r},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(t){var i,r=t,o=this.threshold,n=this.s.length,s=e.zeros(n,n);for(i=0;n>i;i++)Math.abs(this.s[i])<=o?s[i][i]=0:s[i][i]=1/this.s[i];var a,l,u,h=this.V.mmul(s),f=this.V.rows,c=this.U.rows,p=e.zeros(f,c);for(i=0;f>i;i++)for(a=0;c>a;a++){for(u=0,l=0;n>l;l++)u+=h[i][l]*this.U[a][l];p[i][a]=u}return p.mmul(r)},solveForDiagonal:function(t){return this.solve(e.diag(t))},inverse:function(){var t,i,r=this.threshold,o=this.V.rows,n=this.V.columns,s=new e(o,this.s.length);for(t=0;o>t;t++)for(i=0;n>i;i++)Math.abs(this.s[i])>r?s[t][i]=this.V[t][i]/this.s[i]:s[t][i]=0;var a,l,u=this.U.rows,h=this.U.columns,f=new e(o,u);for(t=0;o>t;t++)for(i=0;u>i;i++){for(l=0,a=0;h>a;a++)l+=s[t][a]*this.U[i][a];f[t][i]=l}return f}},t.exports=o},function(t,i){"use strict";i.hypotenuse=function(t,i){var r;return Math.abs(t)>Math.abs(i)?(r=i/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==i?(r=t/i,Math.abs(i)*Math.sqrt(1+r*r)):0}},function(t,i,r){"use strict";function o(t){if(!(this instanceof o))return new o(t);if(t=u.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");var i,r,l=t.columns,h=u.zeros(l,l),f=new Array(l),c=new Array(l),p=t;if(t.isSymmetric()){for(i=0;l>i;i++)for(r=0;l>r;r++)h[i][r]=p[i][r];e(l,c,f,h),n(l,c,f,h)}else{var m=u.zeros(l,l),g=new Array(l);for(r=0;l>r;r++)for(i=0;l>i;i++)m[i][r]=p[i][r];s(l,m,g,h),a(l,c,f,h,m)}this.n=l,this.e=c,this.d=f,this.V=h}function e(t,i,r,o){var e,n,s,a,l,u,h,f;for(l=0;t>l;l++)r[l]=o[t-1][l];for(a=t-1;a>0;a--){for(f=0,s=0,u=0;a>u;u++)f+=Math.abs(r[u]);if(0===f)for(i[a]=r[a-1],l=0;a>l;l++)r[l]=o[a-1][l],o[a][l]=0,o[l][a]=0;else{for(u=0;a>u;u++)r[u]/=f,s+=r[u]*r[u];for(e=r[a-1],n=Math.sqrt(s),e>0&&(n=-n),i[a]=f*n,s-=e*n,r[a-1]=e-n,l=0;a>l;l++)i[l]=0;for(l=0;a>l;l++){for(e=r[l],o[l][a]=e,n=i[l]+o[l][l]*e,u=l+1;a-1>=u;u++)n+=o[u][l]*r[u],i[u]+=o[u][l]*e;i[l]=n}for(e=0,l=0;a>l;l++)i[l]/=s,e+=i[l]*r[l];for(h=e/(s+s),l=0;a>l;l++)i[l]-=h*r[l];for(l=0;a>l;l++){for(e=r[l],n=i[l],u=l;a-1>=u;u++)o[u][l]-=e*i[u]+n*r[u];r[l]=o[a-1][l],o[a][l]=0}}r[a]=s}for(a=0;t-1>a;a++){if(o[t-1][a]=o[a][a],o[a][a]=1,s=r[a+1],0!==s){for(u=0;a>=u;u++)r[u]=o[u][a+1]/s;for(l=0;a>=l;l++){for(n=0,u=0;a>=u;u++)n+=o[u][a+1]*o[u][l];for(u=0;a>=u;u++)o[u][l]-=n*r[u]}}for(u=0;a>=u;u++)o[u][a+1]=0}for(l=0;t>l;l++)r[l]=o[t-1][l],o[t-1][l]=0;o[t-1][t-1]=1,i[0]=0}function n(t,i,r,o){var e,n,s,a,l,u,f,c,p,m,g,y,v,d,w,b,C;for(s=1;t>s;s++)i[s-1]=i[s];i[t-1]=0;var M=0,x=0,H=Math.pow(2,-52);for(u=0;t>u;u++){for(x=Math.max(x,Math.abs(r[u])+Math.abs(i[u])),f=u;t>f&&!(Math.abs(i[f])<=H*x);)f++;if(f>u){C=0;do{for(C+=1,e=r[u],c=(r[u+1]-e)/(2*i[u]),p=h(c,1),0>c&&(p=-p),r[u]=i[u]/(c+p),r[u+1]=i[u]*(c+p),m=r[u+1],n=e-r[u],s=u+2;t>s;s++)r[s]-=n;for(M+=n,c=r[f],g=1,y=g,v=g,d=i[u+1],w=0,b=0,s=f-1;s>=u;s--)for(v=y,y=g,b=w,e=g*i[s],n=g*c,p=h(c,i[s]),i[s+1]=w*p,w=i[s]/p,g=c/p,c=g*r[s]-w*e,r[s+1]=n+w*(g*e+w*r[s]),l=0;t>l;l++)n=o[l][s+1],o[l][s+1]=w*o[l][s]+g*n,o[l][s]=g*o[l][s]-w*n;c=-w*b*v*d*i[u]/m,i[u]=w*c,r[u]=g*c}while(Math.abs(i[u])>H*x)}r[u]=r[u]+M,i[u]=0}for(s=0;t-1>s;s++){for(l=s,c=r[s],a=s+1;t>a;a++)r[a]<c&&(l=a,c=r[a]);if(l!==s)for(r[l]=r[s],r[s]=c,a=0;t>a;a++)c=o[a][s],o[a][s]=o[a][l],o[a][l]=c}}function s(t,i,r,o){var e,n,s,a,l,u,h,f=0,c=t-1;for(u=f+1;c-1>=u;u++){for(h=0,a=u;c>=a;a++)h+=Math.abs(i[a][u-1]);if(0!==h){for(s=0,a=c;a>=u;a--)r[a]=i[a][u-1]/h,s+=r[a]*r[a];for(n=Math.sqrt(s),r[u]>0&&(n=-n),s-=r[u]*n,r[u]=r[u]-n,l=u;t>l;l++){for(e=0,a=c;a>=u;a--)e+=r[a]*i[a][l];for(e/=s,a=u;c>=a;a++)i[a][l]-=e*r[a]}for(a=0;c>=a;a++){for(e=0,l=c;l>=u;l--)e+=r[l]*i[a][l];for(e/=s,l=u;c>=l;l++)i[a][l]-=e*r[l]}r[u]=h*r[u],i[u][u-1]=h*n}}for(a=0;t>a;a++)for(l=0;t>l;l++)o[a][l]=a===l?1:0;for(u=c-1;u>=f+1;u--)if(0!==i[u][u-1]){for(a=u+1;c>=a;a++)r[a]=i[a][u-1];for(l=u;c>=l;l++){for(n=0,a=u;c>=a;a++)n+=r[a]*o[a][l];for(n=n/r[u]/i[u][u-1],a=u;c>=a;a++)o[a][l]+=n*r[a]}}}function a(t,i,r,o,e){var n,s,a,u,h,f,c,p,m,g,y,v,d,w,b,C=t-1,M=0,x=t-1,H=Math.pow(2,-52),A=0,D=0,S=0,E=0,R=0,X=0,k=0,F=0;for(n=0;t>n;n++)for((M>n||n>x)&&(r[n]=e[n][n],i[n]=0),s=Math.max(n-1,0);t>s;s++)D+=Math.abs(e[n][s]);for(;C>=M;){for(u=C;u>M&&(X=Math.abs(e[u-1][u-1])+Math.abs(e[u][u]),0===X&&(X=D),!(Math.abs(e[u][u-1])<H*X));)u--;if(u===C)e[C][C]=e[C][C]+A,r[C]=e[C][C],i[C]=0,C--,F=0;else if(u===C-1){if(c=e[C][C-1]*e[C-1][C],S=(e[C-1][C-1]-e[C][C])/2,E=S*S+c,k=Math.sqrt(Math.abs(E)),e[C][C]=e[C][C]+A,e[C-1][C-1]=e[C-1][C-1]+A,p=e[C][C],E>=0){for(k=S>=0?S+k:S-k,r[C-1]=p+k,r[C]=r[C-1],0!==k&&(r[C]=p-c/k),i[C-1]=0,i[C]=0,p=e[C][C-1],X=Math.abs(p)+Math.abs(k),S=p/X,E=k/X,R=Math.sqrt(S*S+E*E),S/=R,E/=R,s=C-1;t>s;s++)k=e[C-1][s],e[C-1][s]=E*k+S*e[C][s],e[C][s]=E*e[C][s]-S*k;for(n=0;C>=n;n++)k=e[n][C-1],e[n][C-1]=E*k+S*e[n][C],e[n][C]=E*e[n][C]-S*k;for(n=M;x>=n;n++)k=o[n][C-1],o[n][C-1]=E*k+S*o[n][C],o[n][C]=E*o[n][C]-S*k}else r[C-1]=p+S,r[C]=p+S,i[C-1]=k,i[C]=-k;C-=2,F=0}else{if(p=e[C][C],m=0,c=0,C>u&&(m=e[C-1][C-1],c=e[C][C-1]*e[C-1][C]),10===F){for(A+=p,n=M;C>=n;n++)e[n][n]-=p;X=Math.abs(e[C][C-1])+Math.abs(e[C-1][C-2]),p=m=.75*X,c=-.4375*X*X}if(30===F&&(X=(m-p)/2,X=X*X+c,X>0)){for(X=Math.sqrt(X),p>m&&(X=-X),X=p-c/((m-p)/2+X),n=M;C>=n;n++)e[n][n]-=X;A+=X,p=m=c=.964}for(F+=1,h=C-2;h>=u&&(k=e[h][h],R=p-k,X=m-k,S=(R*X-c)/e[h+1][h]+e[h][h+1],E=e[h+1][h+1]-k-R-X,R=e[h+2][h+1],X=Math.abs(S)+Math.abs(E)+Math.abs(R),S/=X,E/=X,R/=X,h!==u)&&!(Math.abs(e[h][h-1])*(Math.abs(E)+Math.abs(R))<H*(Math.abs(S)*(Math.abs(e[h-1][h-1])+Math.abs(k)+Math.abs(e[h+1][h+1]))));)h--;for(n=h+2;C>=n;n++)e[n][n-2]=0,n>h+2&&(e[n][n-3]=0);for(a=h;C-1>=a&&(w=a!==C-1,a!==h&&(S=e[a][a-1],E=e[a+1][a-1],R=w?e[a+2][a-1]:0,p=Math.abs(S)+Math.abs(E)+Math.abs(R),0!==p&&(S/=p,E/=p,R/=p)),0!==p);a++)if(X=Math.sqrt(S*S+E*E+R*R),0>S&&(X=-X),0!==X){for(a!==h?e[a][a-1]=-X*p:u!==h&&(e[a][a-1]=-e[a][a-1]),S+=X,p=S/X,m=E/X,k=R/X,E/=S,R/=S,s=a;t>s;s++)S=e[a][s]+E*e[a+1][s],w&&(S+=R*e[a+2][s],e[a+2][s]=e[a+2][s]-S*k),e[a][s]=e[a][s]-S*p,e[a+1][s]=e[a+1][s]-S*m;for(n=0;n<=Math.min(C,a+3);n++)S=p*e[n][a]+m*e[n][a+1],w&&(S+=k*e[n][a+2],e[n][a+2]=e[n][a+2]-S*R),e[n][a]=e[n][a]-S,e[n][a+1]=e[n][a+1]-S*E;for(n=M;x>=n;n++)S=p*o[n][a]+m*o[n][a+1],w&&(S+=k*o[n][a+2],o[n][a+2]=o[n][a+2]-S*R),o[n][a]=o[n][a]-S,o[n][a+1]=o[n][a+1]-S*E}}}if(0!==D){for(C=t-1;C>=0;C--)if(S=r[C],E=i[C],0===E)for(u=C,e[C][C]=1,n=C-1;n>=0;n--){for(c=e[n][n]-S,R=0,s=u;C>=s;s++)R+=e[n][s]*e[s][C];if(i[n]<0)k=c,X=R;else if(u=n,0===i[n]?e[n][C]=0!==c?-R/c:-R/(H*D):(p=e[n][n+1],m=e[n+1][n],E=(r[n]-S)*(r[n]-S)+i[n]*i[n],f=(p*X-k*R)/E,e[n][C]=f,e[n+1][C]=Math.abs(p)>Math.abs(k)?(-R-c*f)/p:(-X-m*f)/k),f=Math.abs(e[n][C]),H*f*f>1)for(s=n;C>=s;s++)e[s][C]=e[s][C]/f}else if(0>E)for(u=C-1,Math.abs(e[C][C-1])>Math.abs(e[C-1][C])?(e[C-1][C-1]=E/e[C][C-1],e[C-1][C]=-(e[C][C]-S)/e[C][C-1]):(b=l(0,-e[C-1][C],e[C-1][C-1]-S,E),e[C-1][C-1]=b[0],e[C-1][C]=b[1]),e[C][C-1]=0,e[C][C]=1,n=C-2;n>=0;n--){for(g=0,y=0,s=u;C>=s;s++)g+=e[n][s]*e[s][C-1],y+=e[n][s]*e[s][C];if(c=e[n][n]-S,i[n]<0)k=c,R=g,X=y;else if(u=n,0===i[n]?(b=l(-g,-y,c,E),e[n][C-1]=b[0],e[n][C]=b[1]):(p=e[n][n+1],m=e[n+1][n],v=(r[n]-S)*(r[n]-S)+i[n]*i[n]-E*E,d=2*(r[n]-S)*E,0===v&&0===d&&(v=H*D*(Math.abs(c)+Math.abs(E)+Math.abs(p)+Math.abs(m)+Math.abs(k))),b=l(p*R-k*g+E*y,p*X-k*y-E*g,v,d),e[n][C-1]=b[0],e[n][C]=b[1],Math.abs(p)>Math.abs(k)+Math.abs(E)?(e[n+1][C-1]=(-g-c*e[n][C-1]+E*e[n][C])/p,e[n+1][C]=(-y-c*e[n][C]-E*e[n][C-1])/p):(b=l(-R-m*e[n][C-1],-X-m*e[n][C],k,E),e[n+1][C-1]=b[0],e[n+1][C]=b[1])),f=Math.max(Math.abs(e[n][C-1]),Math.abs(e[n][C])),H*f*f>1)for(s=n;C>=s;s++)e[s][C-1]=e[s][C-1]/f,e[s][C]=e[s][C]/f}for(n=0;t>n;n++)if(M>n||n>x)for(s=n;t>s;s++)o[n][s]=e[n][s];for(s=t-1;s>=M;s--)for(n=M;x>=n;n++){for(k=0,a=M;a<=Math.min(s,x);a++)k+=o[n][a]*e[a][s];o[n][s]=k}}}function l(t,i,r,o){var e,n;return Math.abs(r)>Math.abs(o)?(e=o/r,n=r+e*o,[(t+e*i)/n,(i-e*t)/n]):(e=r/o,n=o+e*r,[(e*t+i)/n,(e*i-t)/n])}var u=r(17),h=r(20).hypotenuse;o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var t,i,r=this.n,o=this.e,e=this.d,n=new u(r,r);for(t=0;r>t;t++){for(i=0;r>i;i++)n[t][i]=0;n[t][t]=e[t],o[t]>0?n[t][t+1]=o[t]:o[t]<0&&(n[t][t-1]=o[t])}return n}},t.exports=o},function(t,i,r){"use strict";function o(t){if(!(this instanceof o))return new o(t);t=e.checkMatrix(t);var i,r,n,s,a,l,u,h,f,c,p=t.clone(),m=p.rows,g=p.columns,y=new Array(m),v=1;for(i=0;m>i;i++)y[i]=i;for(f=new Array(m),r=0;g>r;r++){for(i=0;m>i;i++)f[i]=p[i][r];for(i=0;m>i;i++){for(h=p[i],c=Math.min(i,r),a=0,n=0;c>n;n++)a+=h[n]*f[n];h[r]=f[i]-=a}for(s=r,i=r+1;m>i;i++)Math.abs(f[i])>Math.abs(f[s])&&(s=i);if(s!==r){for(n=0;g>n;n++)l=p[s][n],p[s][n]=p[r][n],p[r][n]=l;u=y[s],y[s]=y[r],y[r]=u,v=-v}if(m>r&&0!==p[r][r])for(i=r+1;m>i;i++)p[i][r]/=p[r][r]}this.LU=p,this.pivotVector=y,this.pivotSign=v}var e=r(17);o.prototype={isSingular:function(){for(var t=this.LU,i=t.columns,r=0;i>r;r++)if(0===t[r][r])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var i=this.pivotSign,r=t.columns,o=0;r>o;o++)i*=t[o][o];return i},get lowerTriangularFactor(){for(var t=this.LU,i=t.rows,r=t.columns,o=new e(i,r),n=0;i>n;n++)for(var s=0;r>s;s++)n>s?o[n][s]=t[n][s]:n===s?o[n][s]=1:o[n][s]=0;return o},get upperTriangularFactor(){for(var t=this.LU,i=t.rows,r=t.columns,o=new e(i,r),n=0;i>n;n++)for(var s=0;r>s;s++)s>=n?o[n][s]=t[n][s]:o[n][s]=0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=e.checkMatrix(t);var i=this.LU,r=i.rows;if(r!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var o,n,s,a=t.columns,l=t.subMatrixRow(this.pivotVector,0,a-1),u=i.columns;for(s=0;u>s;s++)for(o=s+1;u>o;o++)for(n=0;a>n;n++)l[o][n]-=l[s][n]*i[o][s];for(s=u-1;s>=0;s--){for(n=0;a>n;n++)l[s][n]/=i[s][s];for(o=0;s>o;o++)for(n=0;a>n;n++)l[o][n]-=l[s][n]*i[o][s]}return l}},t.exports=o},function(t,i,r){"use strict";function o(t){if(!(this instanceof o))return new o(t);t=e.checkMatrix(t);var i,r,s,a,l=t.clone(),u=t.rows,h=t.columns,f=new Array(h);for(s=0;h>s;s++){var c=0;for(i=s;u>i;i++)c=n(c,l[i][s]);if(0!==c){for(l[s][s]<0&&(c=-c),i=s;u>i;i++)l[i][s]/=c;for(l[s][s]+=1,r=s+1;h>r;r++){for(a=0,i=s;u>i;i++)a+=l[i][s]*l[i][r];for(a=-a/l[s][s],i=s;u>i;i++)l[i][r]+=a*l[i][s]}}f[s]=-c}this.QR=l,this.Rdiag=f}var e=r(17),n=r(20).hypotenuse;o.prototype={solve:function(t){t=e.checkMatrix(t);var i=this.QR,r=i.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,n,s,a,l=t.columns,u=t.clone(),h=i.columns;for(s=0;h>s;s++)for(n=0;l>n;n++){for(a=0,o=s;r>o;o++)a+=i[o][s]*u[o][n];for(a=-a/i[s][s],o=s;r>o;o++)u[o][n]+=a*i[o][s]}for(s=h-1;s>=0;s--){for(n=0;l>n;n++)u[s][n]/=this.Rdiag[s];for(o=0;s>o;o++)for(n=0;l>n;n++)u[o][n]-=u[s][n]*i[o][s]}return u.subMatrix(0,h-1,0,l-1)},isFullRank:function(){for(var t=this.QR.columns,i=0;t>i;i++)if(0===this.Rdiag[i])return!1;return!0},get upperTriangularFactor(){var t,i,r=this.QR,o=r.columns,n=new e(o,o);for(t=0;o>t;t++)for(i=0;o>i;i++)i>t?n[t][i]=r[t][i]:t===i?n[t][i]=this.Rdiag[t]:n[t][i]=0;return n},get orthogonalFactor(){var t,i,r,o,n=this.QR,s=n.rows,a=n.columns,l=new e(s,a);for(r=a-1;r>=0;r--){for(t=0;s>t;t++)l[t][r]=0;for(l[r][r]=1,i=r;a>i;i++)if(0!==n[r][r]){for(o=0,t=r;s>t;t++)o+=n[t][r]*l[t][i];for(o=-o/n[r][r],t=r;s>t;t++)l[t][i]+=o*n[t][r]}}return l}},t.exports=o},function(t,i,r){"use strict";function o(t){if(!(this instanceof o))return new o(t);if(t=e.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");var i,r,n,s=t,a=s.rows,l=new e(a,a),u=!0;for(r=0;a>r;r++){var h=l[r],f=0;for(n=0;r>n;n++){var c=l[n],p=0;for(i=0;n>i;i++)p+=c[i]*h[i];h[n]=p=(s[r][n]-p)/l[n][n],f+=p*p}for(f=s[r][r]-f,u&=f>0,l[r][r]=Math.sqrt(Math.max(f,0)),n=r+1;a>n;n++)l[r][n]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=l}var e=r(17);o.prototype={get leftTriangularFactor(){return this.L},solve:function(t){t=e.checkMatrix(t);var i=this.L,r=i.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");var o,n,s,a=t.columns,l=t.clone();for(s=0;r>s;s++)for(n=0;a>n;n++){for(o=0;s>o;o++)l[s][n]-=l[o][n]*i[s][o];l[s][n]/=i[s][s]}for(s=r-1;s>=0;s--)for(n=0;a>n;n++){for(o=s+1;r>o;o++)l[s][n]-=l[o][n]*i[o][s];l[s][n]/=i[s][s]}return l}},t.exports=o},function(t,i,r){"use strict";function o(t,i){return new x(t,i)}function e(t,i){return x.ones(t,i)}function n(t,i){return x.eye(t,i)}function s(t,i){return x.zeros(t,i)}function a(t,i){return x.rand(t,i)}function l(t){if("number"==typeof t)return t;var i=t.clone();return i.transpose()}function u(t,i){if("number"==typeof t&&"number"==typeof i)return t+i;if("number"==typeof t)return this.add(i,t);var r=t.clone();return r.add(i)}function h(t,i){if("number"==typeof t&&"number"==typeof i)return t-i;if("number"==typeof t)return this.subtract(i,t);var r=t.clone();return r.sub(i)}function f(t,i){if("number"==typeof t&&"number"==typeof i)return t*i;if("number"==typeof t)return this.multiply(i,t);var r=t.clone();return"number"==typeof i?r.mul(i):r=r.mmul(i),1==r.rows&&1==r.columns?r[0][0]:r}function c(t,i){var r=t.clone();return r.mul(i)}function p(t,i){var r=t.clone();return r.div(i)}function m(t){var i,r,o=null,e=t.rows,n=t.columns;if("undefined"==typeof n&&"object"==typeof t)if(t[0]&&t[0].length)for(e=t.length,n=t[0].length,r=Math.min(e,n),o=x.zeros(n,n),i=0;n>i;i++)o[i][i]=t[i][i];else for(n=t.length,o=x.zeros(n,n),i=0;n>i;i++)o[i][i]=t[i];if(1==e)for(o=x.zeros(n,n),i=0;n>i;i++)o[i][i]=t[0][i];else if(e>0&&n>0)for(r=Math.min(e,n),o=new Array(r),i=0;r>i;i++)o[i]=t[i][i];return o}function g(t,i){if("number"==typeof t&&"number"==typeof i)return Math.min(t,i);for(var r=t.rows,o=t.columns,e=new x(r,o),n=0;r>n;n++)for(var s=0;o>s;s++)t[n][s]<i[n][s]?e[n][s]=t[n][s]:e[n][s]=i[n][s];return e}function y(t,i){if("number"==typeof t&&"number"==typeof i)return Math.max(t,i);for(var r=t.rows,o=t.columns,e=new x(r,o),n=0;r>n;n++)for(var s=0;o>s;s++)t[n][s]>i[n][s]?e[n][s]=t[n][s]:e[n][s]=i[n][s];return e}function v(t){if("number"==typeof t)return Math.sqrt(t);for(var i=t.rows,r=t.columns,o=new x(i,r),e=0;i>e;e++)for(var n=0;r>n;n++)o[e][n]=Math.sqrt(t[e][n]);return o}function d(t){if("number"==typeof t)return Math.abs(t);for(var i=t.rows,r=t.columns,o=new x(i,r),e=0;i>e;e++)for(var n=0;r>n;n++)o[e][n]=Math.abs(t[e][n]);return o}function w(t){if("number"==typeof t)return Math.sqrt(t);for(var i=t.rows,r=t.columns,o=new x(i,r),e=0;i>e;e++)for(var n=0;r>n;n++)o[e][n]=Math.exp(t[e][n]);return o}function b(t,i){if("number"==typeof t)return Math.pow(t,i);for(var r=t.rows,o=t.columns,e=new x(r,o),n=0;r>n;n++)for(var s=0;o>s;s++)e[n][s]=Math.pow(t[n][s],i);return e}function C(t,i){return t.solve(i)}function M(t){return"number"==typeof t?1/t:t.inverse()}var x=r(16);t.exports={transpose:l,add:u,subtract:h,multiply:f,dotMultiply:c,dotDivide:p,diag:m,min:g,max:y,solve:C,inv:M,sqrt:v,exp:w,dotPow:b,abs:d,matrix:o,ones:e,zeros:s,random:a,eye:n}},function(t,i,r){"use strict";t.exports=r(27),t.exports.Decompositions=t.exports.DC=r(28)},function(t,i){"use strict";function r(t){for(var i=0,r=t.length,o=new Array(r);r>i;i++)o[i]=t[i];return o}function o(t,i){var e,n,s=0;if(Array.isArray(t)){if(n=i,e=n?r(t):t,t=e.length,i=e[0].length,"undefined"==typeof i)throw new TypeError("Data must be a 2D array");if(!(t>0&&i>0))throw new RangeError("Invalid dimensions: "+t+"x"+i);for(;t>s;s++){if(e[s].length!==i)throw new RangeError("Inconsistent array dimensions");n&&(e[s]=r(e[s]))}}else{if("number"!=typeof t)throw new TypeError("Invalid arguments");if(!(t>0&&i>0))throw new RangeError("Invalid dimensions: "+t+"x"+i);for(e=new Array(t);t>s;s++)e[s]=new Array(i)}return Object.defineProperty(e,"rows",{writable:!0,value:t}),Object.defineProperty(e,"columns",{writable:!0,value:i}),e.__proto__=o.prototype,e}var e=Array.prototype.splice,n=Array.prototype.concat;o.from1DArray=function(t,i,r){var e,n,s=0;if(e=t*i,e!==r.length)throw new RangeError("Data length does not match given dimensions");for(n=new Array(t);t>s;s++)n[s]=r.slice(s*i,(s+1)*i);return new o(n)},o.rowVector=function(t){return new o([t])},o.columnVector=function(t){for(var i=t.length,r=new Array(i),e=0;i>e;e++)r[e]=[t[e]];return new o(r)},o.empty=function(t,i){return new o(t,i)},o.zeros=function(t,i){return o.empty(t,i).fill(0)},o.ones=function(t,i){return o.empty(t,i).fill(1)},o.rand=function(t,i){for(var r=o.empty(t,i),e=0,n=r.rows;n>e;e++)for(var s=0,a=r.columns;a>s;s++)r[e][s]=Math.random();return r},o.eye=function(t){for(var i=o.zeros(t,t),r=i.rows,e=0;r>e;e++)i[e][e]=1;return i},o.diag=function(t){for(var i=t.length,r=o.zeros(i,i),e=0;i>e;e++)r[e][e]=t[e];return r},o.indices=function(t,i){for(var r=new Array(i-t),o=0;o<r.length;o++)r[o]=t++;return r},o.stack=function(t){var i,r,e;if(o.isMatrix(t)){var n=0,s=0;for(i=0;i<arguments.length;i++)n+=arguments[i].rows,arguments[i].columns>s&&(s=arguments[i].columns);var a=o.zeros(n,s),l=0;for(i=0;i<arguments.length;i++){var u=arguments[i];for(r=0;r<u.rows;r++){for(e=0;e<u.columns;e++)a[l][e]=u[r][e];l++}}return a}if(Array.isArray(t)){var h=o.empty(arguments.length,t.length);for(i=0;i<arguments.length;i++)h.setRow(i,arguments[i]);return h}},o.expand=function(t,i){for(var r=[],e=0;e<i.length;e++)for(var n=0;n<i[e];n++)r.push(t[e]);return new o(r)},o.checkMatrix=function(t){if(!t)throw new TypeError("Argument has to be a matrix");return"Matrix"!==t.klass&&(t=new o(t)),
t},o.isMatrix=function(t){return t?"Matrix"===t.klass:!1},Object.defineProperty(o.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(o.prototype,"size",{get:function(){return this.rows*this.columns}}),o.prototype.checkRowIndex=function(t){if(0>t||t>this.rows-1)throw new RangeError("Row index out of range.")},o.prototype.checkColumnIndex=function(t){if(0>t||t>this.columns-1)throw new RangeError("Column index out of range.")},o.prototype.checkDimensions=function(t){if(this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal.")},o.prototype.apply=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)t.call(this,o,e);return this},o.prototype.clone=function(){return new o(this.to2DArray())},o.prototype.to1DArray=function(){return n.apply([],this)},o.prototype.to2DArray=function(){for(var t=this.rows,i=new Array(t),o=0;t>o;o++)i[o]=r(this[o]);return i},o.prototype.isRowVector=function(){return 1===this.rows},o.prototype.isColumnVector=function(){return 1===this.columns},o.prototype.isVector=function(){return 1===this.rows||1===this.columns},o.prototype.isSquare=function(){return this.rows===this.columns},o.prototype.isSymmetric=function(){if(this.isSquare()){for(var t=this.rows,i=0;t>i;i++)for(var r=0;i>=r;r++)if(this[i][r]!==this[r][i])return!1;return!0}return!1},o.prototype.set=function(t,i,r){return this[t][i]=r,this},o.prototype.get=function(t,i){return this[t][i]},o.prototype.fill=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]=t;return this},o.prototype.neg=function(){return this.mulS(-1)},o.prototype.add=function(t){return"number"==typeof t?this.addS(t):(t=o.checkMatrix(t),this.addM(t))},o.prototype.addS=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]+=t;return this},o.prototype.addM=function(t){this.checkDimensions(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]+=t[o][e];return this},o.prototype.sub=function(t){return"number"==typeof t?this.subS(t):(t=o.checkMatrix(t),this.subM(t))},o.prototype.subS=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]-=t;return this},o.prototype.subM=function(t){this.checkDimensions(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]-=t[o][e];return this},o.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):(t=o.checkMatrix(t),this.mulM(t))},o.prototype.mulS=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]*=t;return this},o.prototype.mulM=function(t){this.checkDimensions(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]*=t[o][e];return this},o.prototype.div=function(t){return"number"==typeof t?this.divS(t):(t=o.checkMatrix(t),this.divM(t))},o.prototype.divS=function(t){for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]/=t;return this},o.prototype.divM=function(t){this.checkDimensions(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]/=t[o][e];return this},o.prototype.getRow=function(t){return this.checkRowIndex(t),r(this[t])},o.prototype.getRowVector=function(t){return o.rowVector(this.getRow(t))},o.prototype.setRow=function(t,i){if(this.checkRowIndex(t),o.isMatrix(i)&&(i=i.to1DArray()),i.length!==this.columns)throw new RangeError("Invalid row size");return this[t]=r(i),this},o.prototype.removeRow=function(t){if(this.checkRowIndex(t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,t,1),this.rows-=1,this},o.prototype.addRow=function(t,i){if("undefined"==typeof i&&(i=t,t=this.rows),0>t||t>this.rows)throw new RangeError("Row index out of range.");if(o.isMatrix(i)&&(i=i.to1DArray()),i.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,t,0,r(i)),this.rows+=1,this},o.prototype.swapRows=function(t,i){this.checkRowIndex(t),this.checkRowIndex(i);var r=this[t];return this[t]=this[i],this[i]=r,this},o.prototype.getColumn=function(t){this.checkColumnIndex(t);for(var i=this.rows,r=new Array(i),o=0;i>o;o++)r[o]=this[o][t];return r},o.prototype.getColumnVector=function(t){return o.columnVector(this.getColumn(t))},o.prototype.setColumn=function(t,i){this.checkColumnIndex(t),o.isMatrix(i)&&(i=i.to1DArray());var r=this.rows;if(i.length!==r)throw new RangeError("Invalid column size");for(var e=0;r>e;e++)this[e][t]=i[e];return this},o.prototype.removeColumn=function(t){if(this.checkColumnIndex(t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var i=0,r=this.rows;r>i;i++)this[i].splice(t,1);return this.columns-=1,this},o.prototype.addColumn=function(t,i){if("undefined"==typeof i&&(i=t,t=this.columns),0>t||t>this.columns)throw new RangeError("Column index out of range.");o.isMatrix(i)&&(i=i.to1DArray());var r=this.rows;if(i.length!==r)throw new RangeError("Invalid column size");for(var e=0;r>e;e++)this[e].splice(t,0,i[e]);return this.columns+=1,this},o.prototype.swapColumns=function(t,i){this.checkRowIndex(t),this.checkRowIndex(i);for(var r,o,e=this.rows,n=0;e>n;n++)o=this[n],r=o[t],o[t]=o[i],o[i]=r;return this},o.prototype.checkRowVector=function(t){if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return t},o.prototype.checkColumnVector=function(t){if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return t},o.prototype.addRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]+=t[e];return this},o.prototype.subRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]-=t[e];return this},o.prototype.mulRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]*=t[e];return this},o.prototype.divRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]/=t[e];return this},o.prototype.addColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]+=t[o];return this},o.prototype.subColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]-=t[o];return this},o.prototype.mulColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]*=t[o];return this},o.prototype.divColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]/=t[o];return this},o.prototype.mulRow=function(t,i){this.checkRowIndex(t);for(var r=0,o=this.columns;o>r;r++)this[t][r]*=i;return this},o.prototype.mulColumn=function(t,i){this.checkColumnIndex(t);for(var r=0,o=this.rows;o>r;r++)this[r][t]*=i},o.prototype.max=function(){for(var t=-(1/0),i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]>t&&(t=this[o][e]);return t},o.prototype.maxIndex=function(){for(var t=-(1/0),i={},r=this.rows,o=this.columns,e=0;r>e;e++)for(var n=0;o>n;n++)this[e][n]>t&&(t=this[e][n],i.row=e,i.column=n);return i},o.prototype.min=function(){for(var t=1/0,i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)this[o][e]<t&&(t=this[o][e]);return t},o.prototype.minIndex=function(){for(var t=1/0,i={},r=this.rows,o=this.columns,e=0;r>e;e++)for(var n=0;o>n;n++)this[e][n]<t&&(t=this[e][n],i.row=e,i.column=n);return i},o.prototype.maxRow=function(t){this.checkRowIndex(t);for(var i=-(1/0),r=0,o=this.columns;o>r;r++)this[t][r]>i&&(i=this[t][r]);return i},o.prototype.maxRowIndex=function(t){this.checkRowIndex(t);for(var i=-(1/0),r={row:t},o=0,e=this.columns;e>o;o++)this[t][o]>i&&(i=this[t][o],r.column=o);return r},o.prototype.minRow=function(t){this.checkRowIndex(t);for(var i=1/0,r=0,o=this.columns;o>r;r++)this[t][r]<i&&(i=this[t][r]);return i},o.prototype.minRowIndex=function(t){this.checkRowIndex(t);for(var i=1/0,r={row:t,column:0},o=0,e=this.columns;e>o;o++)this[t][o]<i&&(i=this[t][o],r.column=o);return r},o.prototype.maxColumn=function(t){this.checkColumnIndex(t);for(var i=-(1/0),r=0,o=this.rows;o>r;r++)this[r][t]>i&&(i=this[r][t]);return i},o.prototype.maxColumnIndex=function(t){this.checkColumnIndex(t);for(var i=-(1/0),r={row:0,column:t},o=0,e=this.rows;e>o;o++)this[o][t]>i&&(i=this[o][t],r.row=o);return r},o.prototype.minColumn=function(t){this.checkColumnIndex(t);for(var i=1/0,r=0,o=this.rows;o>r;r++)this[r][t]<i&&(i=this[r][t]);return i},o.prototype.minColumnIndex=function(t){this.checkColumnIndex(t);for(var i=1/0,r={row:0,column:t},o=0,e=this.rows;e>o;o++)this[o][t]<i&&(i=this[o][t],r.row=o);return r},o.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),t=0,i=this.rows;i>t;t++)s[t]=this[t][t];return s},o.prototype.sum=function(){for(var t=0,i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)t+=this[o][e];return t},o.prototype.mean=function(){return this.sum()/this.size},o.prototype.prod=function a(){for(var a=1,t=this.rows,i=this.columns,r=0;t>r;r++)for(var o=0;i>o;o++)a*=this[r][o];return a},o.prototype.cumulativeSum=function(){for(var t=0,i=this.rows,r=this.columns,o=0;i>o;o++)for(var e=0;r>e;e++)t+=this[o][e],this[o][e]=t;return this},o.prototype.dot=function l(t){if(this.size!==t.size)throw new RangeError("vectors do not have the same size");for(var i=this.to1DArray(),r=t.to1DArray(),l=0,o=i.length,e=0;o>e;e++)l+=i[e]*r[e];return l},o.prototype.mmul=function(t){if(!o.isMatrix(t))throw new TypeError('parameter "other" must be a matrix');this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var i,r,e,n=this.rows,s=this.columns,a=t.columns,l=new o(n,a),u=new Array(s);for(r=0;a>r;r++){for(e=0;s>e;e++)u[e]=t[e][r];for(i=0;n>i;i++){var h=this[i],f=0;for(e=0;s>e;e++)f+=h[e]*u[e];l[i][r]=f}}return l},o.prototype.sortRows=function(t){for(var i=0,r=this.rows;r>i;i++)this[i].sort(t);return this},o.prototype.sortColumns=function(t){for(var i=0,r=this.columns;r>i;i++)this.setColumn(i,this.getColumn(i).sort(t));return this},o.prototype.transpose=function(){for(var t=new o(this.columns,this.rows),i=this.rows,r=this.columns,e=0;i>e;e++)for(var n=0;r>n;n++)t[n][e]=this[e][n];return t},o.prototype.subMatrix=function(t,i,r,e){if(t>i||r>e||0>t||t>=this.rows||0>i||i>=this.rows||0>r||r>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range");for(var n=new o(i-t+1,e-r+1),s=t;i>=s;s++)for(var a=r;e>=a;a++)n[s-t][a-r]=this[s][a];return n},o.prototype.subMatrixRow=function(t,i,r){if("undefined"==typeof i?(i=0,r=this.columns-1):"undefined"==typeof r&&(r=this.columns-1),i>r||0>i||i>=this.columns||0>r||r>=this.columns)throw new RangeError("Argument out of range.");for(var e=t.length,n=this.rows,s=new o(e,r-i+1),a=0;e>a;a++)for(var l=i;r>=l;l++){if(t[a]<0||t[a]>=n)throw new RangeError("Argument out of range.");s[a][l-i]=this[t[a]][l]}return s},o.prototype.subMatrixColumn=function(t,i,r){if("undefined"==typeof i?(i=0,r=this.rows-1):"undefined"==typeof r&&(r=this.rows-1),i>r||0>i||i>=this.rows||0>r||r>=this.rows)throw new RangeError("Argument out of range.");for(var e=t.length,n=this.columns,s=new o(r-i+1,e),a=0;e>a;a++)for(var l=i;r>=l;l++){if(t[a]<0||t[a]>=n)throw new RangeError("Argument out of range.");s[l-i][a]=this[l][t[a]]}return s},o.prototype.trace=function u(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var u=0,t=0,i=this.rows;i>t;t++)u+=this[t][t];return u},o.prototype.abs=function(){for(var t=this.rows,i=this.columns,r=0;t>r;r++)for(var o=0;i>o;o++)this[r][o]=Math.abs(this[r][o])},t.exports=o},function(t,i,r){"use strict";function o(t){return e(t,n.eye(t.rows))}function e(t,i){return t.isSquare()?new l(t).solve(i):new u(t).solve(i)}var n=r(27),s=r(29),a=r(31),l=r(32),u=r(33),h=r(34);n.prototype.inverse=function(){return o(this)},n.prototype.solve=function(t){return e(this,t)},t.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:u,QR:u,CholeskyDecomposition:h,CHO:h,inverse:o,solve:e}},function(t,i,r){"use strict";function o(t,i){if(!(this instanceof o))return new o(t,i);t=e.checkMatrix(t),i=i||{};var r=t.clone(),s=t.rows,a=t.columns,l=Math.min(s,a),u=!0,h=!0;i.computeLeftSingularVectors===!1&&(u=!1),i.computeRightSingularVectors===!1&&(h=!1);var f=i.autoTranspose===!0,c=!1;if(a>s)if(f){r=r.transpose(),s=r.rows,a=r.columns,c=!0;var p=u;u=h,h=p}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var m,g,y,v,d,w,b,C,M,x,H,A,D,S,E,R,X,k,F,P,N,O=new Array(Math.min(s+1,a)),Y=e.zeros(s,l),T=e.zeros(a,a),_=new Array(a),I=new Array(s),V=Math.min(s-1,a),z=Math.max(0,Math.min(a-2,s));for(y=0,x=Math.max(V,z);x>y;y++){if(V>y){for(O[y]=0,m=y;s>m;m++)O[y]=n(O[y],r[m][y]);if(0!==O[y]){for(r[y][y]<0&&(O[y]=-O[y]),m=y;s>m;m++)r[m][y]/=O[y];r[y][y]+=1}O[y]=-O[y]}for(g=y+1;a>g;g++){if(V>y&&0!==O[y]){for(d=0,m=y;s>m;m++)d+=r[m][y]*r[m][g];for(d=-d/r[y][y],m=y;s>m;m++)r[m][g]+=d*r[m][y]}_[g]=r[y][g]}if(u&&V>y)for(m=y;s>m;m++)Y[m][y]=r[m][y];if(z>y){for(_[y]=0,m=y+1;a>m;m++)_[y]=n(_[y],_[m]);if(0!==_[y]){for(_[y+1]<0&&(_[y]=-_[y]),m=y+1;a>m;m++)_[m]/=_[y];_[y+1]+=1}if(_[y]=-_[y],s>y+1&&0!==_[y]){for(m=y+1;s>m;m++)I[m]=0;for(g=y+1;a>g;g++)for(m=y+1;s>m;m++)I[m]+=_[g]*r[m][g];for(g=y+1;a>g;g++)for(d=-_[g]/_[y+1],m=y+1;s>m;m++)r[m][g]+=d*I[m]}if(h)for(m=y+1;a>m;m++)T[m][y]=_[m]}}if(v=Math.min(a,s+1),a>V&&(O[V]=r[V][V]),v>s&&(O[v-1]=0),v>z+1&&(_[z]=r[z][v-1]),_[v-1]=0,u){for(g=V;l>g;g++){for(m=0;s>m;m++)Y[m][g]=0;Y[g][g]=1}for(y=V-1;y>=0;y--)if(0!==O[y]){for(g=y+1;l>g;g++){for(d=0,m=y;s>m;m++)d+=Y[m][y]*Y[m][g];for(d=-d/Y[y][y],m=y;s>m;m++)Y[m][g]+=d*Y[m][y]}for(m=y;s>m;m++)Y[m][y]=-Y[m][y];for(Y[y][y]=1+Y[y][y],m=0;y-1>m;m++)Y[m][y]=0}else{for(m=0;s>m;m++)Y[m][y]=0;Y[y][y]=1}}if(h)for(y=a-1;y>=0;y--){if(z>y&&0!==_[y])for(g=y+1;a>g;g++){for(d=0,m=y+1;a>m;m++)d+=T[m][y]*T[m][g];for(d=-d/T[y+1][y],m=y+1;a>m;m++)T[m][g]+=d*T[m][y]}for(m=0;a>m;m++)T[m][y]=0;T[y][y]=1}for(var U=v-1,L=0,q=Math.pow(2,-52);v>0;){for(y=v-2;y>=-1&&-1!==y;y--)if(Math.abs(_[y])<=q*(Math.abs(O[y])+Math.abs(O[y+1]))){_[y]=0;break}if(y===v-2)H=4;else{for(w=v-1;w>=y&&w!==y;w--)if(d=(w!==v?Math.abs(_[w]):0)+(w!==y+1?Math.abs(_[w-1]):0),Math.abs(O[w])<=q*d){O[w]=0;break}w===y?H=3:w===v-1?H=1:(H=2,y=w)}switch(y++,H){case 1:for(b=_[v-2],_[v-2]=0,g=v-2;g>=y;g--)if(d=n(O[g],b),C=O[g]/d,M=b/d,O[g]=d,g!==y&&(b=-M*_[g-1],_[g-1]=C*_[g-1]),h)for(m=0;a>m;m++)d=C*T[m][g]+M*T[m][v-1],T[m][v-1]=-M*T[m][g]+C*T[m][v-1],T[m][g]=d;break;case 2:for(b=_[y-1],_[y-1]=0,g=y;v>g;g++)if(d=n(O[g],b),C=O[g]/d,M=b/d,O[g]=d,b=-M*_[g],_[g]=C*_[g],u)for(m=0;s>m;m++)d=C*Y[m][g]+M*Y[m][y-1],Y[m][y-1]=-M*Y[m][g]+C*Y[m][y-1],Y[m][g]=d;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(O[v-1]),Math.abs(O[v-2])),Math.abs(_[v-2])),Math.abs(O[y])),Math.abs(_[y])),D=O[v-1]/A,S=O[v-2]/A,E=_[v-2]/A,R=O[y]/A,X=_[y]/A,k=((S+D)*(S-D)+E*E)/2,F=D*E*(D*E),P=0,(0!==k||0!==F)&&(P=Math.sqrt(k*k+F),0>k&&(P=-P),P=F/(k+P)),b=(R+D)*(R-D)+P,N=R*X,g=y;v-1>g;g++){if(d=n(b,N),C=b/d,M=N/d,g!==y&&(_[g-1]=d),b=C*O[g]+M*_[g],_[g]=C*_[g]-M*O[g],N=M*O[g+1],O[g+1]=C*O[g+1],h)for(m=0;a>m;m++)d=C*T[m][g]+M*T[m][g+1],T[m][g+1]=-M*T[m][g]+C*T[m][g+1],T[m][g]=d;if(d=n(b,N),C=b/d,M=N/d,O[g]=d,b=C*_[g]+M*O[g+1],O[g+1]=-M*_[g]+C*O[g+1],N=M*_[g+1],_[g+1]=C*_[g+1],u&&s-1>g)for(m=0;s>m;m++)d=C*Y[m][g]+M*Y[m][g+1],Y[m][g+1]=-M*Y[m][g]+C*Y[m][g+1],Y[m][g]=d}_[v-2]=b,L+=1;break;case 4:if(O[y]<=0&&(O[y]=O[y]<0?-O[y]:0,h))for(m=0;U>=m;m++)T[m][y]=-T[m][y];for(;U>y&&!(O[y]>=O[y+1]);){if(d=O[y],O[y]=O[y+1],O[y+1]=d,h&&a-1>y)for(m=0;a>m;m++)d=T[m][y+1],T[m][y+1]=T[m][y],T[m][y]=d;if(u&&s-1>y)for(m=0;s>m;m++)d=Y[m][y+1],Y[m][y+1]=Y[m][y],Y[m][y]=d;y++}L=0,v--}}if(c){var j=T;T=Y,Y=j}this.m=s,this.n=a,this.s=O,this.U=Y,this.V=T}var e=r(27),n=r(30).hypotenuse;o.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),i=Math.max(this.m,this.n)*this.s[0]*t,r=0,o=this.s,e=0,n=o.length;n>e;e++)o[e]>i&&r++;return r},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(t){var i,r=t,o=this.threshold,n=this.s.length,s=e.zeros(n,n);for(i=0;n>i;i++)Math.abs(this.s[i])<=o?s[i][i]=0:s[i][i]=1/this.s[i];var a,l,u,h=this.V.mmul(s),f=this.V.rows,c=this.U.rows,p=e.zeros(f,c);for(i=0;f>i;i++)for(a=0;c>a;a++){for(u=0,l=0;n>l;l++)u+=h[i][l]*this.U[a][l];p[i][a]=u}return p.mmul(r)},solveForDiagonal:function(t){return this.solve(e.diag(t))},inverse:function(){var t,i,r=this.threshold,o=this.V.rows,n=this.V.columns,s=new e(o,this.s.length);for(t=0;o>t;t++)for(i=0;n>i;i++)Math.abs(this.s[i])>r?s[t][i]=this.V[t][i]/this.s[i]:s[t][i]=0;var a,l,u=this.U.rows,h=this.U.columns,f=new e(o,u);for(t=0;o>t;t++)for(i=0;u>i;i++){for(l=0,a=0;h>a;a++)l+=s[t][a]*this.U[i][a];f[t][i]=l}return f}},t.exports=o},function(t,i){"use strict";i.hypotenuse=function(t,i){var r;return Math.abs(t)>Math.abs(i)?(r=i/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==i?(r=t/i,Math.abs(i)*Math.sqrt(1+r*r)):0}},function(t,i,r){"use strict";function o(t){if(!(this instanceof o))return new o(t);if(t=u.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");var i,r,l=t.columns,h=u.zeros(l,l),f=new Array(l),c=new Array(l),p=t;if(t.isSymmetric()){for(i=0;l>i;i++)for(r=0;l>r;r++)h[i][r]=p[i][r];e(l,c,f,h),n(l,c,f,h)}else{var m=u.zeros(l,l),g=new Array(l);for(r=0;l>r;r++)for(i=0;l>i;i++)m[i][r]=p[i][r];s(l,m,g,h),a(l,c,f,h,m)}this.n=l,this.e=c,this.d=f,this.V=h}function e(t,i,r,o){var e,n,s,a,l,u,h,f;for(l=0;t>l;l++)r[l]=o[t-1][l];for(a=t-1;a>0;a--){for(f=0,s=0,u=0;a>u;u++)f+=Math.abs(r[u]);if(0===f)for(i[a]=r[a-1],l=0;a>l;l++)r[l]=o[a-1][l],o[a][l]=0,o[l][a]=0;else{for(u=0;a>u;u++)r[u]/=f,s+=r[u]*r[u];for(e=r[a-1],n=Math.sqrt(s),e>0&&(n=-n),i[a]=f*n,s-=e*n,r[a-1]=e-n,l=0;a>l;l++)i[l]=0;for(l=0;a>l;l++){for(e=r[l],o[l][a]=e,n=i[l]+o[l][l]*e,u=l+1;a-1>=u;u++)n+=o[u][l]*r[u],i[u]+=o[u][l]*e;i[l]=n}for(e=0,l=0;a>l;l++)i[l]/=s,e+=i[l]*r[l];for(h=e/(s+s),l=0;a>l;l++)i[l]-=h*r[l];for(l=0;a>l;l++){for(e=r[l],n=i[l],u=l;a-1>=u;u++)o[u][l]-=e*i[u]+n*r[u];r[l]=o[a-1][l],o[a][l]=0}}r[a]=s}for(a=0;t-1>a;a++){if(o[t-1][a]=o[a][a],o[a][a]=1,s=r[a+1],0!==s){for(u=0;a>=u;u++)r[u]=o[u][a+1]/s;for(l=0;a>=l;l++){for(n=0,u=0;a>=u;u++)n+=o[u][a+1]*o[u][l];for(u=0;a>=u;u++)o[u][l]-=n*r[u]}}for(u=0;a>=u;u++)o[u][a+1]=0}for(l=0;t>l;l++)r[l]=o[t-1][l],o[t-1][l]=0;o[t-1][t-1]=1,i[0]=0}function n(t,i,r,o){var e,n,s,a,l,u,f,c,p,m,g,y,v,d,w,b,C;for(s=1;t>s;s++)i[s-1]=i[s];i[t-1]=0;var M=0,x=0,H=Math.pow(2,-52);for(u=0;t>u;u++){for(x=Math.max(x,Math.abs(r[u])+Math.abs(i[u])),f=u;t>f&&!(Math.abs(i[f])<=H*x);)f++;if(f>u){C=0;do{for(C+=1,e=r[u],c=(r[u+1]-e)/(2*i[u]),p=h(c,1),0>c&&(p=-p),r[u]=i[u]/(c+p),r[u+1]=i[u]*(c+p),m=r[u+1],n=e-r[u],s=u+2;t>s;s++)r[s]-=n;for(M+=n,c=r[f],g=1,y=g,v=g,d=i[u+1],w=0,b=0,s=f-1;s>=u;s--)for(v=y,y=g,b=w,e=g*i[s],n=g*c,p=h(c,i[s]),i[s+1]=w*p,w=i[s]/p,g=c/p,c=g*r[s]-w*e,r[s+1]=n+w*(g*e+w*r[s]),l=0;t>l;l++)n=o[l][s+1],o[l][s+1]=w*o[l][s]+g*n,o[l][s]=g*o[l][s]-w*n;c=-w*b*v*d*i[u]/m,i[u]=w*c,r[u]=g*c}while(Math.abs(i[u])>H*x)}r[u]=r[u]+M,i[u]=0}for(s=0;t-1>s;s++){for(l=s,c=r[s],a=s+1;t>a;a++)r[a]<c&&(l=a,c=r[a]);if(l!==s)for(r[l]=r[s],r[s]=c,a=0;t>a;a++)c=o[a][s],o[a][s]=o[a][l],o[a][l]=c}}function s(t,i,r,o){var e,n,s,a,l,u,h,f=0,c=t-1;for(u=f+1;c-1>=u;u++){for(h=0,a=u;c>=a;a++)h+=Math.abs(i[a][u-1]);if(0!==h){for(s=0,a=c;a>=u;a--)r[a]=i[a][u-1]/h,s+=r[a]*r[a];for(n=Math.sqrt(s),r[u]>0&&(n=-n),s-=r[u]*n,r[u]=r[u]-n,l=u;t>l;l++){for(e=0,a=c;a>=u;a--)e+=r[a]*i[a][l];for(e/=s,a=u;c>=a;a++)i[a][l]-=e*r[a]}for(a=0;c>=a;a++){for(e=0,l=c;l>=u;l--)e+=r[l]*i[a][l];for(e/=s,l=u;c>=l;l++)i[a][l]-=e*r[l]}r[u]=h*r[u],i[u][u-1]=h*n}}for(a=0;t>a;a++)for(l=0;t>l;l++)o[a][l]=a===l?1:0;for(u=c-1;u>=f+1;u--)if(0!==i[u][u-1]){for(a=u+1;c>=a;a++)r[a]=i[a][u-1];for(l=u;c>=l;l++){for(n=0,a=u;c>=a;a++)n+=r[a]*o[a][l];for(n=n/r[u]/i[u][u-1],a=u;c>=a;a++)o[a][l]+=n*r[a]}}}function a(t,i,r,o,e){var n,s,a,u,h,f,c,p,m,g,y,v,d,w,b,C=t-1,M=0,x=t-1,H=Math.pow(2,-52),A=0,D=0,S=0,E=0,R=0,X=0,k=0,F=0;for(n=0;t>n;n++)for((M>n||n>x)&&(r[n]=e[n][n],i[n]=0),s=Math.max(n-1,0);t>s;s++)D+=Math.abs(e[n][s]);for(;C>=M;){for(u=C;u>M&&(X=Math.abs(e[u-1][u-1])+Math.abs(e[u][u]),0===X&&(X=D),!(Math.abs(e[u][u-1])<H*X));)u--;if(u===C)e[C][C]=e[C][C]+A,r[C]=e[C][C],i[C]=0,C--,F=0;else if(u===C-1){if(c=e[C][C-1]*e[C-1][C],S=(e[C-1][C-1]-e[C][C])/2,E=S*S+c,k=Math.sqrt(Math.abs(E)),e[C][C]=e[C][C]+A,e[C-1][C-1]=e[C-1][C-1]+A,p=e[C][C],E>=0){for(k=S>=0?S+k:S-k,r[C-1]=p+k,r[C]=r[C-1],0!==k&&(r[C]=p-c/k),i[C-1]=0,i[C]=0,p=e[C][C-1],X=Math.abs(p)+Math.abs(k),S=p/X,E=k/X,R=Math.sqrt(S*S+E*E),S/=R,E/=R,s=C-1;t>s;s++)k=e[C-1][s],e[C-1][s]=E*k+S*e[C][s],e[C][s]=E*e[C][s]-S*k;for(n=0;C>=n;n++)k=e[n][C-1],e[n][C-1]=E*k+S*e[n][C],e[n][C]=E*e[n][C]-S*k;for(n=M;x>=n;n++)k=o[n][C-1],o[n][C-1]=E*k+S*o[n][C],o[n][C]=E*o[n][C]-S*k}else r[C-1]=p+S,r[C]=p+S,i[C-1]=k,i[C]=-k;C-=2,F=0}else{if(p=e[C][C],m=0,c=0,C>u&&(m=e[C-1][C-1],c=e[C][C-1]*e[C-1][C]),10===F){for(A+=p,n=M;C>=n;n++)e[n][n]-=p;X=Math.abs(e[C][C-1])+Math.abs(e[C-1][C-2]),p=m=.75*X,c=-.4375*X*X}if(30===F&&(X=(m-p)/2,X=X*X+c,X>0)){for(X=Math.sqrt(X),p>m&&(X=-X),X=p-c/((m-p)/2+X),n=M;C>=n;n++)e[n][n]-=X;A+=X,p=m=c=.964}for(F+=1,h=C-2;h>=u&&(k=e[h][h],R=p-k,X=m-k,S=(R*X-c)/e[h+1][h]+e[h][h+1],E=e[h+1][h+1]-k-R-X,R=e[h+2][h+1],X=Math.abs(S)+Math.abs(E)+Math.abs(R),S/=X,E/=X,R/=X,h!==u)&&!(Math.abs(e[h][h-1])*(Math.abs(E)+Math.abs(R))<H*(Math.abs(S)*(Math.abs(e[h-1][h-1])+Math.abs(k)+Math.abs(e[h+1][h+1]))));)h--;for(n=h+2;C>=n;n++)e[n][n-2]=0,n>h+2&&(e[n][n-3]=0);for(a=h;C-1>=a&&(w=a!==C-1,a!==h&&(S=e[a][a-1],E=e[a+1][a-1],R=w?e[a+2][a-1]:0,p=Math.abs(S)+Math.abs(E)+Math.abs(R),0!==p&&(S/=p,E/=p,R/=p)),0!==p);a++)if(X=Math.sqrt(S*S+E*E+R*R),0>S&&(X=-X),0!==X){for(a!==h?e[a][a-1]=-X*p:u!==h&&(e[a][a-1]=-e[a][a-1]),S+=X,p=S/X,m=E/X,k=R/X,E/=S,R/=S,s=a;t>s;s++)S=e[a][s]+E*e[a+1][s],w&&(S+=R*e[a+2][s],e[a+2][s]=e[a+2][s]-S*k),e[a][s]=e[a][s]-S*p,e[a+1][s]=e[a+1][s]-S*m;for(n=0;n<=Math.min(C,a+3);n++)S=p*e[n][a]+m*e[n][a+1],w&&(S+=k*e[n][a+2],e[n][a+2]=e[n][a+2]-S*R),e[n][a]=e[n][a]-S,e[n][a+1]=e[n][a+1]-S*E;for(n=M;x>=n;n++)S=p*o[n][a]+m*o[n][a+1],w&&(S+=k*o[n][a+2],o[n][a+2]=o[n][a+2]-S*R),o[n][a]=o[n][a]-S,o[n][a+1]=o[n][a+1]-S*E}}}if(0!==D){for(C=t-1;C>=0;C--)if(S=r[C],E=i[C],0===E)for(u=C,e[C][C]=1,n=C-1;n>=0;n--){for(c=e[n][n]-S,R=0,s=u;C>=s;s++)R+=e[n][s]*e[s][C];if(i[n]<0)k=c,X=R;else if(u=n,0===i[n]?e[n][C]=0!==c?-R/c:-R/(H*D):(p=e[n][n+1],m=e[n+1][n],E=(r[n]-S)*(r[n]-S)+i[n]*i[n],f=(p*X-k*R)/E,e[n][C]=f,e[n+1][C]=Math.abs(p)>Math.abs(k)?(-R-c*f)/p:(-X-m*f)/k),f=Math.abs(e[n][C]),H*f*f>1)for(s=n;C>=s;s++)e[s][C]=e[s][C]/f}else if(0>E)for(u=C-1,Math.abs(e[C][C-1])>Math.abs(e[C-1][C])?(e[C-1][C-1]=E/e[C][C-1],e[C-1][C]=-(e[C][C]-S)/e[C][C-1]):(b=l(0,-e[C-1][C],e[C-1][C-1]-S,E),e[C-1][C-1]=b[0],e[C-1][C]=b[1]),e[C][C-1]=0,e[C][C]=1,n=C-2;n>=0;n--){for(g=0,y=0,s=u;C>=s;s++)g+=e[n][s]*e[s][C-1],y+=e[n][s]*e[s][C];if(c=e[n][n]-S,i[n]<0)k=c,R=g,X=y;else if(u=n,0===i[n]?(b=l(-g,-y,c,E),e[n][C-1]=b[0],e[n][C]=b[1]):(p=e[n][n+1],m=e[n+1][n],v=(r[n]-S)*(r[n]-S)+i[n]*i[n]-E*E,d=2*(r[n]-S)*E,0===v&&0===d&&(v=H*D*(Math.abs(c)+Math.abs(E)+Math.abs(p)+Math.abs(m)+Math.abs(k))),b=l(p*R-k*g+E*y,p*X-k*y-E*g,v,d),e[n][C-1]=b[0],e[n][C]=b[1],Math.abs(p)>Math.abs(k)+Math.abs(E)?(e[n+1][C-1]=(-g-c*e[n][C-1]+E*e[n][C])/p,e[n+1][C]=(-y-c*e[n][C]-E*e[n][C-1])/p):(b=l(-R-m*e[n][C-1],-X-m*e[n][C],k,E),e[n+1][C-1]=b[0],e[n+1][C]=b[1])),f=Math.max(Math.abs(e[n][C-1]),Math.abs(e[n][C])),H*f*f>1)for(s=n;C>=s;s++)e[s][C-1]=e[s][C-1]/f,e[s][C]=e[s][C]/f}for(n=0;t>n;n++)if(M>n||n>x)for(s=n;t>s;s++)o[n][s]=e[n][s];for(s=t-1;s>=M;s--)for(n=M;x>=n;n++){for(k=0,a=M;a<=Math.min(s,x);a++)k+=o[n][a]*e[a][s];o[n][s]=k}}}function l(t,i,r,o){var e,n;return Math.abs(r)>Math.abs(o)?(e=o/r,n=r+e*o,[(t+e*i)/n,(i-e*t)/n]):(e=r/o,n=o+e*r,[(e*t+i)/n,(e*i-t)/n])}var u=r(27),h=r(30).hypotenuse;o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var t,i,r=this.n,o=this.e,e=this.d,n=new u(r,r);for(t=0;r>t;t++){for(i=0;r>i;i++)n[t][i]=0;n[t][t]=e[t],o[t]>0?n[t][t+1]=o[t]:o[t]<0&&(n[t][t-1]=o[t])}return n}},t.exports=o},function(t,i,r){"use strict";function o(t){if(!(this instanceof o))return new o(t);t=e.checkMatrix(t);var i,r,n,s,a,l,u,h,f,c,p=t.clone(),m=p.rows,g=p.columns,y=new Array(m),v=1;for(i=0;m>i;i++)y[i]=i;for(f=new Array(m),r=0;g>r;r++){for(i=0;m>i;i++)f[i]=p[i][r];for(i=0;m>i;i++){for(h=p[i],c=Math.min(i,r),a=0,n=0;c>n;n++)a+=h[n]*f[n];h[r]=f[i]-=a}for(s=r,i=r+1;m>i;i++)Math.abs(f[i])>Math.abs(f[s])&&(s=i);if(s!==r){for(n=0;g>n;n++)l=p[s][n],p[s][n]=p[r][n],p[r][n]=l;u=y[s],y[s]=y[r],y[r]=u,v=-v}if(m>r&&0!==p[r][r])for(i=r+1;m>i;i++)p[i][r]/=p[r][r]}this.LU=p,this.pivotVector=y,this.pivotSign=v}var e=r(27);o.prototype={isSingular:function(){for(var t=this.LU,i=t.columns,r=0;i>r;r++)if(0===t[r][r])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var i=this.pivotSign,r=t.columns,o=0;r>o;o++)i*=t[o][o];return i},get lowerTriangularFactor(){for(var t=this.LU,i=t.rows,r=t.columns,o=new e(i,r),n=0;i>n;n++)for(var s=0;r>s;s++)n>s?o[n][s]=t[n][s]:n===s?o[n][s]=1:o[n][s]=0;return o},get upperTriangularFactor(){for(var t=this.LU,i=t.rows,r=t.columns,o=new e(i,r),n=0;i>n;n++)for(var s=0;r>s;s++)s>=n?o[n][s]=t[n][s]:o[n][s]=0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=e.checkMatrix(t);var i=this.LU,r=i.rows;if(r!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var o,n,s,a=t.columns,l=t.subMatrixRow(this.pivotVector,0,a-1),u=i.columns;for(s=0;u>s;s++)for(o=s+1;u>o;o++)for(n=0;a>n;n++)l[o][n]-=l[s][n]*i[o][s];for(s=u-1;s>=0;s--){for(n=0;a>n;n++)l[s][n]/=i[s][s];for(o=0;s>o;o++)for(n=0;a>n;n++)l[o][n]-=l[s][n]*i[o][s]}return l}},t.exports=o},function(t,i,r){"use strict";function o(t){if(!(this instanceof o))return new o(t);t=e.checkMatrix(t);var i,r,s,a,l=t.clone(),u=t.rows,h=t.columns,f=new Array(h);for(s=0;h>s;s++){var c=0;for(i=s;u>i;i++)c=n(c,l[i][s]);if(0!==c){for(l[s][s]<0&&(c=-c),i=s;u>i;i++)l[i][s]/=c;for(l[s][s]+=1,r=s+1;h>r;r++){for(a=0,i=s;u>i;i++)a+=l[i][s]*l[i][r];for(a=-a/l[s][s],i=s;u>i;i++)l[i][r]+=a*l[i][s]}}f[s]=-c}this.QR=l,this.Rdiag=f}var e=r(27),n=r(30).hypotenuse;o.prototype={solve:function(t){t=e.checkMatrix(t);var i=this.QR,r=i.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,n,s,a,l=t.columns,u=t.clone(),h=i.columns;for(s=0;h>s;s++)for(n=0;l>n;n++){for(a=0,o=s;r>o;o++)a+=i[o][s]*u[o][n];for(a=-a/i[s][s],o=s;r>o;o++)u[o][n]+=a*i[o][s]}for(s=h-1;s>=0;s--){for(n=0;l>n;n++)u[s][n]/=this.Rdiag[s];for(o=0;s>o;o++)for(n=0;l>n;n++)u[o][n]-=u[s][n]*i[o][s]}return u.subMatrix(0,h-1,0,l-1)},isFullRank:function(){for(var t=this.QR.columns,i=0;t>i;i++)if(0===this.Rdiag[i])return!1;return!0},get upperTriangularFactor(){var t,i,r=this.QR,o=r.columns,n=new e(o,o);for(t=0;o>t;t++)for(i=0;o>i;i++)i>t?n[t][i]=r[t][i]:t===i?n[t][i]=this.Rdiag[t]:n[t][i]=0;return n},get orthogonalFactor(){var t,i,r,o,n=this.QR,s=n.rows,a=n.columns,l=new e(s,a);for(r=a-1;r>=0;r--){for(t=0;s>t;t++)l[t][r]=0;for(l[r][r]=1,i=r;a>i;i++)if(0!==n[r][r]){for(o=0,t=r;s>t;t++)o+=n[t][r]*l[t][i];for(o=-o/n[r][r],t=r;s>t;t++)l[t][i]+=o*n[t][r]}}return l}},t.exports=o},function(t,i,r){"use strict";function o(t){if(!(this instanceof o))return new o(t);if(t=e.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");var i,r,n,s=t,a=s.rows,l=new e(a,a),u=!0;for(r=0;a>r;r++){var h=l[r],f=0;for(n=0;r>n;n++){var c=l[n],p=0;for(i=0;n>i;i++)p+=c[i]*h[i];h[n]=p=(s[r][n]-p)/l[n][n],f+=p*p}for(f=s[r][r]-f,u&=f>0,l[r][r]=Math.sqrt(Math.max(f,0)),n=r+1;a>n;n++)l[r][n]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=l}var e=r(27);o.prototype={get leftTriangularFactor(){return this.L},solve:function(t){t=e.checkMatrix(t);var i=this.L,r=i.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");var o,n,s,a=t.columns,l=t.clone();for(s=0;r>s;s++)for(n=0;a>n;n++){for(o=0;s>o;o++)l[s][n]-=l[o][n]*i[s][o];l[s][n]/=i[s][s]}for(s=r-1;s>=0;s--)for(n=0;a>n;n++){for(o=s+1;r>o;o++)l[s][n]-=l[o][n]*i[o][s];l[s][n]/=i[s][s]}return l}},t.exports=o},function(t,i,r){function o(t,i,r){var r=Object.create(r||{});void 0===r.minMaxRatio&&(r.minMaxRatio=25e-5),void 0===r.broadRatio&&(r.broadRatio=0),void 0===r.noiseLevel&&(r.noiseLevel=void 0),void 0===r.noiseFactor&&(r.noiseFactor=3),void 0===r.maxCriteria&&(r.maxCriteria=!0),void 0===r.smoothY&&(r.smoothY=!0),void 0===r.realTopDetection&&(r.realTopDetection=!1);var o=s({},l,r.sgOptions);if(void 0===r.noiseLevel){for(var u,h=0,f=Number.MAX_VALUE,c=0;c<t.length-1;c++){var u=Math.abs(t[c+1]-t[c]);f>u&&(f=u),u>h&&(h=u)}.05>(h-f)/h?r.noiseLevel=e(i):r.noiseLevel=0}i=[].concat(i);var p={m:1,b:r.noiseLevel};r.maxCriteria||(p.m=-1,p.b*=-1);for(var c=0;c<i.length;c++)i[c]=p.m*i[c]-p.b;for(var c=0;c<i.length;c++)i[c]<0&&(i[c]=0);var m=i;if(.05>(h-f)/h){r.smoothY&&(m=a(i,t[1]-t[0],{windowSize:o.windowSize,polynomial:o.polynomial,derivative:0}));var g=a(i,t[1]-t[0],{windowSize:o.windowSize,polynomial:o.polynomial,derivative:1}),y=a(i,t[1]-t[0],{windowSize:o.windowSize,polynomial:o.polynomial,derivative:2})}else{r.smoothY&&(m=a(i,t,{windowSize:o.windowSize,polynomial:o.polynomial,derivative:0}));var g=a(i,t,{windowSize:o.windowSize,polynomial:o.polynomial,derivative:1}),y=a(i,t,{windowSize:o.windowSize,polynomial:o.polynomial,derivative:2})}for(var v=t,d=t[1]-t[0],w=0,b=0,c=0;c<m.length;c++)Math.abs(y[c])>w&&(w=Math.abs(y[c])),Math.abs(m[c])>b&&(b=Math.abs(m[c]));for(var C=[],M=[],x=[],H=null,A=null,D=new Array,c=1;c<m.length-1;c++)(g[c]<g[c-1]&&g[c]<=g[c+1]||g[c]<=g[c-1]&&g[c]<g[c+1])&&(A=v[c],d>0&&null!=H&&(M.push(H),x.push(A))),(g[c]>=g[c-1]&&g[c]>g[c+1]||g[c]>g[c-1]&&g[c]>=g[c+1])&&(H=v[c],0>d&&null!=A&&(M.push(H),x.push(A))),y[c]<y[c-1]&&y[c]<y[c+1]&&(C.push(c),Math.abs(y[c])>r.broadRatio*w?D.push(!1):D.push(!0));for(var S,E,R,X,k,F,P=[],N=0,O=0;O<C.length;O++){for(R=v[C[O]],S=-1,E=N+1,k=Number.MAX_VALUE,X=0,F=!0;-1==S&&E<M.length&&F;)X=Math.abs(R-(M[E]+x[E])/2),k>X?k=X:F=!1,X<Math.abs(M[E]-x[E])/2&&(S=E,N=E),E++;-1!=S&&Math.abs(m[C[O]])>r.minMaxRatio*b&&P.push({i:C[O],x:R,y:(m[C[O]]-p.b)/p.m,width:Math.abs(x[S]-M[S]),soft:D[O]})}r.realTopDetection&&n(P,v,m);for(var O=0;O<P.length;O++)P[O].base=r.noiseLevel;return P.sort(function(t,i){return t.x-i.x}),P}function e(t){var i=0,r=0,o=t.length,e=0;for(e=0;o>e;e++)i+=t[e];i/=o;var n=new Array(o);for(e=0;o>e;e++)n[e]=Math.abs(t[e]-i);return n.sort(),r=o%2==1?n[(o-1)/2]/.6745:.5*(n[o/2]+n[o/2-1])/.6745}function n(t,i,r){for(var o,e,n,s,a,l=0;l<t.length;l++){a=t[l].i;r[a-1]>=r[a-2]&&r[a-1]>=r[a]?a--:r[a+1]>=r[a]&&r[a+1]>=r[a+2]?a++:r[a-2]>=r[a-3]&&r[a-2]>=r[a-1]?a-=2:r[a+2]>=r[a+1]&&r[a+2]>=r[a+3]&&(a+=2),r[a-1]>0&&r[a+1]>0&&r[a]>=r[a-1]&&r[a]>=r[a+1]&&(o=20*Math.log10(r[a-1]),e=20*Math.log10(r[a]),n=20*Math.log10(r[a+1]),s=.5*(o-n)/(o-2*e+n),t[l].x=i[a]+(i[a]-i[a-1])*s,t[l].y=r[a]-.25*(r[a-1]-r[a+1])*s)}}var s=(r(13),r(36),r(7)),a=r(38),l={windowSize:9,polynomial:3};t.exports=o},function(t,i,r){"use strict";i.array=r(2),i.matrix=r(37)},function(t,i,r){"use strict";function o(t,i){"undefined"==typeof i&&(i=0);
for(var r=0,o=t.length,e=t[0].length,n=0;o>n;n++)for(var s=0;e>s;s++)r+=t[n][s]*Math.log(t[n][s]+i);return-r}function e(t,i){"undefined"==typeof i&&(i=0);var r,o,e,n,s=t.length,a=t[0].length;if(-1===i){for(r=[0],o=s*a,e=0;s>e;e++)for(n=0;a>n;n++)r[0]+=t[e][n];r[0]/=o}else if(0===i)for(r=new Array(a),o=s,n=0;a>n;n++){for(r[n]=0,e=0;s>e;e++)r[n]+=t[e][n];r[n]/=o}else{if(1!==i)throw new Error("Invalid dimension");for(r=new Array(s),o=a,n=0;s>n;n++){for(r[n]=0,e=0;a>e;e++)r[n]+=t[n][e];r[n]/=o}}return r}function n(t,i,r){for(var o=s(t,i,r),e=o.length,n=0;e>n;n++)o[n]=Math.sqrt(o[n]);return o}function s(t,i,r){"undefined"==typeof r&&(r=!0),i=i||e(t);var o=t.length;if(0===o)return[];for(var n=t[0].length,s=new Array(n),a=0;n>a;a++){for(var l=0,u=0,h=0,f=0;o>f;f++)h=t[f][a]-i[a],l+=h,u+=h*h;r?s[a]=(u-l*l/o)/(o-1):s[a]=(u-l*l/o)/o}return s}function a(t){for(var i=t.length,r=t[0].length,o=new Array(r),e=0;r>e;e++){for(var n=new Array(i),s=0;i>s;s++)n[s]=t[s][e];n.sort();var a=n.length;a%2===0?o[e]=.5*(n[a/2]+n[a/2-1]):o[e]=n[Math.floor(a/2)]}return o}function l(t){var i,r,o=t.length,e=t[0].length,n=new Array(e);for(i=0;e>i;i++){for(var s=new Array(o),a=0;o>a;a++)s[a]=0;var l=new Array(o),u=0;for(r=0;o>r;r++){var h=l.indexOf(t[r][i]);h>=0?s[h]++:(l[u]=t[r][i],s[u]=1,u++)}var f=0,c=0;for(r=0;u>r;r++)s[r]>f&&(f=s[r],c=r);n[i]=l[c]}return n}function u(t,i){"undefined"==typeof i&&(i=!0);for(var r=e(t),o=t.length,n=r.length,s=new Array(n),a=0;n>a;a++){for(var l=0,u=0,h=0;o>h;h++){var f=t[h][a]-r[a];l+=f*f,u+=f*f*f}var c=l/o,p=u/o,m=p/Math.pow(c,1.5);if(i){var g=Math.sqrt(o*(o-1)),y=o-2;s[a]=g/y*m}else s[a]=m}return s}function h(t,i){"undefined"==typeof i&&(i=!0);for(var r=e(t),o=t.length,n=t[0].length,s=new Array(n),a=0;n>a;a++){for(var l=0,u=0,h=0;o>h;h++){var f=t[h][a]-r[a];l+=f*f,u+=f*f*f*f}var c=l/o,p=u/o;if(i){var m=l/(o-1),g=o*(o+1)/((o-1)*(o-2)*(o-3)),y=u/(m*m),v=(o-1)*(o-1)/((o-2)*(o-3));s[a]=g*y-3*v}else s[a]=p/(c*c)-3}return s}function f(t){for(var i=t.length,r=n(t),o=r.length,e=new Array(o),s=Math.sqrt(i),a=0;o>a;a++)e[a]=r[a]/s;return e}function c(t,i){return p(t,void 0,i)}function p(t,i,r){"undefined"==typeof r&&(r=0),"undefined"==typeof i&&(0===r?i=t.length-1:1===r&&(i=t[0].length-1));var o=e(t,r),n=t.length;if(0===n)return[[]];var s,a,l,u,h,f=t[0].length;if(0===r){for(s=new Array(f),a=0;f>a;a++)s[a]=new Array(f);for(a=0;f>a;a++)for(l=a;f>l;l++){for(u=0,h=0;n>h;h++)u+=(t[h][l]-o[l])*(t[h][a]-o[a]);u/=i,s[a][l]=u,s[l][a]=u}}else{if(1!==r)throw new Error("Invalid dimension");for(s=new Array(n),a=0;n>a;a++)s[a]=new Array(n);for(a=0;n>a;a++)for(l=a;n>l;l++){for(u=0,h=0;f>h;h++)u+=(t[l][h]-o[l])*(t[a][h]-o[a]);u/=i,s[a][l]=u,s[l][a]=u}}return s}function m(t){var i,r,o=e(t),s=n(t,!0,o),a=g(t,o,s),l=t.length,u=t[0].length,h=new Array(u);for(i=0;u>i;i++)h[i]=new Array(u);for(i=0;u>i;i++)for(r=i;u>r;r++){for(var f=0,c=0,p=a.length;p>c;c++)f+=a[c][r]*a[c][i];f/=l-1,h[i][r]=f,h[r][i]=f}return h}function g(t,i,r){return i=i||e(t),"undefined"==typeof r&&(r=n(t,!0,i)),v(y(t,i,!1),r,!0)}function y(t,i,r){i=i||e(t);var o,n,s,a=t,l=t.length;if(!r)for(a=new Array(l),o=0;l>o;o++)a[o]=new Array(t[o].length);for(o=0;l>o;o++){var u=a[o];for(n=0,s=u.length;s>n;n++)u[n]=t[o][n]-i[n]}return a}function v(t,i,r){"undefined"==typeof i&&(i=n(t));var o,e,s,a=t,l=t.length;if(!r)for(a=new Array(l),o=0;l>o;o++)a[o]=new Array(t[o].length);for(o=0;l>o;o++){var u=a[o],h=t[o];for(e=0,s=u.length;s>e;e++)0===i[e]||isNaN(i[e])||(u[e]=h[e]/i[e])}return a}function d(t,i){var r=e(t),o=t.length;if(0===o)return[];for(var n=t[0].length,s=new Array(n),a=0;n>a;a++){for(var l=0,u=0,h=0,f=0;o>f;f++){var c=t[f][a]-r[a],p=i[f];l+=p*(c*c),h+=p,u+=p*p}s[a]=l*(h/(h*h-u))}return s}function w(t,i,r){"undefined"==typeof r&&(r=0);var o=t.length;if(0===o)return[];var e,n,s,a,l,u,h=t[0].length;if(0===r){for(e=new Array(h),n=0;h>n;n++)e[n]=0;for(n=0;o>n;n++)for(u=t[n],l=i[n],a=0;h>a;a++)e[a]+=u[a]*l}else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(o),n=0;o>n;n++)e[n]=0;for(a=0;o>a;a++)for(u=t[a],l=i[a],n=0;h>n;n++)e[a]+=u[n]*l}var f=M.sum(i);if(0!==f)for(n=0,s=e.length;s>n;n++)e[n]/=f;return e}function b(t,i,r,o){o=o||0,r=r||w(t,i,o);for(var e=0,n=0,s=0,a=i.length;a>s;s++)e+=i[s],n+=i[s]*i[s];var l=e/(e*e-n);return C(t,i,r,l,o)}function C(t,i,r,o,e){e=e||0,r=r||w(t,i,e),"undefined"==typeof o&&(o=1);var n=t.length;if(0===n)return[[]];var s,a,l,u,h,f=t[0].length;if(0===e){for(s=new Array(f),a=0;f>a;a++)s[a]=new Array(f);for(a=0;f>a;a++)for(l=a;f>l;l++){for(h=0,u=0;n>u;u++)h+=i[u]*(t[u][l]-r[l])*(t[u][a]-r[a]);s[a][l]=h*o,s[l][a]=h*o}}else{if(1!==e)throw new Error("Invalid dimension");for(s=new Array(n),a=0;n>a;a++)s[a]=new Array(n);for(a=0;n>a;a++)for(l=a;n>l;l++){for(h=0,u=0;f>u;u++)h+=i[u]*(t[l][u]-r[l])*(t[a][u]-r[a]);s[a][l]=h*o,s[l][a]=h*o}}return s}var M=r(2);t.exports={entropy:o,mean:e,standardDeviation:n,variance:s,median:a,mode:l,skewness:u,kurtosis:h,standardError:f,covariance:c,scatter:p,correlation:m,zScores:g,center:y,standardize:v,weightedVariance:d,weightedMean:w,weightedCovariance:b,weightedScatter:C}},function(t,i,r){function o(t,i,r){if(r=u({},h,r),r.windowSize%2===0||r.windowSize<5||!Number.isInteger(r.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(r.windowSize>t.length)throw new RangeError("Window size is higher than the data length "+r.windowSize+">"+t.length);if(r.derivative<0||!Number.isInteger(r.derivative))throw new RangeError("Derivative should be a positive integer");if(r.polynomial<1||!Number.isInteger(r.polynomial))throw new RangeError("Polynomial should be a positive integer");r.polynomial>=6&&console.warn("You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems");var o=r.windowSize,n=Math.floor(o/2),s=t.length,a=new Array(s),f=l(o,r.polynomial,r.derivative),c=0,p=!0;"[object Array]"===Object.prototype.toString.call(i)?p=!1:c=Math.pow(i,r.derivative);for(var m=0;n>m;m++){for(var g=f[n-m-1],y=f[n+m+1],v=0,d=0,w=0;o>w;w++)v+=g[w]*t[w],d+=y[w]*t[s-o+w-1];p?(a[n-m-1]=v/c,a[s-n+m]=d/c):(c=e(i,n-m-1,n,r.derivative),a[n-m-1]=v/c,c=e(i,s-n+m,n,r.derivative),a[s-n+m]=d/c)}for(var b=f[n],m=o;s+1>m;m++){for(var C=0,w=0;o>w;w++)C+=b[w]*t[w+m-o];p||(c=e(i,m-n-1,n,r.derivative)),a[m-n-1]=C/c}return a}function e(t,i,r,o){for(var e=0,n=0,s=i-r;i+r>s;s++)s>=0&&s<t.length-1&&(e+=t[s+1]-t[s],n++);return Math.pow(e/n,o)}function n(t,i,r,o){var e=0;return e=r>0?(4*r-2)/(r*(2*i-r+1))*(t*n(t,i,r-1,o)+o*n(t,i,r-1,o-1))-(r-1)*(2*i+r)/(r*(2*i-r+1))*n(t,i,r-2,o):0==r&&0==o?1:0}function s(t,i){var r=1;if(t>=i)for(var o=t-i+1;t>=o;o++)r*=o;return r}function a(t,i,r,o,e){for(var a=0,l=0;o>=l;l++)a+=(2*l+1)*(s(2*r,l)/s(2*r+l+1,l+1))*n(t,r,l,0)*n(i,r,l,e);return a}function l(t,i,r){for(var o=new Array(t),e=Math.floor(t/2),n=-e;e>=n;n++){o[n+e]=new Array(t);for(var s=-e;e>=s;s++)o[n+e][s+e]=a(s,n,e,i,r)}return o}var u=r(7),h=(r(36),{windowSize:9,derivative:0,polynomial:3});t.exports=o},function(t,i){"use strict";function r(t,i){var r,o=.025,e=!1,n=new Array(i.length);for(r=0;r<i.length;r++){e=!1;for(var s=0;s<t.length;s++)if(Math.abs(i[r].shift-t[s].delta1)<o+Math.abs(t[s].startX-t[s].stopX)/2&&(""===i[r].multiplicity||i[r].multiplicity.indexOf(t[s].multiplicity)>=0&&!t[s].asymmetric)){e=!0,n[r]=s;break}if(!e)break}var a=[];if(!e)return 0;for(r=0;r<i.length;r++)a.push(n[r]);for(r=0;r<a.length;r++)t[a[r]].integralData.value=0;return 1}function o(t,i,o){var s,a=null;for(s=0;s<e.length;s++)if(e[s].solvent.indexOf(i)>=0){a=e[s].impurities;break}a.push({shifts:[{proton:"X",coupling:0,multiplicity:"",shift:0}],name:"TMS"});var l=(t.length,a.length),u=new Array(l);for(s=0;l>s;s++)n.indexOf(a[s].name)>=0&&(u[s]=r(t,a[s].shifts));var h=0;for(s=0;s<t.length;s++)h+=t[s].integralData.value;if(h!=o)for(h=o/h,s=0;s<t.length;s++)t[s].integralData.value*=h}var e=[{solvent:"CDCl3",impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"ds",shift:7.26}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"bs",shift:1.56}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.1}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.17}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.1}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.36}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.28}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.19},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.22}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.98},{proton:"OHc",coupling:0,multiplicity:"s",shift:5.01},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.27},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.43}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.26}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.43}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.73}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.3}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.21},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.48}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.65},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.57},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.39}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.4},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.55}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.09},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3.02},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.94}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:8.02},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.96},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.88}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.62}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.71}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.25},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.72},{proton:"OH",coupling:5,multiplicity:"s,t",shift:1.32}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.05},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.12},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.26}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.14},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.46},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.06}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.76}],name:"ethylene_glycol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"m",shift:.86},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.26}],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.26}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.65}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.49},{proton:"OH",coupling:0,multiplicity:"s",shift:1.09}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.33}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:7},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.27}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.22},{proton:"CH",coupling:6,multiplicity:"sep",shift:4.04}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.62},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.29},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.68}],name:"pyridine"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:.07}],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.85},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.76}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.36},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.17},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.25}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.03},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.53}],name:"triethylamine"}]},{solvent:"(CD3)2CO",impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:2.05}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:2.84}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.96}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.09}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.05}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.36}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.18}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.13},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.13}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.96},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.22},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.41}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:8.02}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.43}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.87}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.63}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.11},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.41}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.56},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.47},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.28}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.28},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.46}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.83}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.96},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.94},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.78}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.52}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.59}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.12},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.57},{proton:"OH",coupling:5,multiplicity:"s,t",shift:3.39}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.05},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.2}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.45},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:.96}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.28}],name:"ethylene_glycol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"m",shift:.87},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.29}],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.28}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.59}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.31},{proton:"OH",coupling:0,multiplicity:"s",shift:3.12}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.43}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.27}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.1},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.9}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.58},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.35},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.76}],name:"pyridine"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:.13}],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.79},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.63}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.32},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.5},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.5}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.45}],name:"triethylamine"}]},{solvent:"(CD3)2SO/DMSO",impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"quint",shift:2.5}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:3.33}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.91}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.09}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.07}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.37}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.11},{proton:"OHc",coupling:0,multiplicity:"s",shift:4.19}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.11},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.08}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.87},{proton:"OHc",coupling:0,multiplicity:"s",shift:6.65},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.18},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.36}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:8.32}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.4}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.9}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.76}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.09},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.38}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.51},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.38},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.24}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.24},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.43}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.96},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.94},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.78}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.95},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.89},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.73}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.54}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.57}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.06},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.44},{proton:"OH",coupling:5,multiplicity:"s,t",shift:4.63}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.99},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.03},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.17}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.43},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:.91}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.34}],name:"ethylene_glycol"},{shifts:[],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.86},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.25}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.53}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.16},{proton:"OH",coupling:0,multiplicity:"s",shift:4.01}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.42}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.27}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.04},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.78}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.58},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.39},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.79}],name:"pyridine"},{shifts:[],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.76},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.6}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.3},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.18},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.25}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.93},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.43}],name:"triethylamine"}]},{solvent:"C6D6",impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:7.16}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:.4}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.55}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.55}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.55}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.15}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.05},{proton:"OHc",coupling:0,multiplicity:"s",shift:1.55}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.07},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.04}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:7.05},{proton:"OHc",coupling:0,multiplicity:"s",shift:4.79},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.24},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.38}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:6.15}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.4}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:2.9}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:4.27}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.11},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.26}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.46},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.34},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.11}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.12},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.33}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.6},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.57},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.05}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.63},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.36},{proton:"CH3",coupling:0,multiplicity:"s",shift:1.86}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.68}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.35}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.34}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.65},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:3.89},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:.92}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.58},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:1.81},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:.85}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.41}],name:"ethylene_glycol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"m",shift:.92},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.36}],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.89},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.24}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.4}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.07}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.94}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.86},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.23}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:.95},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.67}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.53},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:6.66},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:6.98}],name:"pyridine"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:.29}],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.4},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.57}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.11},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.02},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.13}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.4}],name:"triethylamine"}]},{solvent:"CD3CN",impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:1.94}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:2.13}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.96}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.08}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.96}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.37}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.16},{proton:"OHc",coupling:0,multiplicity:"s",shift:2.18}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.14},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.13}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.97},{proton:"OHc",coupling:0,multiplicity:"s",shift:5.2},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.22},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.39}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.58}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.44}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.81}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.44}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.12},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.42}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.53},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.45},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.29}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.28},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.45}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.96},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.83}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.92},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.89},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.77}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.5}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.6}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.12},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.54},{proton:"OH",coupling:5,multiplicity:"s,t",shift:2.47}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.06},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.2}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.06},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.43},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:.96}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.51}],name:"ethylene_glycol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"m",shift:.86},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.27}],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.89},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.28}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.57}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.28},{proton:"OH",coupling:0,multiplicity:"s",shift:2.16}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.31}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.87},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.29}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.09},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.87}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.57},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.33},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.73}],name:"pyridine"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:.08}],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.8},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.64}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.33},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.2},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.2}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.45}],name:"triethylamine"}]},{solvent:"CD3OD",impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:3.31}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:4.87}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.99}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.15}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.03}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.33}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.4}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.15},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.2}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",
shift:6.92},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.21},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.4}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.9}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.45}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.78}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.49}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.18},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.49}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.61},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.58},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.35}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.35},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.52}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3.31},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.92}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.97},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.99},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.86}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.65}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.66}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.19},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.6}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.01},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.09},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.24}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.12},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.5},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.01}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.59}],name:"ethylene_glycol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"m",shift:.88},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.29}],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.9},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.29}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.64}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.34}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.34}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.89},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.29}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.5},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.92}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.53},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.44},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.85}],name:"pyridine"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:.1}],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.87},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.71}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.32},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.16},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.16}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.05},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.58}],name:"triethylamine"}]},{solvent:"D2O",impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:4.79}],name:"solvent_residual_peak"},{shifts:[],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.08}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.22}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.06}],name:"acetonitrile"},{shifts:[],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.24}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.21},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.22}],name:"tert-butyl_methyl_ether"},{shifts:[],name:"BHTb"},{shifts:[],name:"chloroform"},{shifts:[],name:"cyclohexane"},{shifts:[],name:"1,2-dichloroethane"},{shifts:[],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.17},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.56}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.67},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.61},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.37}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.37},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.6}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.08},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3.06},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.9}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.92},{proton:"CH3",coupling:0,multiplicity:"s",shift:3.01},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.85}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.71}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.75}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.17},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.65}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.14},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.24}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.19},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:3.18},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.26}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.65}],name:"ethylene_glycol"},{shifts:[],name:"grease^f"},{shifts:[],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.61}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.34}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.4}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.9}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.17},{proton:"CH",coupling:6,multiplicity:"sep",shift:4.02}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.52},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.45},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.87}],name:"pyridine"},{shifts:[],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.88},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.74}],name:"tetrahydrofuran"},{shifts:[],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.99},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.57}],name:"triethylamine"}]}],n="solvent_residual_peakH2OTMS";t.exports=o},function(t,i,r){"use strict";i.FFTUtils=r(41),i.FFT=r(42)},function(t,i,r){var o=r(42),e={DEBUG:!1,ifft2DArray:function(t,i,r){var e=new Array(i*r),n=i/2,s=2*(r-1);o.init(n);for(var a={re:new Array(n),im:new Array(n)},l=0;r>l;l++){for(var u=n-1;u>=0;u--)a.re[u]=t[2*u*r+l],a.im[u]=t[(2*u+1)*r+l];o.bt(a.re,a.im);for(var u=n-1;u>=0;u--)e[2*u*r+l]=a.re[u],e[(2*u+1)*r+l]=a.im[u]}var h=new Array(n*s);o.init(s);for(var f={re:new Array(s),im:new Array(s)},c=s*n,u=0;i>u;u+=2){f.re[0]=e[u*r],f.im[0]=e[(u+1)*r];for(var l=1;r>l;l++)f.re[l]=e[u*r+l],f.im[l]=e[(u+1)*r+l],f.re[s-l]=e[u*r+l],f.im[s-l]=-e[(u+1)*r+l];o.bt(f.re,f.im);for(var p=u/2*s,l=s-1;l>=0;l--)h[p+l]=f.re[l]/c}return h},fft2DArray:function(t,i,r){var e=r/2+1,n=2*i,s=new Array(n*e);o.init(r);for(var a,l,u,h,f,c={re:new Array(r),im:new Array(r)},p={re:new Array(r),im:new Array(r)},m={re:new Array(r),im:new Array(r)},g=0;i/2>g;g++){a=2*g*r,c.re=t.slice(a,a+r),a=(2*g+1)*r,c.im=t.slice(a,a+r),o.fft1d(c.re,c.im),this.reconstructTwoRealFFT(c,p,m),l=4*g*e,u=(4*g+1)*e,h=(4*g+2)*e,f=(4*g+3)*e;for(var y=e-1;y>=0;y--)s[l+y]=p.re[y],s[u+y]=p.im[y],s[h+y]=m.re[y],s[f+y]=m.im[y]}p=null,m=null;var v=new Array(n*e);o.init(i);for(var d={re:new Array(i),im:new Array(i)},w=e-1;w>=0;w--){for(var g=i-1;g>=0;g--)d.re[g]=s[2*g*e+w],d.im[g]=s[(2*g+1)*e+w];o.fft1d(d.re,d.im);for(var g=i-1;g>=0;g--)v[2*g*e+w]=d.re[g],v[(2*g+1)*e+w]=d.im[g]}return v},reconstructTwoRealFFT:function(t,i,r){var o=t.re.length;i.re[0]=t.re[0],i.im[0]=0,r.re[0]=t.im[0],r.im[0]=0;for(var e,n,s,a,l,u=o/2;u>0;u--)l=o-u,e=.5*(t.re[u]-t.re[l]),n=.5*(t.re[u]+t.re[l]),s=.5*(t.im[u]-t.im[l]),a=.5*(t.im[u]+t.im[l]),i.re[u]=n,i.im[u]=s,i.re[l]=n,i.im[l]=-s,r.re[u]=a,r.im[u]=-e,r.re[l]=a,r.im[l]=e},convolute2DI:function(t,i,r,o){for(var e,n,s=0;r/2>s;s++)for(var a=0;o>a;a++)e=t[2*s*o+a]*i[2*s*o+a]-t[(2*s+1)*o+a]*i[(2*s+1)*o+a],n=t[2*s*o+a]*i[(2*s+1)*o+a]+t[(2*s+1)*o+a]*i[2*s*o+a],t[2*s*o+a]=e,t[(2*s+1)*o+a]=n},convolute:function(t,i,r,o){for(var e=new Array(o*r),n=0;r*o>n;n++)e[n]=t[n];e=this.fft2DArray(e,r,o);for(var s=i.length,a=new Array(o*r),n=0;o*r>n;n++)a[n]=0;for(var l,u,h=(s-1)/2,f=0;s>f;f++){l=(f-h+r)%r;for(var c=0;s>c;c++)u=(c-h+o)%o,a[l*o+u]=i[f][c]}a=this.fft2DArray(a,r,o);var p=2*r,m=o/2+1;return this.convolute2DI(e,a,p,m),this.ifft2DArray(e,p,m)}};t.exports=e},function(t,i,r){(function(){var t;t=i;var r={release:"0.3.0",date:"2013-03"};t.toString=function(){return"version "+r.release+", released "+r.date};for(var o=0,e=null,n=null,s={init:function(t){if(0===t||0!==(t&t-1))throw new Error("init: radix-2 required");o=t,s._initArray(),s._makeBitReversalTable(),s._makeCosSinTable()},fft1d:function(t,i){s.fft(t,i,1)},ifft1d:function(t,i){var r=1/o;s.fft(t,i,-1);for(var e=0;o>e;e++)t[e]*=r,i[e]*=r},bt1d:function(t,i){s.fft(t,i,-1)},fft2d:function(t,i){for(var r=[],e=[],n=0,a=0;o>a;a++){n=a*o;for(var l=0;o>l;l++)r[l]=t[l+n],e[l]=i[l+n];s.fft1d(r,e);for(var u=0;o>u;u++)t[u+n]=r[u],i[u+n]=e[u]}for(var h=0;o>h;h++){for(var f=0;o>f;f++)n=h+f*o,r[f]=t[n],e[f]=i[n];s.fft1d(r,e);for(var c=0;o>c;c++)n=h+c*o,t[n]=r[c],i[n]=e[c]}},ifft2d:function(t,i){for(var r=[],e=[],n=0,a=0;o>a;a++){n=a*o;for(var l=0;o>l;l++)r[l]=t[l+n],e[l]=i[l+n];s.ifft1d(r,e);for(var u=0;o>u;u++)t[u+n]=r[u],i[u+n]=e[u]}for(var h=0;o>h;h++){for(var f=0;o>f;f++)n=h+f*o,r[f]=t[n],e[f]=i[n];s.ifft1d(r,e);for(var c=0;o>c;c++)n=h+c*o,t[n]=r[c],i[n]=e[c]}},fft:function(t,i,r){for(var s,a,l,u,h,f,c,p,m,g=o>>2,y=0;o>y;y++)u=e[y],u>y&&(h=t[y],t[y]=t[u],t[u]=h,h=i[y],i[y]=i[u],i[u]=h);for(var v=1;o>v;v<<=1){a=0,s=o/(v<<1);for(var d=0;v>d;d++){f=n[a+g],c=r*n[a];for(var w=d;o>w;w+=v<<1)l=w+v,p=f*t[l]+c*i[l],m=f*i[l]-c*t[l],t[l]=t[w]-p,t[w]+=p,i[l]=i[w]-m,i[w]+=m;a+=s}}},_initArray:function(){e="undefined"!=typeof Uint32Array?new Uint32Array(o):[],n="undefined"!=typeof Float64Array?new Float64Array(1.25*o):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,i=0,r=0;for(e[0]=0;++t<o;){for(r=o>>1;i>=r;)i-=r,r>>=1;i+=r,e[t]=i}},_makeCosSinTable:function(){var t=o>>1,i=o>>2,r=o>>3,e=t+i,s=Math.sin(Math.PI/o),a=2*s*s,l=Math.sqrt(a*(2-a)),u=n[i]=1,h=n[0]=0;s=2*a;for(var f=1;r>f;f++)u-=a,a+=s*u,h+=l,l-=s*h,n[f]=h,n[i-f]=u;0!==r&&(n[r]=Math.sqrt(.5));for(var c=0;i>c;c++)n[t-c]=n[c];for(var p=0;e>p;p++)n[p+t]=-n[p]}},a=["init","fft1d","ifft1d","fft2d","ifft2d"],l=0;l<a.length;l++)t[a[l]]=s[a[l]];return t.bt=s.bt1d,t.fft=s.fft1d,t.ifft=s.ifft1d,t}).call(this)},function(t,i,r){"use strict";t.exports.fourierTransform=r(44),t.exports.zeroFilling=r(45),t.exports.apodization=r(46),t.exports.phaseCorrection=r(47),t.exports.digitalFilter=r(48)},function(t,i,r){"use strict";function o(t){var i=t.getNbPoints(),r=t.getNbSubSpectra()/2,o="NMR SPECTRUM",s=n.FFT;r>1&&(o="nD NMR SPECTRUM"),s.init(i);for(var a=t.getParamDouble("$FCOR",0),l=0;r>l;l++){var u=t.getYData(2*l),h=t.getYData(2*l+1);u[0]*=a,h[0]*=a,s.fft(u,h),u=u.concat(u.slice(0,(i+1)/2)),u.splice(0,(i+1)/2),h=h.concat(h.slice(0,(i+1)/2)),h.splice(0,(i+1)/2),t.setActiveElement(2*l),e(t,o),t.setActiveElement(2*l+1),e(t,o)}if(t.is2D()){var f=t.getParam(".ACQUISITION SCHEME");switch(f){case 1:break;case 2:break;case 3:}}return t.setActiveElement(0),t}function e(t,i){var r=t.getParamDouble("$BF1",NaN),o=t.getParamDouble("$SFO1",NaN),e=t.getParamDouble("$SW",NaN),n=(o-r)/r*1e6,s=.5*e*o/r;t.setDataType(i),t.setFirstX(n+s),t.setLastX(n-s),t.setXUnits("PPM");var a=t.getXData(),l=n+s;s=-2*s/(a.length-1);for(var u=0;u<a.length;u++)a[u]=l,l+=s}var n=r(40);t.exports=o},function(t,i){"use strict";function r(t,i,r){var o,e,n,s,a,l,u=t.getNbSubSpectra();if(0!=i)for(var h=0;u>h;h++){for(t.setActiveElement(h),o=t.getNbPoints(),l=t.getYData(),a=t.getXData(),e=t.getLastX(),n=(e-a[0])/(o-1),s=o;i>s;s++)l.push(0),a.push(e+n);o>i&&(l.splice(i,l.length-1),a.splice(i,a.length-1)),t.setFirstX(a[0]),t.setLastX(a[a.length-1])}return t.setActiveElement(0),t}t.exports=r},function(t,i){"use strict";function r(t,i){}t.exports=r},function(t,i){"use strict";function r(t,i,r){for(var o,e,n,s,a,l=t.getNbPoints(),u=t.getYData(0),h=t.getYData(1),f=r/l,c=2*Math.pow(Math.sin(f/2),2),p=Math.sin(f),m=Math.cos(i),g=Math.sin(i),y=0;l>y;y++)a=l-y-1,a=y,n=u[a]*m-h[a]*g,s=u[a]*g+h[a]*m,u[a]=n,h[a]=s,o=m-(c*m+p*g),e=g-(c*g-p*m),m=o,g=e;t.resetMinMax(),t.putParam("PHC0",i),t.putParam("PHC1",r)}t.exports=r},function(t,i,r){"use strict";function o(t,i){var r=0;i.nbPoints?r=i.nbPoints:i.brukerFilter&&(r=0);var o=t.getNbSubSpectra();if(0!=r)for(var n=0;o>n;n++)t.setActiveElement(n),e(t.getYData(),r),i.rotateX&&(e(t.getXData(),r),t.setFirstX(t.getX(0)),t.setLastX(t.getX(t.getNbPoints()-1)));return t.setActiveElement(0),t}var e=r(49);t.exports=o},function(t,i){"use strict";function r(t,i){var r=t.length;if(i%=r,Math.abs(i)>r/2&&(i=i>0?i-r:i+r),0!=i)for(var e,n=0,s=i,a=r,l=t[n],u=i,h=i>0?1:-1;a>0;)s=o(s,r),e=t[s],t[s]=l,s+=i,l=e,a--,s==u&&(s=o(s+h,r),u=s,n=o(s-i,r),l=t[n])}function o(t,i){return 0>t&&(t+=i),t>=i&&(t-=i),t}t.exports=r},function(t,i,r){"use strict";function o(t){e.call(this,t)}var e=r(1),n=r(51),s=r(52),a=r(3);r(36);o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.fromJcamp=function(t,i){i=i||{xy:!0,keepSpectra:!0,keepRecordsRegExp:/^.+$/};var r=a.convert(t,i);return new o(r)},o.prototype.isHomoNuclear=function(){return this.sd.xType==this.sd.yType},o.prototype.observeFrequencyX=function(){return this.sd.spectra[0].observeFrequency},o.prototype.observeFrequencyY=function(){return this.sd.indirectFrequency},o.prototype.getSolventName=function(){return(this.sd.info[".SOLVENTNAME"]||this.sd.info.$SOLVENT).replace("<","").replace(">","")},o.prototype.getXUnits=function(){return this.sd.ntuples[1].units},o.prototype.getYUnits=function(){return this.sd.ntuples[0].units},o.prototype.getZUnits=function(){return this.sd.ntuples[2].units},o.prototype.getLastY=function(){return this.sd.minMax.maxY},o.prototype.getFirstY=function(){return this.sd.minMax.minY},o.prototype.getDeltaY=function(){return(this.getLastY()-this.getFirstY())/(this.getNbSubSpectra()-1)},o.prototype.nmrPeakDetection2D=function(t){t=t||{},t.thresholdFactor||(t.thresholdFactor=1);var i=Math.round(255*Math.random());t.idPrefix&&(i=t.idPrefix);for(var r=n.findPeaks2D(this,t.thresholdFactor),o=0;o<r.length;o++)r[o]._highlight=[i+"_"+o],r[o].signalID=i+"_"+o;if(t.references&&s.alignDimensions(r,t.references),"new"===t.format){for(var e=new Array(r.length),a=r.length-1;a>=0;a--){var l=r[a];e[a]={fromTo:l.fromTo,integral:l.intensity||1,remark:"",signal:[{peak:l.peaks,delta:[l.shiftX,l.shiftY]}],_highlight:l._highlight,signalID:l.signalID}}r=e}return r},o.prototype.getNMRPeakThreshold=function(t){return"1H"==t?3:"13C"==t?5:1},o.prototype.getNucleus=function(t){return 1==t?this.sd.xType:2==t?this.sd.yType:this.sd.xType},o.prototype.zeroFilling=function(t,i){return Filters.zeroFilling(this,t,i)},o.prototype.brukerFilter=function(){return Filters.digitalFilter(this,{brukerFilter:!0})},o.prototype.digitalFilter=function(t){return Filters.digitalFilter(this,t)},o.prototype.fourierTransform=function(){return Filters.fourierTransform(this)},o.prototype.postFourierTransform=function(t){return Filters.phaseCorrection(0,t)},t.exports=o},function(t,i,r){"use strict";var o=r(40),e=r(52),n=r(53),s=r(2),a=o.FFTUtils,l={DEBUG:!1,smallFilter:[[0,0,1,2,2,2,1,0,0],[0,1,4,7,7,7,4,1,0],[1,4,5,3,0,3,5,4,1],[2,7,3,-12,-23,-12,3,7,2],[2,7,0,-23,-40,-23,0,7,2],[2,7,3,-12,-23,-12,3,7,2],[1,4,5,3,0,3,5,4,1],[0,1,3,7,7,7,3,1,0],[0,0,1,2,2,2,1,0,0]],getLoGnStdDevNMR:function(t){return t.isHomoNuclear()?1.5:3},findPeaks2D:function(t,i){0==i&&(i=1),0>i&&(i=-i);for(var r=t.getNbPoints(),o=t.getNbSubSpectra(),n=new Array(r*o),s=t.isHomoNuclear(),a=0;o>a;a++)for(var l=t.getYData(a),u=0;r>u;u++)s?n[a*r+u]=l[u]>0?l[u]:0:n[a*r+u]=Math.abs(l[u]);var h=this.getLoGnStdDevNMR(t);if(s){for(var f=this.convoluteWithLoG(n,o,r),c=this.findPeaks2DLoG(n,f,o,r,h*i),p=this.findPeaks2DMax(n,f,o,r,(h+.5)*i),m=0;m<c.length;m++)p.push(c[m]);return e.enhanceSymmetry(this.createSignals2D(p,t,24))}var f=this.convoluteWithLoG(n,o,r),c=this.findPeaks2DLoG(n,f,o,r,h*i);return this.createSignals2D(e.clean(c,.05),t,24)},convoluteWithLoG:function(t,i,r){for(var o=new Array(r*i),e=i*r-1;e>=0;e--)o[e]=t[e];o=a.fft2DArray(o,i,r);for(var n=this.smallFilter.length,s=new Array(r*i),e=r*i-1;e>=0;e--)s[e]=0;for(var l,u,h=(n-1)/2,f=0;n>f;f++){l=(f-h+i)%i;for(var c=0;n>c;c++)u=(c-h+r)%r,s[l*r+u]=this.smallFilter[f][c]}s=a.fft2DArray(s,i,r);var p=2*i,m=r/2+1;return a.convolute2DI(o,s,p,m),a.ifft2DArray(o,p,m)},findPeaks2DLoG:function(t,i,r,o,e){for(var n=0,s=o*r-2;s>=0;s--)n+=Math.pow(i[s]-i[s+1],2);n=-Math.sqrt(n),n*=e/r;for(var a=new Array(o*r),s=o*r-1;s>=0;s--)a[s]=0;for(var l=0,s=i.length-1;s>=0;s--)i[s]<n&&(a[s]=1,l++);for(var u=0,h=[];0!=l;){for(u;u<a.length&&0==a[u];u++);if(u==a.length)break;l-=this.extractArea(t,i,a,u,r,o,h,n)}return h.length>0&&this.DEBUG&&console.log("No peak found"),h},findPeaks2DMax:function(t,i,r,o,e){for(var n=0,s=o*r-2;s>=0;s--)n+=Math.pow(i[s]-i[s+1],2);n=-Math.sqrt(n),n*=e/r;for(var a,l,u=[],h=0,s=0;s<i.length;s++)i[s]<n&&(a=Math.floor(s/o),l=s%o,a>0&&r>a+1&&o>l+1&&l>0&&i[s]<i[s+1]&&i[s]<i[s-1]&&(h=(a-1)*o+l,i[s]<i[h-1]&&i[s]<i[h]&&i[s]<i[h+1]&&(h=(a+1)*o+l,i[s]<i[h-1]&&i[s]<i[h]&&i[s]<i[h+1]&&u.push({x:l,y:a,z:t[s]}))));return u},extractArea:function(t,i,r,o,e,n,a,l){var u=Math.floor(o/n),h=o%n,f=[];this.scanBitmask(r,e,n,u,h,f);var c=new Array(f.length),p=new Array(f.length),m=new Array(f.length),g=f.length,y=0,v=0,d=0;if(g>=9){this.DEBUG&&console.log("nValues="+g);for(var w=Number.NEGATIVE_INFINITY,b=-1,C=0;g>C;C++){var M=f.splice(0,1)[0];c[C]=M[0],p[C]=M[1],m[C]=t[M[1]*n+M[0]],y+=c[C]*m[C],v+=p[C]*m[C],d+=m[C],m[C]>w&&(w=m[C],b=C)}if(-1!=b){y/=d,v/=d;var x,H={x:y,y:v,z:d};x=s.minMax(c),H.minX=x.min,H.maxX=x.max,x=s.minMax(p),H.minY=x.min,H.maxY=x.max,a.push(H)}}return g},scanBitmask:function(t,i,r,o,e,n){0>o||0>e||e==r||o==i||t[o*r+e]&&(t[o*r+e]=0,n.push([e,o]),this.scanBitmask(t,i,r,o+1,e,n),this.scanBitmask(t,i,r,o-1,e,n),this.scanBitmask(t,i,r,o,e+1,n),this.scanBitmask(t,i,r,o,e-1,n))},createSignals2D:function(t,i,r){for(var o=[],e=(i.getNbSubSpectra(),i.observeFrequencyX()),s=i.observeFrequencyY(),a=i.getFirstY(),l=(i.getLastY(),i.getDeltaY()),u=t.length-1;u>=0;u--)t[u].x=i.arrayPointToUnits(t[u].x),t[u].y=a+l*t[u].y,(t[u].y<-1||t[u].y>=210)&&t.splice(u,1);var h=[],f=0;r*=r;for(var u=0;u<t.length;u++)for(var c=u;c<t.length;c++)f=Math.pow((t[u].x-t[c].x)*e,2)+Math.pow((t[u].y-t[c].y)*s,2),r>f?h.push(1):h.push(0);var p=n.fullClusterGenerator(h),o=[];if(null!=t)for(var m=0;m<p.length;m++){var g={nucleusX:i.getNucleus(1),nucleusY:i.getNucleus(2)};g.resolutionX=(i.getLastX()-i.getFirstX())/i.getNbPoints(),g.resolutionY=l;var y=[];g.shiftX=0,g.shiftY=0;for(var v=[Number.MAX_VALUE,0],d=[Number.MAX_VALUE,0],w=0,b=p[m].length-1;b>=0;b--)1==p[m][b]&&(y.push({x:t[b].x,y:t[b].y,z:t[b].z}),g.shiftX+=t[b].x*t[b].z,g.shiftY+=t[b].y*t[b].z,w+=t[b].z,t[b].x<v[0]&&(v[0]=t[b].x),t[b].x>v[1]&&(v[1]=t[b].x),t[b].y<d[0]&&(d[0]=t[b].y),t[b].y>d[1]&&(d[1]=t[b].y));g.fromTo=[{from:v[0],to:v[1]},{from:d[0],to:d[1]}],g.shiftX/=w,g.shiftY/=w,g.peaks=y,o.push(g)}return o}};t.exports=l},function(t,i){"use strict";var r={diagonalError:.05,tolerance:.05,DEBUG:!1,toleranceX:.025,toleranceY:.5,clean:function(t,i){var r,o=Number.NEGATIVE_INFINITY;for(r=t.length-1;r>=0;r--)Math.abs(t[r].z)>o&&(o=Math.abs(t[r].z));for(o*=i,r=t.length-1;r>=0;r--)Math.abs(t[r].z)<o&&t.splice(r,1);return t},enhanceSymmetry:function(t){var i=this.initializeProperties(t),r=t;this.DEBUG&&console.log("Before optimization size: "+r.size());var o,e,n,s;for(o=r.length-1;o>=0;o--)s=r[o],s.peaks.length>1&&i[o][1]++,1==i[o][0]&&(n=this.exist(r,i,s,-1,!0),n>=0&&(i[o][1]+=2,i[n][1]+=2));for(o=r.length-1;o>=0;o--)s=r[o],0==i[o][0]&&(e=this.checkCrossPeaks(r,i,s,!0),i[o][1]+=e);var a=0;for(o=r.length-1;o>=0;o--)0!==i[o][0]&&i[o][1]>2&&(a++,a+=this.completeMissingIfNeeded(r,i,r[o],i[o])),i[o][1]>=2&&0===i[o][0]&&a++;this.DEBUG&&console.log("After optimization size: "+a);var l=new Array(a);for(a--,o=r.length-1;o>=0;o--)0!==i[o][0]&&i[o][1]>2||0===i[o][0]&&i[o][1]>1?l[a--]=r[o]:console.log("Removed "+o+" "+r[o].peaks.length);return l},completeMissingIfNeeded:function(t,i,r,o){var e=this.exist(t,i,r,-o[0],!0),n=0,s=null,a=null;0>e&&(s={nucleusX:r.nucleusX,nucleusY:r.nucleusY},s.resolutionX=r.resolutionX,s.resolutionY=r.resolutionY,s.shiftX=r.shiftY,s.shiftY=r.shiftX,s.peaks=[{x:r.shiftY,y:r.shiftX,z:1}],t.push(s),a=[-o[0],o[1]],i.push(a),n++);var l,u=0,h=!1,f=!1;for(u=t.length-1;u>=0;u--)l=t[u],0===i[u][0]&&(Math.abs(l.shiftX-r.shiftX)<this.diagonalError&&(h=!0),Math.abs(l.shiftY-r.shiftY)<this.diagonalError&&(f=!0));return h===!1&&(s={nucleusX:r.nucleusX,nucleusY:r.nucleusY},s.resolutionX=r.resolutionX,s.resolutionY=r.resolutionY,s.shiftX=r.shiftX,s.shiftY=r.shiftX,s.peaks=[{x:r.shiftX,y:r.shiftX,z:1}],t.push(s),a=[0,o[1]],i.push(a),n++),f===!1&&(s={nucleusX:r.nucleusX,nucleusY:r.nucleusY},s.resolutionX=r.resolutionX,s.resolutionY=r.resolutionY,s.shiftX=r.shiftY,s.shiftY=r.shiftY,s.peaks=[{x:r.shiftY,y:r.shiftY,z:1}],t.push(s),a=[0,o[1]],i.push(a),n++),n},checkCrossPeaks:function(t,i,r,o){var e,n=0,s=0,a=4*r.shiftX,l=[],u=[];for(s=t.length-1;s>=0;s--)e=t[s],0!==i[s][0]&&(Math.abs(e.shiftX-r.shiftX)<this.diagonalError?(n++,o&&i[s][1]++,l.push(s),a+=e.shiftX):Math.abs(e.shiftY-r.shiftY)<this.diagonalError&&(n++,o&&i[s][1]++,u.push(s),a+=e.shiftY));if(a/=l.length+u.length+4,l.length>0)for(s=l.length-1;s>=0;s--)t[l[s]].shiftX=a;if(u.length>0)for(s=u.length-1;s>=0;s--)t[u[s]].shiftY=a;return r.shiftX=a,r.shiftY=a,n},exist:function(t,i,r,o,e){for(var n=t.length-1;n>=0;n--)if(i[n][0]==o&&this.distanceTo(r,t[n],e)<this.tolerance){if(e){var s=r.shiftX,a=t[n].shiftX;t[n].shiftY=s,r.shiftY=a}else{var s=(t[n].shiftX+r.shiftX)/2,a=(t[n].shiftY+r.shiftY)/2;t[n].shiftX=s,t[n].shiftY=a,r.shiftX=s,r.shiftY=a}return n}return-1},initializeProperties:function(t){for(var i=new Array(t.length),r=t.length-1;r>=0;r--)if(i[r]=[0,0],Math.abs(t[r].shiftX-t[r].shiftY)<=this.diagonalError){i[r][1]=1;var o=(2*t[r].shiftX+t[r].shiftY)/3;t[r].shiftX=o,t[r].shiftY=o}else t[r].shiftX-t[r].shiftY>0?i[r][0]=1:i[r][0]=-1;return i},distanceTo:function(t,i,r){return r?Math.sqrt(Math.pow(t.shiftX-i.shiftY,2)+Math.pow(t.shiftY-i.shiftX,2)):Math.sqrt(Math.pow(t.shiftX-i.shiftX,2)+Math.pow(t.shiftY-i.shiftY,2))},alignDimensions:function(t,i){for(var r=0;r<i.length;r++){var o=i[r];o&&this._alignSingleDimension(t,o)}},_alignSingleDimension:function(t,i){var r,o,e=0,n=0;for(r=0;r<t.length;r++){var s=t[r];for(o=0;o<i.length;o++)e=(i[o].startX+i[o].stopX)/2,n=Math.abs(i[o].startX-i[o].stopX)/2,s.nucleusX==i[o].nucleus&&Math.abs(s.shiftX-e)<=n&&s._highlight.push(i[o]._highlight[0]),s.nucleusY==i[o].nucleus&&Math.abs(s.shiftY-e)<=n&&s._highlight.push(i[o]._highlight[0])}}};t.exports=r},function(t,i){"use strict";var r={fullClusterGenerator:function(t){var i=Math.sqrt(2*t.length+.25)-.5,r=[],o=new Array(i),e=i,n=0,s=[];for(n=i-1;n>=0;n--)o[n]=1;for(var a=-1,l=[];e>0;){if(0===l.length){for(s=new Array(i),n=i-1;n>=0;n--)s[n]=0;for(r.push(s),a=i-1;0==o[a];a--);}else a=l.splice(0,1);s[a]=1,o[a]=0,e--;var u=new Array(i);for(n=i-1;n>=0;n--){var h=Math.max(a,n),f=Math.min(a,n);u[n]=t[f*(2*i-f-1)/2+h],1==u[n]&&1==o[n]&&0==s[n]&&(l.push(n),s[n]=1)}}return r}};t.exports=r},function(t,i){"use strict";var r=r||{};r.formater=function(){function t(t,r){g="",y="",v="";var o=null;return r&&r.solvent&&(o=r.solvent),r&&void 0!=r.rangeForMultiplet&&(d=r.rangeForMultiplet),r&&r.ascending?t.sort(function(t,i){return i.delta1-t.delta1}):t.sort(function(t,i){return t.delta1-i.delta1}),t.type="NMR SPEC","1H"==t[0].nucleus?i(t,!1,2,1,o):"13C"==t[0].nucleus&&i(t,!1,1,0,o),g.length>0&&(g+="."),g}function i(t,i,n,s,a){c(),r(t,a);for(var l=t.length,u=0;l>u;u++){if(i)var h=t[u];else var h=t[l-u-1];h&&(c(),o(h,n),e(h,s))}}function r(t,i){"NMR SPEC"==t.type?(t[0].nucleus&&(g+=f(t[0].nucleus)),g+=" NMR",(i||t[0].observe)&&(g+=" (",t[0].observe&&(g+=(1*t[0].observe).toFixed(0)+" MHz",i&&(g+=", ")),i&&(g+=h(i)),g+=")"),g+=" δ "):"IR"==t.type?g+=" IR ":"MASS"==t.type&&(g+=" MASS ")}function o(t,i){var r=0,o=0,e=0;t.startX&&(r="string"==typeof t.startX?parseFloat(t.startX):t.startX),t.stopX&&(o="string"==typeof t.stopX?parseFloat(t.stopX):t.stopX),t.delta1&&(e="string"==typeof t.delta1?parseFloat(t.delta1):t.delta1),t.asymmetric===!0||"m"==t.multiplicity&&d===!0?t.startX&&t.stopX?g+=o>r?r.toFixed(i)+"-"+o.toFixed(i):o.toFixed(i)+"-"+r.toFixed(i):t.delta1&&(g+=e.toFixed(i)):t.delta1?g+=e.toFixed(i):t.startX&&t.stopX&&(g+=((r+o)/2).toFixed(i))}function e(t,i){y="",a(t),n(t),l(t,i),s(t),y.length>0&&(g+=" ("+y+")")}function n(t){t.pubIntegration?(p(),y+=t.pubIntegration):t.integralData&&(p(),y+=t.integralData.value.toFixed(0)+" H")}function s(t){t.pubAssignment?(p(),y+=u(t.pubAssignment)):t.assignment&&(p(),y+=u(t.assignment))}function a(t){t.pubMultiplicity?(p(),y+=t.pubMultiplicity):t.multiplicity&&(p(),y+=t.multiplicity)}function l(t,i){if(t.nmrJs){for(var r="<i>J</i> = ",o=0;o<t.nmrJs.length;o++){var e=t.nmrJs[o].coupling;r.length>11&&(r+=", "),r+=e.toFixed(i)}p(),y+=r+" Hz"}}function u(t){return t=t.replace(/([0-9])/g,"<sub>$1</sub>"),t=t.replace(/\"([^\"]*)\"/g,"<i>$1</i>")}function h(t){return t=t.replace(/([0-9])/g,"<sub>$1</sub>")}function f(t){return t=t.replace(/([0-9])/g,"<sup>$1</sup>")}function c(){g.length>0&&!g.match(/ $/)&&(g+=", ")}function p(){y.length>0&&!y.match(", $")&&(y+=", ")}function m(t){return JSON.parse(SDAPI.AcsParserAsJSONString(t))}var g="",y="",v="",d=!1;return{toACS:t,toNMRSignal:m}}(),t.exports=r}])});
//# sourceMappingURL=spectra-data.min.js.map