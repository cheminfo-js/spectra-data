!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.spectraData=i():t.spectraData=i()}(this,function(){return function(t){function i(n){if(o[n])return o[n].exports;var r=o[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}var o={};return i.m=t,i.c=o,i.p="",i(0)}([function(t,i,o){"use strict";i.SD=o(1),i.NMR=o(4),i.NMR2D=o(19),i.ACS=o(25),i.JAnalyzer=o(6)},function(t,i,o){function n(t){this.sd=t,this.activeElement=0,this.DATACLASS_XY=1,this.DATACLASS_PEAK=2,this.TYPE_NMR_SPECTRUM="NMR Spectrum",this.TYPE_NMR_FID="NMR FID",this.TYPE_IR="IR",this.TYPE_RAMAN="RAMAN",this.TYPE_UV="UV",this.TYPE_MASS="MASS",this.TYPE_HPLC="HPLC",this.TYPE_GC="GC",this.TYPE_CD="CD",this.TYPE_2DNMR_SPECTRUM="nD NMR SPECTRUM",this.TYPE_2DNMR_FID="nD NMR FID",this.TYPE_XY_DEC="XY DEC",this.TYPE_XY_INC="XY INC",this.TYPE_IV="IV"}var r=o(2),e=o(3);n.fromJcamp=function(t,i){i=i||{},"undefined"==typeof i.xy&&(i.xy=!0);var o=e.convert(t,i);return new n(o)},n.prototype.setActiveElement=function(t){this.activeElement=t},n.prototype.getActiveElement=function(){return this.activeElement},n.prototype.getXUnits=function(){return this.getSpectrum().xUnit},n.prototype.getYUnits=function(){return this.getSpectrum().yUnit},n.prototype.getNbPoints=function(t){return this.getSpectrumData(t).y.length},n.prototype.getFirstX=function(t){return t=t||this.activeElement,this.sd.spectra[t].firstX},n.prototype.getLastX=function(t){return t=t||this.activeElement,this.sd.spectra[t].lastX},n.prototype.getFirstY=function(t){return t=t||this.activeElement,this.sd.spectra[t].firstY},n.prototype.getLastY=function(t){return t=t||this.activeElement,this.sd.spectra[t].lastY},n.prototype.setDataClass=function(t){t==this.DATACLASS_PEAK&&(this.getSpectrum().isPeaktable=!0,this.getSpectrum().isXYdata=!1),t==this.DATACLASS_XY&&(this.getSpectrum().isXYdata=!0,this.getSpectrum().isPeaktable=!1)},n.prototype.isDataClassPeak=function(){return this.getSpectrum().isPeaktable?this.getSpectrum().isPeaktable:!1},n.prototype.isDataClassXY=function(){return this.getSpectrum().isXYdata?this.getSpectrum().isXYdata:!1},n.prototype.setDataType=function(t){this.getSpectrum().dataType=t},n.prototype.getDataType=function(){return this.getSpectrum().dataType},n.prototype.getSpectrumData=function(t){return t=t||this.activeElement,this.sd.spectra[t].data[0]},n.prototype.getSpectrum=function(t){return t=t||this.activeElement,this.sd.spectra[t]},n.prototype.getNbSubSpectra=function(){return this.sd.spectra.length},n.prototype.getXData=function(t){return this.getSpectrumData(t).x},n.prototype.getYData=function(t){return this.getSpectrumData(t).y},n.prototype.getX=function(t){return this.getXData()[t]},n.prototype.getY=function(t){return this.getYData()[t]},n.prototype.getXYData=function(t){return[this.getXData(t),this.getYData(t)]},n.prototype.getTitle=function(t){return this.getSpectrum(t).title},n.prototype.setTitle=function(t,i){this.getSpectrum(i).title=t},n.prototype.getMinY=function(t){return r.min(this.getYData(t))},n.prototype.getMaxY=function(t){return r.max(this.getYData(t))},n.prototype.getMinMaxY=function(t){return r.minMax(this.getYData(t))},n.prototype.getNoiseLevel=function(){var t=0,i=0,o=this.getYData(),n=this.getNbPoints(),r=0;for(r=0;n>r;r++)t+=o[r];t/=this.getNbPoints();var e=new Array(n);for(r=0;n>r;r++)e[r]=Math.abs(o[r]-t);return e.sort(),i=n%2==1?e[(n-1)/2]/.6745:.5*(e[n/2]+e[n/2-1])/.6745,i*this.getNMRPeakThreshold(this.getNucleus(1))},n.prototype.arrayPointToUnits=function(t){return this.getFirstX()-t*(this.getFirstX()-this.getLastX())/(this.getNbPoints()-1)},n.prototype.unitsToArrayPoint=function(t){if(this.isDataClassXY())return Math.round((this.getFirstX()-t)*(-1/this.getDeltaX()));if(this.isDataClassPeak()){var i,o=0,n=this.getNbPoints()-1,r=0;if(this.getFirstX()>this.getLastX()){if(n=0,r=this.getNbPoints()-1,t>this.getFirstX())return this.getNbPoints();if(t<this.getLastX())return-1}else{if(t<this.getFirstX())return-1;if(t>this.getLastX())return this.getNbPoints()}for(;Math.abs(n-r)>1;){if(i=Math.round(Math.floor((n+r)/2)),this.getX(i)==t)return i;this.getX(i)>t?n=i:r=i}return o=r,Math.abs(this.getX(r)-t)>Math.abs(this.getX(n)-t)&&(o=n),o}return 0},n.prototype.getDeltaX=function(){return(this.getLastX()-this.getFirstX())/(this.getNbPoints()-1)},n.prototype.setMinMax=function(t,i){for(var o=this.getYData(),n=r.minMax(o),e=(i-t)/(n.max-n.min),s=0;s<o.length;s++)o[s]=(o[s]-n.min)*e+t},n.prototype.setMin=function(t){for(var i=this.getYData(),o=r.min(i),n=t/o,e=0;e<i.length;e++)i[e]*=n},n.prototype.setMax=function(t){for(var i=this.getYData(),o=r.max(i),n=t/o,e=0;e<i.length;e++)i[e]*=n},n.prototype.YShift=function(t){var i=this.getSpectrumData().y,o=this.getNbPoints(),n=0;for(n=0;o>n;n++)i[n]+=t;this.getSpectrum().firstY+=t,this.getSpectrum().lastY+=t},n.prototype.shift=function(t){for(var i=0;i<this.getNbSubSpectra();i++){this.setActiveElement(i);var o=this.getSpectrumData().x,n=this.getNbPoints(),i=0;for(i=0;n>i;i++)o[i]+=t;this.getSpectrum().firstX+=t,this.getSpectrum().lastX+=t}},n.prototype.fillWith=function(t,i,o){var n,r,e,s,a;if(t>i){var n=t;t=i,i=n}for(var l=0;l<this.getNbSubSpectra();l++)for(this.setActiveElement(l),s=this.getXData(),a=this.getYData(),r=this.unitsToArrayPoint(t),e=this.unitsToArrayPoint(i),r>e&&(n=r,r=e,e=n),0>r&&(r=0),e>=this.getNbPoints&&(e=this.getNbPoints-1),l=r;e>=l;l++)a[l]=o},n.prototype.suppressZone=function(t,i){var o,n,r,e,s;if(t>i){var o=t;t=i,i=o}for(var a=0;a<this.getNbSubSpectra();a++)for(this.setActiveElement(a),e=this.getXData(),s=this.getYData(),n=this.unitsToArrayPoint(t),r=this.unitsToArrayPoint(i),n>r&&(o=n,n=r,r=o),0>n&&(n=0),r>=this.getNbPoints&&(r=this.getNbPoints-1),a=r;a>=n;a--)s.splice(a,1),e.splice(a,1);this.setDataClass(this.DATACLASS_PEAK)},n.prototype.simplePeakPicking=function(t){},n.prototype.getMaxPeak=function(){for(var t=this.getSpectraDataY(),i=t[0],o=0,n=0;n<t.length;n++)i<t[n]&&(i=t[n],o=n);return[this.getSpectraDataX()[o],i]},n.prototype.getParamDouble=function(t,i){var o=this.sd.info[t];return o||(o=i),o},n.prototype.getParamString=function(t,i){var o=this.sd.info[t];return o||(o=i),o+""},n.prototype.getParamInt=function(t,i){var o=this.sd.info[t];return o||(o=i),o},n.prototype.getSpectrumDataY=function(){return this.getYData()},n.prototype.getSpectraDataX=function(){return this.getXData()},n.prototype.putParam=function(t,i){this.sd.info[t]=i},n.prototype.getArea=function(t,i){var o=this.unitsToArrayPoint(t),n=this.unitsToArrayPoint(i),r=0;if(o>n){var e=o;o=n,n=e}o=0>o?0:o,n=n>=this.getNbPoints()?this.getNbPoints()-1:n;for(var s=o;n>s;s++)r+=this.getY(s);return r*Math.abs(this.getDeltaX())},n.prototype.getVector=function(t,i,o){var n=this.getSpectraDataX(),r=this.getSpectraDataY(),e=0,s=n.length-1,a=1,l=!1;if(n[0]>n[1]&&(a=-1,e=n.length-1,s=0),t>i){var u=t;t=i,i=u,l=!0}if(n[s]>t||n[e]>i)return[];for(;n[e]<t;)e+=a;if(n[s]>i)for(var s=e;n[s]<i;)s+=a;var h=Math.abs(s-e)+1,p=new Array(h),f=new Array(h),c=0;-1==a&&(c=h-1);var m=e-a;do m+=a,p[c]=n[m],f[c]=r[m],c+=a;while(m!=s);return[p,f]},n.prototype.is2D=function(){return!1},t.exports=n},function(t,i){"use strict";function o(t){for(var i=-(1/0),o=t.length,n=0;o>n;n++)t[n]>i&&(i=t[n]);return i}function n(t){for(var i=1/0,o=t.length,n=0;o>n;n++)t[n]<i&&(i=t[n]);return i}function r(t){for(var i=1/0,o=-(1/0),n=t.length,r=0;n>r;r++)t[r]<i&&(i=t[r]),t[r]>o&&(o=t[r]);return{min:i,max:o}}function e(t){for(var i=0,o=t.length,n=0;o>n;n++)i+=t[n];return i/o}function s(t){for(var i=0,o=t.length,n=0;o>n;n++)i*=t[n];return Math.pow(i,1/o)}function a(t){for(var i=0,o=t.length,n=0;o>n;n++)i+=Math.log(t[n]);return i/o}function l(t,i){for(var o=0,n=0,r=t.length,e=0;r>e;e++)o+=i[e]*t[e],n+=i[e];return o/n}function u(t,i,o){"undefined"==typeof o&&(o=!1),t=o?t:t.slice(),t.sort();for(var n=t.length,r=Math.floor(n*i),e=0,s=r;n-r>s;s++)e+=t[s];return e/(n-2*r)}function h(t,i){"undefined"==typeof i&&(i=1);for(var o=0,n=0,r=t.length,e=0;r>e;e++)o+=Math.pow(t[e],i+1),n+=Math.pow(t[e],i);return o/n}function p(t,i){return Math.sqrt(g(t,i))}function f(t){return p(t)/Math.sqrt(t.length)}function c(t,i){"undefined"==typeof i&&(i=!1),i||(t=t.slice(),t.sort());var o=t.length,n=Math.floor(o/2);return o%2===0?.5*(t[n-1]+t[n]):t[n]}function m(t,i){"undefined"==typeof i&&(i=!1),i||(t=t.slice(),t.sort());var o=t.length/4,n=t[Math.ceil(o)-1],r=c(t,!0),e=t[Math.ceil(3*o)-1];return{q1:n,q2:r,q3:e}}function g(t,i){"undefined"==typeof i&&(i=!0);for(var o=e(t),n=0,r=t.length,s=0;r>s;s++){var a=t[s]-o;n+=a*a}return i?n/(r-1):n/r}function y(t,i){return Math.sqrt(v(t,i))}function v(t,i){"undefined"==typeof i&&(i=!0);for(var o=0,n=0,r=t.length,e=0;r>e;e++){var s=t[e],a=g(s);o+=(s.length-1)*a,n+=i?s.length-1:s.length}return o/n}function d(t){var i,o=t.length,n=new Array(o);for(i=0;o>i;i++)n[i]=0;var r=new Array(o),e=0;for(i=0;o>i;i++){var s=r.indexOf(t[i]);s>=0?n[s]++:(r[e]=t[i],n[e]=1,e++)}var a=0,l=0;for(i=0;e>i;i++)n[i]>a&&(a=n[i],l=i);return r[l]}function C(t,i,o){"undefined"==typeof o&&(o=!0);var n=e(t),r=e(i);if(t.length!==i.length)throw"Vectors do not have the same dimensions";for(var s=0,a=t.length,l=0;a>l;l++){var u=t[l]-n,h=i[l]-r;s+=u*h}return o?s/(a-1):s/a}function H(t,i){"undefined"==typeof i&&(i=!0);for(var o=e(t),n=0,r=0,s=t.length,a=0;s>a;a++){var l=t[a]-o;n+=l*l,r+=l*l*l}var u=n/s,h=r/s,p=h/Math.pow(u,1.5);if(i){var f=Math.sqrt(s*(s-1)),c=s-2;return f/c*p}return p}function w(t,i){"undefined"==typeof i&&(i=!0);for(var o=e(t),n=t.length,r=0,s=0,a=0;n>a;a++){var l=t[a]-o;r+=l*l,s+=l*l*l*l}var u=r/n,h=s/n;if(i){var p=r/(n-1),f=n*(n+1)/((n-1)*(n-2)*(n-3)),c=s/(p*p),m=(n-1)*(n-1)/((n-2)*(n-3));return f*c-3*m}return h/(u*u)-3}function b(t,i){"undefined"==typeof i&&(i=0);for(var o=0,n=t.length,r=0;n>r;r++)o+=t[r]*Math.log(t[r]+i);return-o}function M(t,i){for(var o=0,n=t.length,r=0;n>r;r++)o+=t[r]*i[r];return o}function x(t,i){return Math.sqrt(A(t,i))}function A(t,i){for(var o=M(t,i),n=0,r=t.length,e=0,s=0,a=0;r>a;a++){var l=t[a]-o,u=i[a];n+=u*(l*l),s+=u,e+=u*u}return n*(s/(s*s-e))}function k(t,i){"undefined"==typeof i&&(i=!1);var o=t;i||(o=t.slice());for(var n=e(o),r=o.length,s=0;r>s;s++)o[s]-=n}function D(t,i,o){"undefined"==typeof i&&(i=p(t)),"undefined"==typeof o&&(o=!1);for(var n=t.length,r=o?t:new Array(n),e=0;n>e;e++)r[e]=t[e]/i;return r}function S(t){var i=t.length,o=new Array(i);o[0]=t[0];for(var n=1;i>n;n++)o[n]=o[n-1]+t[n];return o}t.exports={min:n,max:o,minMax:r,mean:e,geometricMean:s,logGeometricMean:a,grandMean:l,truncatedMean:u,contraHarmonicMean:h,standardDeviation:p,standardError:f,median:c,quartiles:m,variance:g,pooledStandardDeviation:y,pooledVariance:v,mode:d,covariance:C,skewness:H,kurtosis:w,entropy:b,weightedMean:M,weightedStandardDeviation:x,weightedVariance:A,center:k,standardize:D,cumulativeSum:S}},function(t,i){"use strict";function o(){function t(t){for(var i=t.length,o=new Array(i),n=0;i>n;n++)o[n]=parseFloat(t[n]);return o}function i(i,l){l=l||{};var h=/^[A-Z]+$/;l.keepRecordsRegExp&&(h=l.keepRecordsRegExp);var p,f,c,m,g,y,v,d,C,H=new Date,w={},b={};b.profiling=[],b.logs=[];var M=[];b.spectra=M,b.info={};var x={};if("string"!=typeof i)return b;for(b.profiling&&b.profiling.push({action:"Before split to LDRS",time:new Date-H}),m=i.split(/[\r\n]+##/),b.profiling&&b.profiling.push({action:"Split to LDRS",time:new Date-H}),m[0]&&(m[0]=m[0].replace(/^[\r\n ]*##/,"")),g=0,y=m.length;y>g;g++){if(p=m[g],v=p.indexOf("="),v>0?(f=p.substring(0,v),c=p.substring(v+1).trim()):(f=p,c=""),f=f.replace(/[_ -]/g,"").toUpperCase(),"DATATABLE"===f&&(d=c.indexOf("\n"),-1===d&&(d=c.indexOf("\r")),d>0)){var A=-1,k=-1;if(C=c.substring(0,d).split(/[ ,;\t]+/),C[0].indexOf("++")>0){var D=C[0].replace(/.*\(([a-zA-Z0-9]+)\+\+.*/,"$1"),S=C[0].replace(/.*\.\.([a-zA-Z0-9]+).*/,"$1");A=w.symbol.indexOf(D),k=w.symbol.indexOf(S)}-1===A&&(A=0),-1===k&&(k=0),w.first&&(w.first.length>A&&(x.firstX=w.first[A]),w.first.length>k&&(x.firstY=w.first[k])),w.last&&(w.last.length>A&&(x.lastX=w.last[A]),w.last.length>k&&(x.lastY=w.last[k])),w.vardim&&w.vardim.length>A&&(x.nbPoints=w.vardim[A]),w.factor&&(w.factor.length>A&&(x.xFactor=w.factor[A]),w.factor.length>k&&(x.yFactor=w.factor[k])),w.units&&(w.units.length>A&&(x.xUnit=w.units[A]),w.units.length>k&&(x.yUnit=w.units[k])),x.datatable=C[0],C[1]&&C[1].indexOf("PEAKS")>-1?f="PEAKTABLE":C[1]&&(C[1].indexOf("XYDATA")||C[0].indexOf("++")>0)&&(f="XYDATA",x.deltaX=(x.lastX-x.firstX)/(x.nbPoints-1))}if("TITLE"===f)x.title=c;else if("DATATYPE"===f)x.dataType=c,c.indexOf("nD")>-1&&(b.twoD=!0);else if("XUNITS"===f)x.xUnit=c;else if("YUNITS"===f)x.yUnit=c;else if("FIRSTX"===f)x.firstX=parseFloat(c);else if("LASTX"===f)x.lastX=parseFloat(c);else if("FIRSTY"===f)x.firstY=parseFloat(c);else if("NPOINTS"===f)x.nbPoints=parseFloat(c);else if("XFACTOR"===f)x.xFactor=parseFloat(c);else if("YFACTOR"===f)x.yFactor=parseFloat(c);else if("DELTAX"===f)x.deltaX=parseFloat(c);else if(".OBSERVEFREQUENCY"===f||"$SFO1"===f)x.observeFrequency||(x.observeFrequency=parseFloat(c));else if(".OBSERVENUCLEUS"===f)x.xType||(b.xType=c.replace(/[^a-zA-Z0-9]/g,""));else if("$SFO2"===f)b.indirectFrequency||(b.indirectFrequency=parseFloat(c));else if("$OFFSET"===f)b.shiftOffsetNum=0,b.shiftOffsetVal||(b.shiftOffsetVal=parseFloat(c));else if("$REFERENCEPOINT"===f);else if("VARNAME"===f)w.varname=c.split(/[, \t]{2,}/);else if("SYMBOL"===f)w.symbol=c.split(/[, \t]{2,}/);else if("VARTYPE"===f)w.vartype=c.split(/[, \t]{2,}/);else if("VARFORM"===f)w.varform=c.split(/[, \t]{2,}/);else if("VARDIM"===f)w.vardim=t(c.split(/[, \t]{2,}/));else if("UNITS"===f)w.units=c.split(/[, \t]{2,}/);else if("FACTOR"===f)w.factor=t(c.split(/[, \t]{2,}/));else if("FIRST"===f)w.first=t(c.split(/[, \t]{2,}/));else if("LAST"===f)w.last=t(c.split(/[, \t]{2,}/));else if("MIN"===f)w.min=t(c.split(/[, \t]{2,}/));else if("MAX"===f)w.max=t(c.split(/[, \t]{2,}/));else if(".NUCLEUS"===f)b.twoD&&(b.yType=c.split(/[, \t]{2,}/)[0]);else if("PAGE"===f){x.page=c.trim(),x.pageValue=parseFloat(c.replace(/^.*=/,"")),x.pageSymbol=x.page.replace(/=.*/,"");var X=w.symbol.indexOf(x.pageSymbol),Y="";w.units&&w.units[X]&&(Y=w.units[X]),b.indirectFrequency&&"PPM"!==Y&&(x.pageValue/=b.indirectFrequency)}else"RETENTIONTIME"===f?x.pageValue=parseFloat(c):"XYDATA"===f?(e(b,x),c.match(/.*\+\+.*/)?a(x,c,b):s(x,c,b),M.push(x),x={}):"PEAKTABLE"===f?(e(b,x),s(x,c,b),M.push(x),x={}):n(f)?x[o(f)]=c:f.match(h)&&(b.info[f]=c.trim())}if(b.profiling&&b.profiling.push({action:"Finished parsing",time:new Date-H}),Object.keys(w).length>0){for(var O=[],_=Object.keys(w),g=0;g<_.length;g++)for(var E=_[g],P=w[E],F=0;F<P.length;F++)O[F]||(O[F]={}),O[F][E]=P[F];b.ntuples=O}if(b.twoD&&(u(b),b.profiling&&b.profiling.push({action:"Finished countour plot calculation",time:new Date-H}),l.keepSpectra||delete b.spectra),M.length>1&&(!M[0].dataType||M[0].dataType.toLowerCase().match(/.*mass./))&&(r(b),b.profiling&&b.profiling.push({action:"Finished GCMS calculation",time:new Date-H})),l.xy&&M.length>0)for(var g=0;g<M.length;g++){var x=M[g];if(x.data.length>0)for(var F=0;F<x.data.length;F++){for(var R=x.data[F],N={x:Array(R.length/2),y:Array(R.length/2)},T=0;T<R.length;T+=2)N.x[T/2]=R[T],N.y[T/2]=R[T+1];x.data[F]=N}}return b.profiling&&b.profiling.push({action:"Total time",time:new Date-H}),b}function o(t){return t.toLowerCase().replace(/[^a-z0-9]/g,"")}function n(t){for(var i=0;i<g.length;i++)if(t===g[i])return!0;return!1}function r(t){var i,n=t.spectra,r=[];for(i=0;i<g.length;i++){var e=o(g[i]);n[0][e]&&r.push(e)}if(0!==r.length){var s={};for(s.gc={},s.ms=[],i=0;i<r.length;i++)s.gc[r[i]]=[];for(i=0;i<n.length;i++){for(var a=n[i],l=0;l<r.length;l++)s.gc[r[l]].push(a.pageValue),s.gc[r[l]].push(parseFloat(a[r[l]]));a.data&&(s.ms[i]=a.data[0])}t.gcms=s}}function e(t,i){if(i.xFactor||(i.xFactor=1),i.yFactor||(i.yFactor=1),i.observeFrequency&&i.xUnit&&"HZ"===i.xUnit.toUpperCase()&&(i.xUnit="PPM",i.xFactor=i.xFactor/i.observeFrequency,i.firstX=i.firstX/i.observeFrequency,i.lastX=i.lastX/i.observeFrequency,i.deltaX=i.deltaX/i.observeFrequency),t.shiftOffsetVal){var o=i.firstX-t.shiftOffsetVal;i.firstX=i.firstX-o,i.lastX=i.lastX-o}}function s(t,i,o){t.isPeaktable=!0;var n,r,e,s,a,l=[];t.data=[l];var u=i.split(/,? *,?[;\r\n]+ */),h=0;for(n=1,r=u.length;r>n;n++)if(a=u[n].trim().replace(f,"").split(c),a.length%2===0)for(e=0,s=a.length;s>e;e+=2)l[h++]=parseFloat(a[e])*t.xFactor,l[h++]=parseFloat(a[e+1])*t.yFactor;else o.logs.push("Format error: "+a)}function a(t,i,o){t.deltaX||(t.deltaX=(t.lastX-t.firstX)/(t.nbPoints-1)),t.isXYdata=!0;var n=[];t.data=[n];var r,e,s,a=t.firstX,l=t.firstY,u=i.split(/[\r\n]+/);e=[];for(var h=1,c=u.length;c>h;h++)if(e=u[h].trim().replace(f,"").split(p),e.length>0){if(m){t.firstPoint||(t.firstPoint=parseFloat(e[0]));var g=parseFloat(e[0]-t.firstPoint)*t.xFactor+t.firstX;(r||0===r)&&(g+=t.deltaX),o.logs.push("Checking X value: currentX: "+a+" - expectedCurrentX: "+g)}for(var y=1,v=e.length;v>y;y++)if(1!==y||!r&&0!==r){if(e[y].length>0)if(s=e[y].charCodeAt(0),43===s||45===s||46===s||s>47&&58>s)r=null,l=parseFloat(e[y]),n.push(a,l*t.yFactor),a+=t.deltaX;else if(s>63&&74>s)r=null,l=parseFloat(String.fromCharCode(s-16)+e[y].substring(1)),n.push(a,l*t.yFactor),a+=t.deltaX;else if(s>96&&106>s)r=null,l=-parseFloat(String.fromCharCode(s-48)+e[y].substring(1)),n.push(a,l*t.yFactor),a+=t.deltaX;else if(s>82&&91>s||115===s){var d=parseFloat(String.fromCharCode(s-34)+e[y].substring(1))-1;115===s&&(d=parseFloat("9"+e[y].substring(1))-1);for(var C=0;d>C;C++)r&&(l+=r),n.push(a,l*t.yFactor),a+=t.deltaX}else 37===s?(r=parseFloat("0"+e[y].substring(1)),l+=r,n.push(a,l*t.yFactor),a+=t.deltaX):s>73&&83>s?(r=parseFloat(String.fromCharCode(s-25)+e[y].substring(1)),l+=r,n.push(a,l*t.yFactor),a+=t.deltaX):s>105&&115>s&&(r=-parseFloat(String.fromCharCode(s-57)+e[y].substring(1)),l+=r,n.push(a,l*t.yFactor),a+=t.deltaX)}else r=null,s=e[y].charCodeAt(0)}}function l(t){for(var i=0,o=t[0].data[0][0],n=o,r=t.length,e=t[0].data[0].length/2,s=new Array(r),a=0;r>a;a++){s[a]=new Array(e);for(var l=0;e>l;l++)s[a][l]=t[a].data[0][2*l+1],s[a][l]<o&&(o=t[a].data[0][2*l+1]),s[a][l]>n&&(n=t[a].data[0][2*l+1]),0!==a&&0!==l&&(i+=Math.abs(s[a][l]-s[a][l-1])+Math.abs(s[a][l]-s[a-1][l]))}return{z:s,minX:t[0].data[0][0],maxX:t[0].data[0][t[0].data[0].length-2],minY:t[0].pageValue,maxY:t[r-1].pageValue,minZ:o,maxZ:n,noise:i/((r-1)*(e-1)*2)}}function u(t){var i=l(t.spectra);t.contourLines=h(i),delete i.z,t.minMax=i}function h(t,i){for(var o,n,r,e,s,a=t.noise,l=t.z,u=[],h=7,p=new Float32Array(4),f=[],c=l.length,m=l[0].length,g=t.minX,y=t.maxX,v=(y-g)/(m-1),d=t.minY,C=t.maxY,H=(C-d)/(c-1),w=t.minZ,b=t.maxZ,M=0;2*h>M;M++){var x={};u.push(x);var A=M%2;s=0===A?(b-5*a)*Math.exp(M/2-h)+5*a:-(b-5*a)*Math.exp(M/2-h)-5*a;var k=[];if(x.zValue=s,x.lines=k,!(w>=s||s>=b))for(var D=0;c-1>D;D++)for(var S=0;m-1>S;S++){p[0]=l[D][S],p[1]=l[D][S+1],p[2]=l[D+1][S],p[3]=l[D+1][S+1];for(var X=0;4>X;X++)f[X]=p[X]>s;f[0]!==f[1]&&f[0]!==f[2]&&(o=S+(s-p[0])/(p[1]-p[0]),n=D,r=S,e=D+(s-p[0])/(p[2]-p[0]),k.push(o*v+g,n*H+d,r*v+g,e*H+d)),f[3]!==f[1]&&f[3]!==f[2]&&(o=S+1,n=D+1-(s-p[3])/(p[1]-p[3]),r=S+1-(s-p[3])/(p[2]-p[3]),e=D+1,k.push(o*v+g,n*H+d,r*v+g,e*H+d)),f[1]!==f[2]&&(o=S+1-(s-p[1])/(p[2]-p[1]),n=D+(s-p[1])/(p[2]-p[1]),f[1]!==f[0]&&(r=S+1-(s-p[1])/(p[0]-p[1]),e=D,k.push(o*v+g,n*H+d,r*v+g,e*H+d)),f[2]!==f[0]&&(r=S,e=D+1-(s-p[2])/(p[0]-p[2]),k.push(o*v+g,n*H+d,r*v+g,e*H+d)),f[1]!==f[3]&&(r=S+1,e=D+(s-p[1])/(p[3]-p[1]),k.push(o*v+g,n*H+d,r*v+g,e*H+d)),f[2]!==f[3]&&(r=S+(s-p[2])/(p[3]-p[2]),e=D+1,k.push(o*v+g,n*H+d,r*v+g,e*H+d)))}}return{minX:t.minX,maxX:t.maxX,minY:t.minY,maxY:t.maxY,segments:u}}var p=/[,\t \+-]*(?=[^\d,\t \.])|[ \t]+(?=[\d+\.-])/,f=/\$\$.*/,c=/[,\t ]+/,m=!1,g=["TIC",".RIC","SCANNUMBER"];return i}function n(t,i,o){return"boolean"==typeof i&&(o=i,i={}),o?r(t,i):a(t,i)}function r(t,i){return s||e(),new Promise(function(o){var n=Date.now()+""+Math.random();l[n]=o,s.postMessage({stamp:n,input:t,options:i})})}function e(){var t=URL.createObjectURL(new Blob(["var getConverter ="+o.toString()+";var convert = getConverter(); onmessage = function (event) { postMessage({stamp: event.data.stamp, output: convert(event.data.input, event.data.options)}); };"],{type:"application/javascript"}));s=new Worker(t),URL.revokeObjectURL(t),s.addEventListener("message",function(t){var i=t.data.stamp;l[i]&&l[i](t.data.output)})}var s,a=o(),l={};t.exports={convert:n}},function(t,i,o){function n(t){r.call(this,t)}var r=o(1),e=o(5),s=o(3);n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.fromJcamp=function(t,i){i=i||{xy:!0,keepSpectra:!0,keepRecordsRegExp:/^.+$/};var o=s.convert(t,i);return new n(o)},n.prototype.getNucleus=function(t){return t&&0!=t?"":this.sd.xType},n.prototype.getSolventName=function(){return(this.sd.info[".SOLVENTNAME"]||this.sd.info.$SOLVENT||"").replace("<","").replace(">","")},n.prototype.observeFrequencyX=function(){return this.sd.spectra[0].observeFrequency},n.prototype.getNMRPeakThreshold=function(t){return"1H"==t?3:"13C"==t?5:1},n.prototype.addNoise=function(t){},n.prototype.addSpectraDatas=function(t,i,o,n){},n.prototype.autoBaseline=function(){},n.prototype.fourierTransform=function(){},n.prototype.postFourierTransform=function(t){},n.prototype.zeroFilling=function(t,i){},n.prototype.haarWhittakerBaselineCorrection=function(t,i){},n.prototype.whittakerBaselineCorrection=function(t,i){},n.prototype.brukerSpectra=function(t){},n.prototype.apodization=function(t,i){},n.prototype.echoAntiechoFilter=function(){},n.prototype.SNVFilter=function(){},n.prototype.powerFilter=function(t){var i=this.getMinY();1>t&&0>i&&(this.YShift(-1*i),console.warn("SD.powerFilter: The spectrum had negative values and was automatically shifted before applying the function."))},n.prototype.logarithmFilter=function(t){var i=this.getMinY();0>=i&&(this.YShift(-1*i+1),console.warn("SD.logarithmFilter: The spectrum had negative values and was automatically shifted before applying the function."))},n.prototype.correlationFilter=function(t){},n.prototype.phaseCorrection=function(t,i){},n.prototype.automaticPhase=function(){},n.prototype.useBrukerPhase=function(){},n.prototype.nmrPeakDetection=function(t){return e.peakPicking(this,t)},n.prototype.toJcamp=function(t){return"NOT ImplementED"},t.exports=n},function(t,i,o){var n=o(6),r=o(7),e=r.Matrix,s=e.algebra,a={impurities:[],maxJ:20,peakPicking:function(t,i){i=i||{nH:10,clean:!0,realTop:!1,thresholdFactor:1,compile:!0,integral:0};var o,r,e,s,a=i.nH||10,l=Math.abs(t.getNoiseLevel())*(i.thresholdFactor||1),u=this.GSD(t,l);u=this.optmizeSpectrum(u,t,l);var h=this.detectSignals(u,t,a,i.integral||0);if(i.clean)for(var o=h.length-1;o>=0;o--)h[o].integralData.value<.5&&h.splice(o,1);if(i.compile){for(o=0;o<h.length;o++)if(n.compilePattern(h[o]),h[o].maskPattern&&"m"!=h[o].multiplicity&&""!=h[o].multiplicity){e=0,s=0;var p=[];for(r=h[o].maskPattern.length-1;r>=0;r--)if(s+=this.area(h[o].peaks[r]),h[o].maskPattern[r]===!1){var f=h[o].peaks.splice(r)[0];p.push([f.x,f.intensity,f.width]),h[o].maskPattern.splice(r),h[o].peaksComp.splice(r),h[o].nbPeaks--,e+=this.area(f)}if(p.length>0){e=e*h[o].integralData.value/s,h[o].integralData.value-=e;for(var c=[],r=p.length-1;r>=0;r--)c.push(p[r]);var m=this.detectSignals(c,t,e,i.integral||0);for(r=0;r<m.length;r++)h.push(m[r])}}this.updateIntegrals(h,a)}if(h.sort(function(t,i){return t.delta1-i.delta1}),i.clean)for(var o=h.length-1;o>=0;o--)h[o].integralData.value<.5&&h.splice(o,1);return h},optmizeSpectrum:function(t,i,o){var n,r,e,s,a=(i.observeFrequencyX(),[]),l=[],u=4,h=[t[0][0],u*t[0][2]];for(n=0;n<t.length;n++)Math.abs(t[n][0]-h[0])<u*t[n][2]+h[1]?(a.push(t[n]),e=h[0]+h[1],t[n][0]+u*t[n][2]>e&&(e=t[n][0]+u*t[n][2]),s=h[0]-h[1],t[n][0]-u*t[n][2]<s&&(s=t[n][0]-u*t[n][2]),h=[(e+s)/2,Math.abs(e-s)/2]):(l.push({limits:h,group:a}),a=[t[n]],h=[t[n][0],u*t[n][2]]);for(l.push({limits:h,group:a}),n=l.length-2;n>=0;n--)if(Math.abs(l[n].limits[0]-l[n+1].limits[0])<(l[n].limits[1]+l[n+1].limits[1])/2){for(r=0;r<l[n+1].group.length;r++)l[n].group.push(l[n+1].group[r]);e=l[n].limits[0]+l[n].limits[1],l[n+1].limits[0]+l[n+1].limits[1]>e&&(e=l[n+1].limits[0]+l[n+1].limits[1]),s=l[n].limits[0]-l[n].limits[1],l[n+1].limits[0]-l[n+1].limits[1]<s&&(s=l[n+1].limits[0]-l[n+1].limits[1]),l[n].limits=[(e+s)/2,Math.abs(e-s)/2],l.splice(n+1,1)}var p=[];for(n=0;n<l.length;n++){var f=this.fitSpectrum(l[n].group,l[n].limits,i);for(r=0;r<f.length;r++)f[r][1]>o&&p.push(f[r])}return p},fitSpectrum:function(t,i,o){var n,a=this.sampling(o,t,!1),l=function(t,i,o){var n,r,s,a,l=i.length/3,u=t.rows,h=(new e(t.length,1),new e(t.length,1));for(s=0;u>s;s++)h[s][0]=0;for(r=0;l>r;r++)for(a=Math.pow(i[r+2*l][0],2),n=i[r+l][0]*a,s=0;u>s;s++)h[s][0]+=n/(Math.pow(t[s][0]-i[r][0],2)+a);return h},u=a[0].length,h=new e(u,1),p=new e(u,1),f=0;for(n=0;u>n;n++)h[n][0]=a[0][n][0],p[n][0]=a[1][n][0],p[n][0]>f&&(f=p[n][0]);for(n=0;u>n;n++)p[n][0]/=f;var c=[u/s.sqrt(p.dot(p))],m=[3,100,.001,.001,.001,.01,.01,11,9,1],g=[],y=t.length,v=new e(3*y,1),d=new e(3*y,1),C=new e(3*y,1);for(n=0;y>n;n++)v[n][0]=t[n][0],v[n+y][0]=t[n][1]/f,v[n+2*y][0]=t[n][2]/2,d[n][0]=t[n][0]-.0025,d[n+y][0]=0,d[n+2*y][0]=t[n][2]/8,C[n][0]=t[n][0]+.0025,C[n+y][0]=1.3*t[n][1]/f,C[n+2*y][0]=2*t[n][2];var H=r.optimize(l,v,h,p,c,-5e-5,d,C,g,m),w=new Array(y);for(n=0;y>n;n++)w[n]=[H[n][0],H[n+y][0]*f,2*H[n+2*y][0]];return w},sampling:function(t,i,o){var n,r,e,s,a,l=[];if(n>r){var u=n;n=r,r=u}for(s=0;s<i.length;s++)for(var h=!0,p=4;h;)if(n=t.unitsToArrayPoint(i[s][0]-i[s][2]*p),r=t.unitsToArrayPoint(i[s][0]+i[s][2]*p),e=t.unitsToArrayPoint(i[s][0]),n>r&&(u=n,n=r,r=u),n=0>n?0:n,r=r>=t.getNbPoints()?t.getNbPoints()-1:r,10>r-n){for(a=n;r>=a;a++)l.push([t.getX(a),t.getY(a)]);h=!1}else l.push([t.getX(n),t.getY(n)]),l.push([t.getX(r),t.getY(r)]),p>.5?p-=.5:p/=2;l.sort(function(t,i){return t[0]-i[0]});var f=[],c=[],m=0;if(o)for(f=[l[0][0]],c=[l[0][1]],s=1;s<l.length;s++)f[m]!=l[s][0]&&(f.push(l[s][0]),c.push(l[s][1]),m++);else for(f=[[l[0][0]]],c=[[l[0][1]]],s=1;s<l.length;s++)f[m][0]!=l[s][0]&&(f.push([l[s][0]]),c.push([l[s][1]]),m++);return[f,c]},getVector:function(t,i,o,n){var r=t.unitsToArrayPoint(i),e=t.unitsToArrayPoint(o),s=[],a=[];if(r>e){var l=r;r=e,e=l}r=0>r?0:r,e=e>=t.getNbPoints()?t.getNbPoints()-1:e;for(var u=r;e>u;u+=10)n?(a.push(t.getY(u)),s.push(t.getX(u))):(a.push([t.getY(u)]),s.push([t.getX(u)]));return[s,a]},updateLimits:function(t){if("m"!=t.multiplicity&&""!=t.multiplicity){for(var i=t.peaks,o=i.length,n=0,r=0,e=0;o>e;e++)t.maskPattern[e]===!1&&(r+=this.area(i[e])),n+=this.area(i[e]);n=t.integralData.value/n,t.integralData.value-=r*n}return t.integralData.value},updateIntegrals:function(t,i){var o,n=0,r=0;for(o=0;o<t.length;o++)r+=Math.round(t[o].integralData.value);if(r!=i)for(n=i/r,o=0;o<t.length;o++)t[o].integralData.value*=n},realTopDetection:function(t,i){var o,n,r,e,s;for(j=0;j<t.length;j++)s=i.unitsToArrayPoint(t[j][0]),i.getY(s-1)>=i.getY(s-2)&&i.getY(s-1)>=i.getY(s)?s--:i.getY(s+1)>=i.getY(s)&&i.getY(s+1)>=i.getY(s+2)?s++:i.getY(s-2)>=i.getY(s-3)&&i.getY(s-2)>=i.getY(s-1)?s-=2:i.getY(s+2)>=i.getY(s+1)&&i.getY(s+2)>=i.getY(s+3)&&(s+=2),i.getY(s-1)>0&&i.getY(s+1)>0&&i.getY(s)>=i.getY(s-1)&&i.getY(s)>=i.getY(s+1)&&(o=20*Math.log10(i.getY(s-1)),n=20*Math.log10(i.getY(s)),r=20*Math.log10(i.getY(s+1)),e=.5*(o-r)/(o-2*n+r),t[j][0]=i.arrayPointToUnits(s+e),t[j][1]=i.getY(s)-.25*(i.getY(s-1)-i.getY(s+1))*e)},init:function(){this.impurities=[{impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:7.26}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:1.56}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.1}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.17}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.1}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.36}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.28}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.19},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.22}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.98},{proton:"OHc",coupling:0,multiplicity:"s",shift:5.01},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.27},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.43}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.26}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.43}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.73}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.3}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.21},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.48}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.65},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.57},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.39}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.4},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.55}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.09},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3.02},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.94}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:8.02},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.96},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.88}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.62}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.71}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.25},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.72},{proton:"OH",coupling:5,multiplicity:"s,t",shift:1.32}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.05},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.12},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.26}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.14},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.46},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.06}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.76}],name:"ethylene_glycol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"m",shift:.86},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.26}],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.26}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.65}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.49},{proton:"OH",coupling:0,multiplicity:"s",shift:1.09}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.33}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:7},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.27}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.22},{proton:"CH",coupling:6,multiplicity:"sep",shift:4.04}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.62},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.29},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.68}],name:"pyridine"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:.07}],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.85},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.76}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.36},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.17},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.25
}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.03},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.53}],name:"triethylamine"}],solvent:"CDCl3"},{impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:2.05}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:2.84}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.96}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.09}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.05}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.36}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.18}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.13},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.13}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.96},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.22},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.41}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:8.02}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.43}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.87}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.63}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.11},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.41}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.56},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.47},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.28}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.28},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.46}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.83}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.96},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.94},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.78}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.52}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.59}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.12},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.57},{proton:"OH",coupling:5,multiplicity:"s,t",shift:3.39}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.05},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.2}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.45},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:.96}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.28}],name:"ethylene_glycol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"m",shift:.87},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.29}],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.28}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.59}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.31},{proton:"OH",coupling:0,multiplicity:"s",shift:3.12}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.43}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.27}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.1},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.9}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.58},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.35},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.76}],name:"pyridine"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:.13}],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.79},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.63}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.32},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.5},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.5}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.45}],name:"triethylamine"}],solvent:"(CD3)2CO"},{impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:2.5}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:3.33}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.91}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.09}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.07}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.37}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.11},{proton:"OHc",coupling:0,multiplicity:"s",shift:4.19}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.11},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.08}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.87},{proton:"OHc",coupling:0,multiplicity:"s",shift:6.65},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.18},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.36}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:8.32}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.4}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.9}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.76}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.09},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.38}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.51},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.38},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.24}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.24},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.43}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.96},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.94},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.78}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.95},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.89},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.73}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.54}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.57}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.06},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.44},{proton:"OH",coupling:5,multiplicity:"s,t",shift:4.63}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.99},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.03},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.17}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.43},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:.91}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.34}],name:"ethylene_glycol"},{shifts:[],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.86},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.25}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.53}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.16},{proton:"OH",coupling:0,multiplicity:"s",shift:4.01}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.42}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.27}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.04},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.78}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.58},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.39},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.79}],name:"pyridine"},{shifts:[],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.76},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.6}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.3},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.18},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.25}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.93},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.43}],name:"triethylamine"}],solvent:"(CD3)2SO/DMSO"},{impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:7.16}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:.4}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.55}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.55}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.55}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.15}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.05},{proton:"OHc",coupling:0,multiplicity:"s",shift:1.55}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.07},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.04}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:7.05},{proton:"OHc",coupling:0,multiplicity:"s",shift:4.79},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.24},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.38}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:6.15}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.4}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:2.9}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:4.27}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.11},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.26}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.46},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.34},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.11}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.12},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.33}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.6},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.57},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.05}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.63},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.36},{proton:"CH3",coupling:0,multiplicity:"s",shift:1.86}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.68}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.35}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.34}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.65},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:3.89},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:.92}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.58},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:1.81},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:.85}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.41}],name:"ethylene_glycol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"m",shift:.92},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.36}],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.89},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.24}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.4}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.07}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.94}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.86},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.23}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:.95},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.67}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.53},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:6.66},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:6.98}],name:"pyridine"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:.29}],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.4},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.57}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.11},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.02},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.13}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.4}],name:"triethylamine"}],solvent:"C6D6"},{impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:1.94}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:2.13}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.96}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.08}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.96}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.37}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.16},{proton:"OHc",coupling:0,multiplicity:"s",shift:2.18}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.14},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.13}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.97},{proton:"OHc",coupling:0,multiplicity:"s",shift:5.2},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.22},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.39}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.58}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.44}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.81}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.44}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.12},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.42}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.53},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.45},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.29}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.28},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.45}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.96},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.83}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.92},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.89},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.77}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.5}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.6}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.12},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.54},{proton:"OH",coupling:5,multiplicity:"s,t",shift:2.47}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.06},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.2}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.06},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.43},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:.96}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.51}],name:"ethylene_glycol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"m",shift:.86},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.27}],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.89},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.28}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.57}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.28},{proton:"OH",coupling:0,multiplicity:"s",shift:2.16}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.31}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.87},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.29}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.09},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.87}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.57},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.33},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.73}],name:"pyridine"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:.08}],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.8},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.64}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.33},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.2},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.2}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.45}],name:"triethylamine"}],solvent:"CD3CN"},{impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:3.31}],name:"solvent_residual_peak"},{shifts:[{proton:"H2O",coupling:0,multiplicity:"s",shift:4.87}],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.99}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.15}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.03}],name:"acetonitrile"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.33}],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.4}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.15},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.2}],name:"tert-butyl_methyl_ether"},{shifts:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.92},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.21},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.4}],name:"BHTb"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.9}],name:"chloroform"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.45}],name:"cyclohexane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.78}],name:"1,2-dichloroethane"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.49}],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.18},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.49}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.61},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.58},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.35}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.35},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.52}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3.31},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.92}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.97},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.99},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.86}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.65}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.66}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.19},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.6}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.01},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.09},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.24}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.12},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.5},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.01}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.59}],name:"ethylene_glycol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"m",shift:.88},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.29}],name:"grease^f"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"t",shift:.9},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.29}],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.64}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.34}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.34}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.89},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.29}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.5},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.92}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.53},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.44},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.85}],name:"pyridine"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:.1}],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.87},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.71}],name:"tetrahydrofuran"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.32},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.16},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.16}],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.05},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.58}],name:"triethylamine"}],solvent:"CD3OD"},{impurities:[{shifts:[{proton:"X",coupling:0,multiplicity:"",shift:4.79}],name:"solvent_residual_peak"},{shifts:[],name:"H2O"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.08}],name:"acetic_acid"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.22}],name:"acetone"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.06}],name:"acetonitrile"},{shifts:[],name:"benzene"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.24}],name:"tert-butyl_alcohol"},{shifts:[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.21},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.22}],name:"tert-butyl_methyl_ether"},{shifts:[],name:"BHTb"},{shifts:[],name:"chloroform"},{shifts:[],name:"cyclohexane"},{shifts:[],name:"1,2-dichloroethane"},{shifts:[],name:"dichloromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.17},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.56}],name:"diethyl_ether"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.67},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.61},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.37}],name:"diglyme"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.37},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.6}],name:"1,2-dimethoxyethane"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.08},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3.06},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.9}],name:"dimethylacetamide"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.92},{proton:"CH3",coupling:0,multiplicity:"s",shift:3.01},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.85}],name:"dimethylformamide"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.71}],name:"dimethyl_sulfoxide"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.75}],name:"dioxane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.17},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.65}],name:"ethanol"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.14},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.24}],name:"ethyl_acetate"},{shifts:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.19},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:3.18},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.26}],name:"ethyl_methyl_ketone"},{shifts:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.65}],name:"ethylene_glycol"},{shifts:[],name:"grease^f"},{shifts:[],name:"n-hexane"},{shifts:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.61}],name:"HMPAg"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.34}],name:"methanol"},{shifts:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.4}],name:"nitromethane"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.9}],name:"n-pentane"},{shifts:[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.17},{proton:"CH",coupling:6,multiplicity:"sep",shift:4.02}],name:"2-propanol"},{shifts:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.52},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.45},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.87}],name:"pyridine"},{shifts:[],name:"silicone_greasei"},{shifts:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.88},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.74}],name:"tetrahydrofuran"},{shifts:[],name:"toluene"},{shifts:[{proton:"CH3",coupling:7,multiplicity:"t",shift:.99},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.57}],name:"triethylamine"}],solvent:"D2O"}]},detectSignals:function(t,i,o,n){var r,e,s,a,l=i.observeFrequencyX(),u=[],h={},p=[1e5,0],f=null,c=16/l,m=0;for(s=0;s<t.length;s++){if(Math.abs(t[s][0]-p[0])>c)h={nbPeaks:1,units:"PPM",startX:t[s][0]+t[s][2],stopX:t[s][0]-t[s][2],multiplicity:"",pattern:"",observe:l,nucleus:"1H",integralData:{from:t[s][0]-3*t[s][2],to:t[s][0]+3*t[s][2]},peaks:[]},h.peaks.push({x:t[s][0],intensity:t[s][1],width:t[s][2]}),u.push(h);else{var g=t[s][0]-t[s][2];h.stopX=Math.min(h.stopX,g),g=t[s][0]+t[s][2],h.stopX=Math.max(h.stopX,g),h.nbPeaks++,h.peaks.push({x:t[s][0],intensity:t[s][1],width:t[s][2]}),h.integralData.from=Math.min(h.integralData.from,t[s][0]-3*t[s][2]),h.integralData.to=Math.max(h.integralData.to,t[s][0]+3*t[s][2])}p=t[s]}for(s=0;s<u.length;s++){f=u[s].peaks;var y=u[s].integralData;r=0,e=0;for(var a=0;a<f.length;a++)r+=f[a].x*this.area(f[a]),e+=this.area(f[a]);u[s].delta1=r/e,0==n?y.value=e:y.value=i.getArea(y.from,y.to),m+=y.value}for(var s=0;s<u.length;s++){var y=u[s].integralData;y.value*=o/m}return u},area:function(t){return Math.abs(t.intensity*t.width*1.57)},labelPeaks:function(t,i,o){var n=0;for(n=4;n<this.impurities.length&&!(this.impurities[0][n].indexOf(i)>=0);n++);for(var r,e=this.impurities.length-1,s=t.length,a=new Array(e),l=0,u=0,h=0,p=.2,f=-1,c="",m=0,g=s-1;g>=0;g--)t[g][1]>m&&(m=t[g][1]);for(r=e-1;r>=0;r--){this.impurities[r+1][0]!=c&&(f++,c=this.impurities[r+1][0]),a[r]=[f,this.impurities[r+1][2],this.impurities[r+1][3],0,[],0],l=0;for(var g=s-1;g>=0;g--)u=1e4,this.impurities[r+1][n]>0&&(u=Math.abs(t[g][0]-this.impurities[r+1][n])),3*p>u&&(h=this.score(u,p),h>l&&(l=h,a[r][3]=l,a[r][4]=[g]))}for(var y=-1,v=0,d=0,C=[],H=[],r=e-1;r>=-1;){if(-1==r||a[r][0]!=y&&-1!=y){if(-1!=y&&(a[r+1][5]=v/d,a[r+1][5]>.9&&(h=this.updateScore(C,t,m,o),h>.9)))for(var g=0;g<C.length;g++)for(var w=C[g][4].length-1;w>=0;w--)H.push(t[C[g][4][w]]);r>=0&&(y=a[r][0],v=a[r][3],d=1,C=[a[r]])}else y=a[r][0],C.push(a[r]),v+=a[r][3],d++;r--}return H},updateScore:function(t,i,o,n){for(var r,e,s="",a=0,l=(this.maxJ/n,0),u=0,h=0,p=t.length-1;p>=0;p--){if(s=t[p][1],a=t[p][2],r=t[p][4][0],s.indexOf("sep")>=0)i[r][1]>.33*o&&t.splice(p,1);else if(s.indexOf("s")>=0||s.indexOf("X")>=0){for(e=r-1,l=i[r][1],u=r;e>=0&&Math.abs(i[r][0]-i[e][0])<.025;)i[e][1]<l&&(l=i[e][1],u=e),e--;for(e=r+1;e<i.length&&Math.abs(i[r][0]-i[e][0])<.025;)i[e][1]<l&&(l=i[e][1],u=e),e++;t[p][4][0]=u,h+=1}if(s.indexOf("d")>=0&&r>0&&r<i.length-1){var f=Math.abs(Math.abs(i[r-1][0]-i[r][0])*n-a),c=Math.abs(Math.abs(i[r+1][0]-i[r][0])*n-a),m=Math.abs(Math.abs(i[r+1][0]-i[r-1][0])*n-a);(2>f||2>c||2>m)&&(c>f?m>f?(t[p][4]=[r-1,r],h+=1):(t[p][4]=[r-1,r+1],h+=1):m>c?(t[p][4]=[r,r+1],h+=1):(t[p][4]=[r-1,r+1],h+=1))}if(s.indexOf("t")>=0&&r>0&&r<i.length-1){var f=Math.abs(Math.abs(i[r-1][0]-i[r][0])*n-a),c=Math.abs(Math.abs(i[r+1][0]-i[r][0])*n-a),g=Math.abs(Math.abs(i[r+1][0]-i[r+2][0])*n-a);2>f&&(t[p][4]=[r-1,r],h+=.5),2>c&&(t[p][4].push(r+1),h+=.5),2>m&&(t[p][4].push(r+2),h+=.5)}if(s.indexOf("q")>=0&&r>1&&r<i.length-2){var f=Math.abs(Math.abs(i[r-2][0]-i[r-1][0])*n-a),c=Math.abs(Math.abs(i[r-1][0]-i[r][0])*n-a),m=Math.abs(Math.abs(i[r+1][0]-i[r][0])*n-a),g=Math.abs(Math.abs(i[r+2][0]-i[r+1][0])*n-a);2>f&&(t[p][4].push(r-2),h+=.25),2>c&&(t[p][4].push(r-1),h+=.25),2>m&&(t[p][4].push(r+1),h+=.25),2>g&&(t[p][4].push(r+2),h+=.25)}}if(h/t.length<.5){for(var p=t.length-1;p>=0;p--)t.splice(p,1);return 0}return 1},score:function(t,i){return Math.exp(-Math.pow(t/i,2)/2)},createSignals:function(){},GSD:function(t,i){for(var o=t.getXYData(),n=new Array(o[1].length),r=o[0],e=t.observeFrequencyX(),s=16/M,a=n.length-1;a>=0;a--)n[a]=o[1][a],Math.abs(n[a])<i&&(n[a]=0);for(var l=r[1]-r[0],u=[],h=new Array,p=new Array,f=new Array,c=2;c<r.length-2;c++)h.push(1/35*(-3*n[c-2]+12*n[c-1]+17*n[c]+12*n[c+1]-3*n[c+2])),u.push(r[c]),p.push(1/(12*l)*(n[c-2]-8*n[c-1]+8*n[c+1]-n[c+2])),f.push(1/(7*l*l)*(2*n[c-2]-n[c-1]-2*n[c]-n[c+1]+2*n[c+2]));for(var m=new Array,g=new Array,y=new Array,v=0,a=0;a<h.length;a++)Math.abs(f[a])>v&&(v=Math.abs(f[a]));for(var d=new Array,a=1;a<h.length-1;a++){if((p[a]<p[a-1]&&p[a]<=p[a+1]||p[a]<=p[a-1]&&p[a]<p[a+1])&&m.push(u[a]),p[a]>=p[a-1]&&p[a]>p[a+1]||p[a]>p[a-1]&&p[a]>=p[a+1])try{g.push([u[a],m.pop()])}catch(C){console.log("Error I don't know why "+C)}f[a]<f[a-1]&&f[a]<f[a+1]&&(y.push([u[a],h[a],a]),Math.abs(f[a])>.0025*v?d.push(!1):d.push(!0))}l=Math.abs(l);var H=new Array,w=[[[Number.MAX_VALUE,0,0]]];h.sort(function(t,i){return t-i});for(var c=0;c<y.length;c++){for(var b=y[c],M=b[0],x=new Array,A=0;A<g.length;A++){var a=g[A];M>a[0]&&M<a[1]&&x.push(a)}if(x.length>0)if(1==x.length){var k=x[0],D=Math.abs(k[1]-k[0]),S=b[1];Math.abs(S)>25e-5*h[0]&&(d[c]?w.push([M,S,D]):H.push([M,S,D]))}else console.log("Nested "+x)}for(var X=0,Y=0,O=0,_=[],E=!1,s=16/e,a=w.length-1;a>0;a--)if(Math.abs(w[a-1][0]-w[a][0])<s)_.push(w[a]),w[a][1]>X&&(X=w[a][1],Y=a),O++;else{if(E=!0,O>30&&(E=!1),E)for(var c=0;c<_.length;c++)H.push([_[c][0],_[c][1],l]);else{var P=this.optimizeLorentzian(_);H.push(P)}_=[],X=0,Y=0,O=0}return H.sort(function(t,i){return t[0]-i[0]}),H},optimizeLorentzian:function(t){for(var i=function(t,i,o){for(var n=i[2][0]*Math.pow(i[1][0],2),r=t.rows,s=new e(t.rows,t.columns),a=0;r>a;a++)s[a][0]=i[3][0]+n/(Math.pow(t[a][0]-i[0][0],2)+Math.pow(i[1][0],2));
return s},o=t.length,n=new e(o,1),a=new e(o,1),l=0,u=0;o>u;u++)n[u][0]=t[u][0],a[u][0]=t[u][1],t[u][1]>l&&(l=t[u][1]);for(var u=0;o>u;u++)a[u][0]/=l;var h=[o/s.sqrt(a.dot(a))],p=[3,100,.001,.001,.001,.01,.01,11,9,1],f=[],c=new e([[(n[0][0]+n[o-1][0])/2],[Math.abs(n[0][0]-n[o-1][0])/2],[1],[0]]),m=new e([[n[0][0]],[0],[0],[0]]),g=new e([[n[o-1][0]],[Math.abs(n[0][0]-n[o-1][0])],[1.5],[.5]]),y=r.optimize(i,c,n,a,h,-.01,m,g,f,p);return[y[0][0],y[2][0]*l,2*y[1][0]]}};t.exports=a},function(t,i){var o={pascalTriangle:[[0],[1],[1,1],[1,2,1],[1,3,3,1],[1,4,6,4,1],[1,5,10,10,5,1],[1,6,15,20,15,6,1]],patterns:["s","d","t","q","quint","h","sept","o","n"],symRatio:1.5,maxErrorIter1:2.5,maxErrorIter2:1,DEBUG:!1,compilePattern:function(t){if(this.DEBUG&&console.log("Debugin..."),t.multiplicity="m",t.symRank=this.symmetrizeChoiseBest(t,this.maxErrorIter1,1),t.asymmetric=!0,t.symRank>=.95&&t.peaksComp.length<32){this.DEBUG&&console.log(t.delta1+" nbPeaks "+t.peaksComp.length),t.asymmetric=!1;for(var i,o,n,r,e,s=1,a=[],l=0;9>l;l++){this.DEBUG&&console.log("Trying "+l+" couplings"),peaks=this.normalize(t,l);var u=!1;if(1==peaks.length&&0===l)u=!0;else if(peaks.length<=1)continue;var h=this.getRanges(peaks);r=Math.pow(2,l),this.DEBUG&&(console.log("ranges: "+JSON.stringify(h)),console.log("Target sum: "+r));for(var p=null;!u&&null!==(p=this.getNextCombination(h,r));){this.DEBUG&&(console.log("Possible pattern found with "+l+" couplings!!!"),console.log(p));var f=new Array(p.length);for(s=1,i=0;i<p.length;i++)for(f[i]=new Array(p[i]),o=0;o<p[i];o++)f[i][o]=s++;this.DEBUG&&console.log("Numbering: "+JSON.stringify(f)),a=[],o=1,a.push(peaks[1].x-peaks[0].x),n=peaks[0].x,f[0].splice(0,1),f[1].splice(0,1),s=1;var c=2;for(e=Math.pow(2,l)-1;a.length<l&&e>c&&s<peaks.length;){for(this.DEBUG&&(console.log("New Jc"+JSON.stringify(a)),console.log("Aval. numbering "+JSON.stringify(f))),o++;s<peaks.length&&0===f[s].length;)s++;if(s<peaks.length){a.push(peaks[s].x-peaks[0].x),f[s].splice(0,1),c++;for(var m=2;o>=m;m++){var g=0;for(i=0;m>i;i++)g+=a[i];for(i=1;i<f.length;i++)if(Math.abs(peaks[i].x-(n+g))<.25){f[i].splice(0,1),c++;break}}}}var y=this.idealPattern(a);for(u=!0,i=0;i<y.length;i++)y[i].intensity!=p[i]&&(u=!1);this.DEBUG&&(console.log("Jc "+JSON.stringify(a)),console.log("Heights "+JSON.stringify(p)),console.log("pattern "+JSON.stringify(y)),console.log("Valid? "+u))}u&&this.updateSignal(t,a)}}for(i=0;i<t.peaksComp.length;i++)t.peaksComp[i].x/=t.observe},updateSignal:function(t,i){var o=t.peaksComp,n=o.length;t.startX=o[0].x/t.observe+o[0].width,t.stopX=o[n-1].x/t.observe-o[n-1].width,t.integralData.to=o[0].x/t.observe+3*o[0].width,t.integralData.from=o[n-1].x/t.observe-3*o[n-1].width,t.maskPattern=t.mask2,t.multiplicity=this.abstractPattern(t,i),t.pattern=t.multiplicity,this.DEBUG&&console.log("Final j-couplings: "+JSON.stringify(i))},abstractPattern:function(t,i){var o,n=.05,r="",e=1,s=[];if(i&&i.length>0){for(i.sort(function(t,i){return t-i}),o=0;o<i.length-1;o++)Math.abs(i[o]-i[o+1])<n?e++:(s.push({coupling:Math.abs(i[o]),multiplicity:this.patterns[e]}),r+=this.patterns[e],e=1);s.push({coupling:Math.abs(i[o]),multiplicity:this.patterns[e]}),r+=this.patterns[e],t.nmrJs=s}else r="s",Math.abs(t.startX-t.stopX)*t.observe>16&&(r="bs");return r},idealPattern:function(t){var i,o,n=Math.pow(2,t.length),r=[{x:0,intensity:n}];for(i=0;i<t.length;i++)for(o=r.length-1;o>=0;o--)r.push({x:r[o].x+t[i]/2,intensity:r[o].intensity/2}),r[o].x=r[o].x-t[i]/2,r[o].intensity=r[o].intensity/2;for(r.sort(function(t,i){return t.x-i.x}),o=r.length-2;o>=0;o--)Math.abs(r[o].x-r[o+1].x)<.1&&(r[o].intensity+=r[o+1].intensity,r.splice(o+1,1));return r},getNextCombination:function(t,i){for(var o,n=Math.ceil(t.values.length/2),r=t.values.length,e=0;e!=i;){ok=!1;for(;!ok;)if(ok=!0,t.currentIndex[t.active]++,t.currentIndex[t.active]>=t.values[t.active].length){if(t.active+1==n)return null;t.currentIndex[t.active]=0,ok=!1,t.active++}else t.active=0;for(e=0,o=0;n>o;o++)e+=2*t.values[o][t.currentIndex[o]];t.values.length%2!==0&&(e-=t.values[n-1][t.currentIndex[n-1]]),this.DEBUG&&(console.log(t.currentIndex),console.log(e+" "+i))}if(e==i){var s=new Array(r);for(o=0;n>o;o++)s[o]=t.values[o][t.currentIndex[o]],s[r-o-1]=t.values[o][t.currentIndex[o]];return s}return null},getRanges:function(t){var i,o,n=new Array(t.length),r=new Array(t.length);n[0]=[1],n[t.length-1]=[1],r[0]=-1,r[t.length-1]=0;for(var e=1;e<t.length-1;e++){i=Math.round(.85*t[e].intensity),o=Math.round(1.15*t[e].intensity),n[e]=[];for(var s=i;o>=s;s++)n[e].push(s);r[e]=0}return{values:n,currentIndex:r,active:0}},symmetrizeChoiseBest:function(t,i,o){var n=this.symmetrize(t,i,o),r=t.peaksComp,e=t.mask,s=t.delta1;t.delta1=(t.peaks[0].x+t.peaks[t.peaks.length-1].x)/2;var a=this.symmetrize(t,i,o);return t.peaksComp.length>r.length?a:(t.delta1=s,t.peaksComp=r,t.mask=e,n)},symmetrize:function(t,i,o){var n,r,e,s,a,l=new Array(t.peaks.length);for(j=0;j<l.length;j++)l[j]={x:t.peaks[j].x*t.observe,intensity:t.peaks[j].intensity,width:t.peaks[j].width};for(j=l.length-2;j>=0;j--)Math.abs(l[j].x-l[j+1].x)<.25&&(l[j].x=l[j].x*l[j].intensity+l[j+1].x*l[j+1].intensity,l[j].intensity=l[j].intensity+l[j+1].intensity,l[j].x/=l[j].intensity,l[j].intensity/=2,l[j].width+=l[j+1].width,l.splice(j+1,1));t.peaksComp=l;var u=l.length,h=new Array(u);t.mask=h;var p=0,f=l.length-1,c=t.delta1*t.observe,m=[(l[0].x+l[u-1].x)/2,1];i=this.error(Math.abs(c-m[0]));for(var g=0,y=0;u>y;y++)h[y]=!0,g+=t.peaks[y].intensity;for(;f>=p;){if(h[p]=!0,h[f]=!0,p==f)u>2&&Math.abs(l[p].x-c)>i&&(h[p]=!1);else if(n=Math.max(l[p].intensity,l[f].intensity),r=Math.min(l[p].intensity,l[f].intensity),s=n/r,s>this.symRatio)l[p].intensity==r?(h[p]=!1,f++):(h[f]=!1,p--);else{var v=Math.abs(l[p].x-c),d=Math.abs(l[f].x-c);Math.abs(v-d)<i?(e=Math.min(l[p].intensity,l[f].intensity),a=Math.min(l[p].width,l[f].width),l[p].intensity=l[f].intensity=e,l[p].width=l[f].width=a,m=[m[0]+(l[f].x+l[p].x)/2,m[1]+1]):Math.max(v,d)==d?(h[f]=!1,p--):(h[p]=!1,f++),this.DEBUG&&(console.log("MaxError: "+i+" "+m[0]+" "+m[1]),console.log(o+" CS: "+c+" Hz "+c/t.observe+" PPM"),console.log("Middle: "+m[0]/m[1]+" Hz "+m[0]/m[1]/t.observe+" PPM"),console.log(v+" "+d),console.log(Math.abs(v-d)),console.log(JSON.stringify(l)),console.log(JSON.stringify(h)))}if(p++,f--,1==o&&(c=this.chemicalShift(l,h),isNaN(c)))return 0;i=this.error(Math.abs(c-m[0]/m[1]))}for(y=u-1;y>=0;y--)h[y]===!1&&l.splice(y,1);if(c=this.chemicalShift(l),isNaN(c))return 0;t.delta1=c/t.observe;var C=0,H=0;if(l.length>1){for(y=Math.ceil(l.length/2)-1;y>=0;y--)C+=(3+Math.min(Math.abs(l[y].x-c),Math.abs(l[l.length-1-y].x-c)))/(3+Math.max(Math.abs(l[y].x-c),Math.abs(l[l.length-1-y].x-c)))*l[y].intensity,H+=l[y].intensity;C/=H}else 1==l.length&&(C=1);var w=0;for(y=0;y<l.length;y++)w+=l[y].intensity;if(C-=(g-w)/g*.12,this.DEBUG&&(console.log("Penalty "+(g-w)/g*.12),console.log("cs: "+c/t.observe+" symFactor: "+C)),C>.8&&.97>C&&2>o)return this.symmetrize(t,this.maxErrorIter2,2);if(l.length>1){var b,H=0;for(y=Math.ceil(l.length/2)-1;y>=0;y--)b=(l[y].x-l[l.length-1-y].x)/2,l[y].x=c+b,l[l.length-1-y].x=c-b}return C},error:function(t){var i=2.5*t;return.75>i&&(i=.75),i>3&&(i=3),i},normalize:function(t,i){var o,n=JSON.parse(JSON.stringify(t.peaksComp)),r=0,e=0;for(o=0;o<n.length;o++)r+=n[o].intensity;r=Math.pow(2,i)/r,t.mask2=JSON.parse(JSON.stringify(t.mask));var s=t.mask2.length-1;for(o=n.length-1;o>=0;o--){for(n[o].intensity*=r;s>=0&&t.mask2[s]===!1;)s--;n[o].intensity<.75?(this.DEBUG&&console.log("Peak "+o+" does not seem to belong to this multiplet "+n[o].intensity),n.splice(o,1),t.mask2[s]=!1):e+=n[o].intensity,s--}for(e=Math.pow(2,i)/e,o=n.length-1;o>=0;o--)n[o].intensity*=e;return this.DEBUG&&console.log(JSON.stringify(n)),n},chemicalShift:function(t,i){var o,n,r=0,e=0;if(i)for(o=0;o<t.length;o++)i[o]===!0&&(n=this.area(t[o]),r+=n,e+=n*t[o].x);else for(o=0;o<t.length;o++)n=this.area(t[o]),r+=n,e+=n*t[o].x;return e/r},area:function(t){return Math.abs(t.intensity*t.width*1.57)}};t.exports=o},function(t,i,o){"use strict";t.exports=o(8),t.exports.Matrix=o(9),t.exports.Matrix.algebra=o(18)},function(t,i,o){var n=o(9),r=o(18),e={optimize:function(t,i,o,e,s,a,l,u,h,p){var f=0,c=0;if("object"!=typeof i[0])for(var m=0;m<i.length;m++)i[m]=[i[m]];var g=-50,y=i.length,v=e.length,d=new n.zeros(y,1),C=new n.zeros(v,1),H=.01/g,w=.01/g,b=new n.zeros(v,y);if(o.length!=e.length){console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=o.length,length_y_dat=e.length;var H=0;if(!f)return}s=s||Math.sqrt((v-y+1)/r.multiply(r.transpose(e),e)),a=a||.001,l=l||r.multiply(Math.abs(i),-100),u=u||r.multiply(Math.abs(i),100),h=h||1,p=p||[3,10*y,.001,.001,.001,.01,.01,11,9,1];var M=p[0],x=p[1],A=p[2],k=(p[3],p[4],p[5]),D=p[6],S=p[7],X=p[8],Y=p[9];if(f&&3==M&&(M=2),!a.length||1==a.length){for(var O=new Array(y),m=0;y>m;m++)O[m]=[a];a=O}for(var _=[],m=0;m<a.length;m++)0!=a[m]&&_.push(m);var E=_.length,P=!1,F=null;if(!s.length||s.length<v){var R=r.multiply(new n.ones(v,1),s[0]);F=r.dotMultiply(R,R)}else F=r.dotMultiply(s,s);var N=this.lm_matx(t,o,d,C,1,b,i,e,F,a,h),T=N.JtWJ,q=N.JtWdy,H=N.Chi_sq,I=N.y_hat,b=N.J;switch(Math.max(Math.abs(q))<A&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",A),P=!0),Y){case 1:lambda=D;break;default:lambda=D*Math.max(r.diag(T)),nu=2}w=H;for(var j=(new n.ones(x,y+3),null);!P&&x>=c;){switch(c+=1,Y){case 1:j=r.solve(r.add(T,r.multiply(r.diag(r.diag(T)),lambda)),q);break;default:j=r.solve(r.add(T,r.multiply(new n.eye(y),lambda)),q)}for(var z=new Array(_.length),V=0;V<_.length;V++)z[V]=j[_[V]];for(var U=r.add(i,z),V=0;V<U.length;V++)U[V][0]=Math.min(Math.max(l[V][0],U[V][0]),u[V][0]);var L=r.subtract(e,t(o,U,h)),B=r.multiply(r.transpose(L),r.dotMultiply(L,F));if(2==Y){var J=r.multiply(r.transpose(q),j),G=r.multiply(J,r.inv(r.add(r.multiply(r.subtract(B-H),.5)),r.multiply(J,2)));j=r.multiply(G,j);for(var V=0;V<_.length;V++)z[V]=j[_[V]];U=r.add(i,z),U=r.min(r.max(l,U),u),L=r.subtract(e,t(o,U,h)),B=r.multiply(r.transpose(L),mat.dotMultiply(L,F))}var $=(H-B)/r.multiply(r.multiply(r.transpose(j),2),r.add(r.multiply(lambda,j),q));if($>k)switch(dX2=H-w,w=H,d=i,C=I,i=U,N=this.lm_matx(t,o,d,C,dX2,b,i,e,F,a,h),T=N.JtWJ,q=N.JtWdy,H=N.Chi_sq,I=N.y_hat,b=N.J,Y){case 1:lambda=Math.max(lambda/X,1e-7);break;case 2:lambda=Math.max(lambda/(1+G),1e-7);break;case 3:lambda=r.multiply(Math.max(1/3,1-(2*$-1)^3),lambda),nu=2}else switch(H=w,c%(2*y)==0&&(N=this.lm_matx(t,o,d,C,-1,b,i,e,F,a,h),T=N.JtWJ,q=N.JtWdy,dX2=N.Chi_sq,I=N.y_hat,b=N.J),Y){case 1:lambda=Math.min(lambda*S,1e7);break;case 2:lambda+=Math.abs((B-H)/2/G);break;case 3:lambda*=nu,nu=2*nu}}return F=r.multiply(r.multiply(r.transpose(L),L),new n.ones(v,1)),F.apply(function(t,i){F[t][i]=(v-E+1)/F[t][i]}),N=this.lm_matx(t,o,d,C,-1,b,i,e,F,a,h),T=N.JtWJ,q=N.JtWdy,H=N.Chi_sq,I=N.y_hat,b=N.J,i},lm_FD_J:function(t,i,o,e,s,a){var l=e.length,u=o.length;s=s||r.multiply(new n.ones(1,u),.001);for(var h=o.clone(),p=new n(l,u),f=new Array(u),c=0;u>c;c++){if(f[c]=s[c]*(1+Math.abs(o[c][0])),o[c]=[h[c][0]+f[c]],0!=f[c])if(y1=t(i,o,a),s[c][0]<0)for(var m=r.dotDivide(r.subtract(y1,e),f[c]),g=0;l>g;g++)p[g][c]=m[g][0];else{o[c][0]=h[c][0]-f[c];for(var m=r.dotDivide(r.subtract(y1,t(i,o,a)),2*f[c]),g=0;l>g;g++)p[g][c]=m[g][0]}o[c]=h[c]}return p},lm_Broyden_J:function(t,i,o,n,e){var s=r.subtract(n,t),a=r.transpose(s);return a.div(r.multiply(a,s)),o=r.add(o,r.multiply(r.subtract(e,r.add(i,r.multiply(o,s))),a))},lm_matx:function(t,i,o,e,s,a,l,u,h,p,f,c){var m=(u.length,l.length);p=p||.001;var g=t(i,l,f);a=c%(2*m)==0||s>0?this.lm_FD_J(t,i,l,g,p,f):this.lm_Broyden_J(o,e,a,l,g);var y=r.subtract(u,g),v=r.multiply(r.transpose(y),r.dotMultiply(y,h)),d=r.transpose(a),C=r.multiply(d,r.dotMultiply(a,r.multiply(h,new n.ones(1,m)))),H=r.multiply(d,r.dotMultiply(h,y));return{JtWJ:C,JtWdy:H,Chi_sq:v,y_hat:g,J:a}}};t.exports=e},function(t,i,o){"use strict";t.exports=o(10),t.exports.Decompositions=t.exports.DC=o(11)},function(t,i){"use strict";function o(t){for(var i=0,o=t.length,n=new Array(o);o>i;i++)n[i]=t[i];return n}function n(t,i){var r,e,s=0;if(Array.isArray(t)){if(e=i,r=e?o(t):t,t=r.length,i=r[0].length,"undefined"==typeof i)throw new TypeError("Data must be a 2D array");if(!(t>0&&i>0))throw new RangeError("Invalid dimensions: "+t+"x"+i);for(;t>s;s++){if(r[s].length!==i)throw new RangeError("Inconsistent array dimensions");e&&(r[s]=o(r[s]))}}else{if("number"!=typeof t)throw new TypeError("Invalid arguments");if(!(t>0&&i>0))throw new RangeError("Invalid dimensions: "+t+"x"+i);for(r=new Array(t);t>s;s++)r[s]=new Array(i)}return Object.defineProperty(r,"rows",{writable:!0,value:t}),Object.defineProperty(r,"columns",{writable:!0,value:i}),r.__proto__=n.prototype,r}var r=Array.prototype.splice,e=Array.prototype.concat;n.from1DArray=function(t,i,o){var r,e,s=0;if(r=t*i,r!==o.length)throw new RangeError("Data length does not match given dimensions");for(e=new Array(t);t>s;s++)e[s]=o.slice(s*i,(s+1)*i);return new n(e)},n.rowVector=function(t){return new n([t])},n.columnVector=function(t){for(var i=t.length,o=new Array(i),r=0;i>r;r++)o[r]=[t[r]];return new n(o)},n.empty=function(t,i){return new n(t,i)},n.zeros=function(t,i){return n.empty(t,i).fill(0)},n.ones=function(t,i){return n.empty(t,i).fill(1)},n.rand=function(t,i){for(var o=n.empty(t,i),r=0,e=o.rows;e>r;r++)for(var s=0,a=o.columns;a>s;s++)o[r][s]=Math.random();return o},n.eye=function(t){for(var i=n.zeros(t,t),o=i.rows,r=0;o>r;r++)i[r][r]=1;return i},n.diag=function(t){for(var i=t.length,o=n.zeros(i,i),r=0;i>r;r++)o[r][r]=t[r];return o},n.indices=function(t,i){for(var o=new Array(i-t),n=0;n<o.length;n++)o[n]=t++;return o},n.stack=function(t){var i,o,r;if(n.isMatrix(t)){var e=0,s=0;for(i=0;i<arguments.length;i++)e+=arguments[i].rows,arguments[i].columns>s&&(s=arguments[i].columns);var a=n.zeros(e,s),l=0;for(i=0;i<arguments.length;i++){var u=arguments[i];for(o=0;o<u.rows;o++){for(r=0;r<u.columns;r++)a[l][r]=u[o][r];l++}}return a}if(Array.isArray(t)){var h=n.empty(arguments.length,t.length);for(i=0;i<arguments.length;i++)h.setRow(i,arguments[i]);return h}},n.expand=function(t,i){for(var o=[],r=0;r<i.length;r++)for(var e=0;e<i[r];e++)o.push(t[r]);return new n(o)},n.checkMatrix=function(t){if(!t)throw new TypeError("Argument has to be a matrix");return"Matrix"!==t.klass&&(t=new n(t)),t},n.isMatrix=function(t){return t?"Matrix"===t.klass:!1},Object.defineProperty(n.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(n.prototype,"size",{get:function(){return this.rows*this.columns}}),n.prototype.checkRowIndex=function(t){if(0>t||t>this.rows-1)throw new RangeError("Row index out of range.")},n.prototype.checkColumnIndex=function(t){if(0>t||t>this.columns-1)throw new RangeError("Column index out of range.")},n.prototype.checkDimensions=function(t){if(this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal.")},n.prototype.apply=function(t){for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)t.call(this,n,r);return this},n.prototype.clone=function(){return new n(this.to2DArray())},n.prototype.to1DArray=function(){return e.apply([],this)},n.prototype.to2DArray=function(){for(var t=this.rows,i=new Array(t),n=0;t>n;n++)i[n]=o(this[n]);return i},n.prototype.isRowVector=function(){return 1===this.rows},n.prototype.isColumnVector=function(){return 1===this.columns},n.prototype.isVector=function(){return 1===this.rows||1===this.columns},n.prototype.isSquare=function(){return this.rows===this.columns},n.prototype.isSymmetric=function(){if(this.isSquare()){for(var t=this.rows,i=0;t>i;i++)for(var o=0;i>=o;o++)if(this[i][o]!==this[o][i])return!1;return!0}return!1},n.prototype.set=function(t,i,o){return this[t][i]=o,this},n.prototype.get=function(t,i){return this[t][i]},n.prototype.fill=function(t){for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]=t;return this},n.prototype.neg=function(){return this.mulS(-1)},n.prototype.add=function(t){return"number"==typeof t?this.addS(t):(t=n.checkMatrix(t),this.addM(t))},n.prototype.addS=function(t){for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]+=t;return this},n.prototype.addM=function(t){this.checkDimensions(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]+=t[n][r];return this},n.prototype.sub=function(t){return"number"==typeof t?this.subS(t):(t=n.checkMatrix(t),this.subM(t))},n.prototype.subS=function(t){for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]-=t;return this},n.prototype.subM=function(t){this.checkDimensions(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]-=t[n][r];return this},n.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):(t=n.checkMatrix(t),this.mulM(t))},n.prototype.mulS=function(t){for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]*=t;return this},n.prototype.mulM=function(t){this.checkDimensions(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]*=t[n][r];return this},n.prototype.div=function(t){return"number"==typeof t?this.divS(t):(t=n.checkMatrix(t),this.divM(t))},n.prototype.divS=function(t){for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]/=t;return this},n.prototype.divM=function(t){this.checkDimensions(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]/=t[n][r];return this},n.prototype.getRow=function(t){return this.checkRowIndex(t),o(this[t])},n.prototype.getRowVector=function(t){return n.rowVector(this.getRow(t))},n.prototype.setRow=function(t,i){if(this.checkRowIndex(t),n.isMatrix(i)&&(i=i.to1DArray()),i.length!==this.columns)throw new RangeError("Invalid row size");return this[t]=o(i),this},n.prototype.removeRow=function(t){if(this.checkRowIndex(t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return r.call(this,t,1),this.rows-=1,this},n.prototype.addRow=function(t,i){if("undefined"==typeof i&&(i=t,t=this.rows),0>t||t>this.rows)throw new RangeError("Row index out of range.");if(n.isMatrix(i)&&(i=i.to1DArray()),i.length!==this.columns)throw new RangeError("Invalid row size");return r.call(this,t,0,o(i)),this.rows+=1,this},n.prototype.swapRows=function(t,i){this.checkRowIndex(t),this.checkRowIndex(i);var o=this[t];return this[t]=this[i],this[i]=o,this},n.prototype.getColumn=function(t){this.checkColumnIndex(t);for(var i=this.rows,o=new Array(i),n=0;i>n;n++)o[n]=this[n][t];return o},n.prototype.getColumnVector=function(t){return n.columnVector(this.getColumn(t))},n.prototype.setColumn=function(t,i){this.checkColumnIndex(t),n.isMatrix(i)&&(i=i.to1DArray());var o=this.rows;if(i.length!==o)throw new RangeError("Invalid column size");for(var r=0;o>r;r++)this[r][t]=i[r];return this},n.prototype.removeColumn=function(t){if(this.checkColumnIndex(t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var i=0,o=this.rows;o>i;i++)this[i].splice(t,1);return this.columns-=1,this},n.prototype.addColumn=function(t,i){if("undefined"==typeof i&&(i=t,t=this.columns),0>t||t>this.columns)throw new RangeError("Column index out of range.");n.isMatrix(i)&&(i=i.to1DArray());var o=this.rows;if(i.length!==o)throw new RangeError("Invalid column size");for(var r=0;o>r;r++)this[r].splice(t,0,i[r]);return this.columns+=1,this},n.prototype.swapColumns=function(t,i){this.checkRowIndex(t),this.checkRowIndex(i);for(var o,n,r=this.rows,e=0;r>e;e++)n=this[e],o=n[t],n[t]=n[i],n[i]=o;return this},n.prototype.checkRowVector=function(t){if(n.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return t},n.prototype.checkColumnVector=function(t){if(n.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return t},n.prototype.addRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]+=t[r];return this},n.prototype.subRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]-=t[r];return this},n.prototype.mulRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]*=t[r];return this},n.prototype.divRowVector=function(t){t=this.checkRowVector(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]/=t[r];return this},n.prototype.addColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]+=t[n];return this},n.prototype.subColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]-=t[n];return this},n.prototype.mulColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]*=t[n];return this},n.prototype.divColumnVector=function(t){t=this.checkColumnVector(t);for(var i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]/=t[n];return this},n.prototype.mulRow=function(t,i){this.checkRowIndex(t);for(var o=0,n=this.columns;n>o;o++)this[t][o]*=i;return this},n.prototype.mulColumn=function(t,i){this.checkColumnIndex(t);for(var o=0,n=this.rows;n>o;o++)this[o][t]*=i},n.prototype.max=function(){for(var t=-(1/0),i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]>t&&(t=this[n][r]);return t},n.prototype.maxIndex=function(){for(var t=-(1/0),i={},o=this.rows,n=this.columns,r=0;o>r;r++)for(var e=0;n>e;e++)this[r][e]>t&&(t=this[r][e],i.row=r,i.column=e);return i},n.prototype.min=function(){for(var t=1/0,i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)this[n][r]<t&&(t=this[n][r]);return t},n.prototype.minIndex=function(){for(var t=1/0,i={},o=this.rows,n=this.columns,r=0;o>r;r++)for(var e=0;n>e;e++)this[r][e]<t&&(t=this[r][e],i.row=r,i.column=e);return i},n.prototype.maxRow=function(t){this.checkRowIndex(t);for(var i=-(1/0),o=0,n=this.columns;n>o;o++)this[t][o]>i&&(i=this[t][o]);return i},n.prototype.maxRowIndex=function(t){this.checkRowIndex(t);for(var i=-(1/0),o={row:t},n=0,r=this.columns;r>n;n++)this[t][n]>i&&(i=this[t][n],o.column=n);return o},n.prototype.minRow=function(t){this.checkRowIndex(t);for(var i=1/0,o=0,n=this.columns;n>o;o++)this[t][o]<i&&(i=this[t][o]);return i},n.prototype.minRowIndex=function(t){this.checkRowIndex(t);for(var i=1/0,o={row:t,column:0},n=0,r=this.columns;r>n;n++)this[t][n]<i&&(i=this[t][n],o.column=n);return o},n.prototype.maxColumn=function(t){this.checkColumnIndex(t);for(var i=-(1/0),o=0,n=this.rows;n>o;o++)this[o][t]>i&&(i=this[o][t]);return i},n.prototype.maxColumnIndex=function(t){this.checkColumnIndex(t);for(var i=-(1/0),o={row:0,column:t},n=0,r=this.rows;r>n;n++)this[n][t]>i&&(i=this[n][t],o.row=n);return o},n.prototype.minColumn=function(t){this.checkColumnIndex(t);for(var i=1/0,o=0,n=this.rows;n>o;o++)this[o][t]<i&&(i=this[o][t]);return i},n.prototype.minColumnIndex=function(t){this.checkColumnIndex(t);for(var i=1/0,o={row:0,column:t},n=0,r=this.rows;r>n;n++)this[n][t]<i&&(i=this[n][t],o.row=n);return o},n.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),t=0,i=this.rows;i>t;t++)s[t]=this[t][t];return s},n.prototype.sum=function(){for(var t=0,i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)t+=this[n][r];return t},n.prototype.mean=function(){return this.sum()/this.size},n.prototype.prod=function a(){for(var a=1,t=this.rows,i=this.columns,o=0;t>o;o++)for(var n=0;i>n;n++)a*=this[o][n];return a},n.prototype.cumulativeSum=function(){for(var t=0,i=this.rows,o=this.columns,n=0;i>n;n++)for(var r=0;o>r;r++)t+=this[n][r],this[n][r]=t;return this},n.prototype.dot=function l(t){if(this.size!==t.size)throw new RangeError("vectors do not have the same size");for(var i=this.to1DArray(),o=t.to1DArray(),l=0,n=i.length,r=0;n>r;r++)l+=i[r]*o[r];return l},n.prototype.mmul=function(t){if(!n.isMatrix(t))throw new TypeError('parameter "other" must be a matrix');this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var i,o,r,e=this.rows,s=this.columns,a=t.columns,l=new n(e,a),u=new Array(s);for(o=0;a>o;o++){for(r=0;s>r;r++)u[r]=t[r][o];for(i=0;e>i;i++){var h=this[i],p=0;for(r=0;s>r;r++)p+=h[r]*u[r];l[i][o]=p}}return l},n.prototype.sortRows=function(t){for(var i=0,o=this.rows;o>i;i++)this[i].sort(t);return this},n.prototype.sortColumns=function(t){for(var i=0,o=this.columns;o>i;i++)this.setColumn(i,this.getColumn(i).sort(t));return this},n.prototype.transpose=function(){for(var t=new n(this.columns,this.rows),i=this.rows,o=this.columns,r=0;i>r;r++)for(var e=0;o>e;e++)t[e][r]=this[r][e];return t},n.prototype.subMatrix=function(t,i,o,r){if(t>i||o>r||0>t||t>=this.rows||0>i||i>=this.rows||0>o||o>=this.columns||0>r||r>=this.columns)throw new RangeError("Argument out of range");for(var e=new n(i-t+1,r-o+1),s=t;i>=s;s++)for(var a=o;r>=a;a++)e[s-t][a-o]=this[s][a];return e},n.prototype.subMatrixRow=function(t,i,o){if("undefined"==typeof i?(i=0,o=this.columns-1):"undefined"==typeof o&&(o=this.columns-1),i>o||0>i||i>=this.columns||0>o||o>=this.columns)throw new RangeError("Argument out of range.");for(var r=t.length,e=this.rows,s=new n(r,o-i+1),a=0;r>a;a++)for(var l=i;o>=l;l++){if(t[a]<0||t[a]>=e)throw new RangeError("Argument out of range.");s[a][l-i]=this[t[a]][l]}return s},n.prototype.subMatrixColumn=function(t,i,o){if("undefined"==typeof i?(i=0,o=this.rows-1):"undefined"==typeof o&&(o=this.rows-1),i>o||0>i||i>=this.rows||0>o||o>=this.rows)throw new RangeError("Argument out of range.");for(var r=t.length,e=this.columns,s=new n(o-i+1,r),a=0;r>a;a++)for(var l=i;o>=l;l++){if(t[a]<0||t[a]>=e)throw new RangeError("Argument out of range.");s[l-i][a]=this[l][t[a]]}return s},n.prototype.trace=function u(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var u=0,t=0,i=this.rows;i>t;t++)u+=this[t][t];return u},n.prototype.abs=function(){for(var t=this.rows,i=this.columns,o=0;t>o;o++)for(var n=0;i>n;n++)this[o][n]=Math.abs(this[o][n])},t.exports=n},function(t,i,o){"use strict";function n(t){return r(t,e.eye(t.rows))}function r(t,i){return t.isSquare()?new l(t).solve(i):new u(t).solve(i)}var e=o(10),s=o(12),a=o(14),l=o(15),u=o(16),h=o(17);e.prototype.inverse=function(){return n(this)},e.prototype.solve=function(t){return r(this,t)},t.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:u,QR:u,CholeskyDecomposition:h,CHO:h,inverse:n,solve:r}},function(t,i,o){"use strict";function n(t,i){if(!(this instanceof n))return new n(t,i);t=r.checkMatrix(t),i=i||{};var o=t.clone(),s=t.rows,a=t.columns,l=Math.min(s,a),u=!0,h=!0;i.computeLeftSingularVectors===!1&&(u=!1),i.computeRightSingularVectors===!1&&(h=!1);var p=i.autoTranspose===!0,f=!1;if(a>s)if(p){o=o.transpose(),s=o.rows,a=o.columns,f=!0;var c=u;u=h,h=c}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var m,g,y,v,d,C,H,w,b,M,x,A,k,D,S,X,Y,O,_,E,P,F=new Array(Math.min(s+1,a)),R=r.zeros(s,l),N=r.zeros(a,a),T=new Array(a),q=new Array(s),I=Math.min(s-1,a),j=Math.max(0,Math.min(a-2,s));for(y=0,M=Math.max(I,j);M>y;y++){if(I>y){for(F[y]=0,m=y;s>m;m++)F[y]=e(F[y],o[m][y]);if(0!==F[y]){for(o[y][y]<0&&(F[y]=-F[y]),m=y;s>m;m++)o[m][y]/=F[y];o[y][y]+=1}F[y]=-F[y]}for(g=y+1;a>g;g++){if(I>y&&0!==F[y]){for(d=0,m=y;s>m;m++)d+=o[m][y]*o[m][g];for(d=-d/o[y][y],m=y;s>m;m++)o[m][g]+=d*o[m][y]}T[g]=o[y][g]}if(u&&I>y)for(m=y;s>m;m++)R[m][y]=o[m][y];if(j>y){for(T[y]=0,m=y+1;a>m;m++)T[y]=e(T[y],T[m]);if(0!==T[y]){for(T[y+1]<0&&(T[y]=-T[y]),m=y+1;a>m;m++)T[m]/=T[y];T[y+1]+=1}if(T[y]=-T[y],s>y+1&&0!==T[y]){for(m=y+1;s>m;m++)q[m]=0;for(g=y+1;a>g;g++)for(m=y+1;s>m;m++)q[m]+=T[g]*o[m][g];for(g=y+1;a>g;g++)for(d=-T[g]/T[y+1],m=y+1;s>m;m++)o[m][g]+=d*q[m]}if(h)for(m=y+1;a>m;m++)N[m][y]=T[m]}}if(v=Math.min(a,s+1),a>I&&(F[I]=o[I][I]),v>s&&(F[v-1]=0),v>j+1&&(T[j]=o[j][v-1]),T[v-1]=0,u){for(g=I;l>g;g++){for(m=0;s>m;m++)R[m][g]=0;R[g][g]=1}for(y=I-1;y>=0;y--)if(0!==F[y]){for(g=y+1;l>g;g++){for(d=0,m=y;s>m;m++)d+=R[m][y]*R[m][g];for(d=-d/R[y][y],m=y;s>m;m++)R[m][g]+=d*R[m][y]}for(m=y;s>m;m++)R[m][y]=-R[m][y];for(R[y][y]=1+R[y][y],m=0;y-1>m;m++)R[m][y]=0}else{for(m=0;s>m;m++)R[m][y]=0;R[y][y]=1}}if(h)for(y=a-1;y>=0;y--){if(j>y&&0!==T[y])for(g=y+1;a>g;g++){for(d=0,m=y+1;a>m;m++)d+=N[m][y]*N[m][g];for(d=-d/N[y+1][y],m=y+1;a>m;m++)N[m][g]+=d*N[m][y]}for(m=0;a>m;m++)N[m][y]=0;N[y][y]=1}for(var z=v-1,V=0,U=Math.pow(2,-52);v>0;){for(y=v-2;y>=-1&&-1!==y;y--)if(Math.abs(T[y])<=U*(Math.abs(F[y])+Math.abs(F[y+1]))){T[y]=0;break}if(y===v-2)x=4;else{for(C=v-1;C>=y&&C!==y;C--)if(d=(C!==v?Math.abs(T[C]):0)+(C!==y+1?Math.abs(T[C-1]):0),Math.abs(F[C])<=U*d){F[C]=0;break}C===y?x=3:C===v-1?x=1:(x=2,y=C)}switch(y++,x){case 1:for(H=T[v-2],T[v-2]=0,g=v-2;g>=y;g--)if(d=e(F[g],H),w=F[g]/d,b=H/d,F[g]=d,g!==y&&(H=-b*T[g-1],T[g-1]=w*T[g-1]),h)for(m=0;a>m;m++)d=w*N[m][g]+b*N[m][v-1],N[m][v-1]=-b*N[m][g]+w*N[m][v-1],N[m][g]=d;break;case 2:for(H=T[y-1],T[y-1]=0,g=y;v>g;g++)if(d=e(F[g],H),w=F[g]/d,b=H/d,F[g]=d,H=-b*T[g],T[g]=w*T[g],u)for(m=0;s>m;m++)d=w*R[m][g]+b*R[m][y-1],R[m][y-1]=-b*R[m][g]+w*R[m][y-1],R[m][g]=d;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(F[v-1]),Math.abs(F[v-2])),Math.abs(T[v-2])),Math.abs(F[y])),Math.abs(T[y])),k=F[v-1]/A,D=F[v-2]/A,S=T[v-2]/A,X=F[y]/A,Y=T[y]/A,O=((D+k)*(D-k)+S*S)/2,_=k*S*(k*S),E=0,(0!==O||0!==_)&&(E=Math.sqrt(O*O+_),0>O&&(E=-E),E=_/(O+E)),H=(X+k)*(X-k)+E,P=X*Y,g=y;v-1>g;g++){if(d=e(H,P),w=H/d,b=P/d,g!==y&&(T[g-1]=d),H=w*F[g]+b*T[g],T[g]=w*T[g]-b*F[g],P=b*F[g+1],F[g+1]=w*F[g+1],h)for(m=0;a>m;m++)d=w*N[m][g]+b*N[m][g+1],N[m][g+1]=-b*N[m][g]+w*N[m][g+1],N[m][g]=d;if(d=e(H,P),w=H/d,b=P/d,F[g]=d,H=w*T[g]+b*F[g+1],F[g+1]=-b*T[g]+w*F[g+1],P=b*T[g+1],T[g+1]=w*T[g+1],u&&s-1>g)for(m=0;s>m;m++)d=w*R[m][g]+b*R[m][g+1],R[m][g+1]=-b*R[m][g]+w*R[m][g+1],R[m][g]=d}T[v-2]=H,V+=1;break;case 4:if(F[y]<=0&&(F[y]=F[y]<0?-F[y]:0,h))for(m=0;z>=m;m++)N[m][y]=-N[m][y];for(;z>y&&!(F[y]>=F[y+1]);){if(d=F[y],F[y]=F[y+1],F[y+1]=d,h&&a-1>y)for(m=0;a>m;m++)d=N[m][y+1],N[m][y+1]=N[m][y],N[m][y]=d;if(u&&s-1>y)for(m=0;s>m;m++)d=R[m][y+1],R[m][y+1]=R[m][y],R[m][y]=d;y++}V=0,v--}}if(f){var L=N;N=R,R=L}this.m=s,this.n=a,this.s=F,this.U=R,this.V=N}var r=o(10),e=o(13).hypotenuse;n.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),i=Math.max(this.m,this.n)*this.s[0]*t,o=0,n=this.s,r=0,e=n.length;e>r;r++)n[r]>i&&o++;return o},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return r.diag(this.s)},solve:function(t){var i,o=t,n=this.threshold,e=this.s.length,s=r.zeros(e,e);for(i=0;e>i;i++)Math.abs(this.s[i])<=n?s[i][i]=0:s[i][i]=1/this.s[i];var a,l,u,h=this.V.mmul(s),p=this.V.rows,f=this.U.rows,c=r.zeros(p,f);for(i=0;p>i;i++)for(a=0;f>a;a++){for(u=0,l=0;e>l;l++)u+=h[i][l]*this.U[a][l];c[i][a]=u}return c.mmul(o)},solveForDiagonal:function(t){return this.solve(r.diag(t))},inverse:function(){var t,i,o=this.threshold,n=this.V.rows,e=this.V.columns,s=new r(n,this.s.length);for(t=0;n>t;t++)for(i=0;e>i;i++)Math.abs(this.s[i])>o?s[t][i]=this.V[t][i]/this.s[i]:s[t][i]=0;var a,l,u=this.U.rows,h=this.U.columns,p=new r(n,u);for(t=0;n>t;t++)for(i=0;u>i;i++){for(l=0,a=0;h>a;a++)l+=s[t][a]*this.U[i][a];p[t][i]=l}return p}},t.exports=n},function(t,i){"use strict";i.hypotenuse=function(t,i){var o;return Math.abs(t)>Math.abs(i)?(o=i/t,Math.abs(t)*Math.sqrt(1+o*o)):0!==i?(o=t/i,Math.abs(i)*Math.sqrt(1+o*o)):0;
}},function(t,i,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);if(t=u.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");var i,o,l=t.columns,h=u.zeros(l,l),p=new Array(l),f=new Array(l),c=t;if(t.isSymmetric()){for(i=0;l>i;i++)for(o=0;l>o;o++)h[i][o]=c[i][o];r(l,f,p,h),e(l,f,p,h)}else{var m=u.zeros(l,l),g=new Array(l);for(o=0;l>o;o++)for(i=0;l>i;i++)m[i][o]=c[i][o];s(l,m,g,h),a(l,f,p,h,m)}this.n=l,this.e=f,this.d=p,this.V=h}function r(t,i,o,n){var r,e,s,a,l,u,h,p;for(l=0;t>l;l++)o[l]=n[t-1][l];for(a=t-1;a>0;a--){for(p=0,s=0,u=0;a>u;u++)p+=Math.abs(o[u]);if(0===p)for(i[a]=o[a-1],l=0;a>l;l++)o[l]=n[a-1][l],n[a][l]=0,n[l][a]=0;else{for(u=0;a>u;u++)o[u]/=p,s+=o[u]*o[u];for(r=o[a-1],e=Math.sqrt(s),r>0&&(e=-e),i[a]=p*e,s-=r*e,o[a-1]=r-e,l=0;a>l;l++)i[l]=0;for(l=0;a>l;l++){for(r=o[l],n[l][a]=r,e=i[l]+n[l][l]*r,u=l+1;a-1>=u;u++)e+=n[u][l]*o[u],i[u]+=n[u][l]*r;i[l]=e}for(r=0,l=0;a>l;l++)i[l]/=s,r+=i[l]*o[l];for(h=r/(s+s),l=0;a>l;l++)i[l]-=h*o[l];for(l=0;a>l;l++){for(r=o[l],e=i[l],u=l;a-1>=u;u++)n[u][l]-=r*i[u]+e*o[u];o[l]=n[a-1][l],n[a][l]=0}}o[a]=s}for(a=0;t-1>a;a++){if(n[t-1][a]=n[a][a],n[a][a]=1,s=o[a+1],0!==s){for(u=0;a>=u;u++)o[u]=n[u][a+1]/s;for(l=0;a>=l;l++){for(e=0,u=0;a>=u;u++)e+=n[u][a+1]*n[u][l];for(u=0;a>=u;u++)n[u][l]-=e*o[u]}}for(u=0;a>=u;u++)n[u][a+1]=0}for(l=0;t>l;l++)o[l]=n[t-1][l],n[t-1][l]=0;n[t-1][t-1]=1,i[0]=0}function e(t,i,o,n){var r,e,s,a,l,u,p,f,c,m,g,y,v,d,C,H,w;for(s=1;t>s;s++)i[s-1]=i[s];i[t-1]=0;var b=0,M=0,x=Math.pow(2,-52);for(u=0;t>u;u++){for(M=Math.max(M,Math.abs(o[u])+Math.abs(i[u])),p=u;t>p&&!(Math.abs(i[p])<=x*M);)p++;if(p>u){w=0;do{for(w+=1,r=o[u],f=(o[u+1]-r)/(2*i[u]),c=h(f,1),0>f&&(c=-c),o[u]=i[u]/(f+c),o[u+1]=i[u]*(f+c),m=o[u+1],e=r-o[u],s=u+2;t>s;s++)o[s]-=e;for(b+=e,f=o[p],g=1,y=g,v=g,d=i[u+1],C=0,H=0,s=p-1;s>=u;s--)for(v=y,y=g,H=C,r=g*i[s],e=g*f,c=h(f,i[s]),i[s+1]=C*c,C=i[s]/c,g=f/c,f=g*o[s]-C*r,o[s+1]=e+C*(g*r+C*o[s]),l=0;t>l;l++)e=n[l][s+1],n[l][s+1]=C*n[l][s]+g*e,n[l][s]=g*n[l][s]-C*e;f=-C*H*v*d*i[u]/m,i[u]=C*f,o[u]=g*f}while(Math.abs(i[u])>x*M)}o[u]=o[u]+b,i[u]=0}for(s=0;t-1>s;s++){for(l=s,f=o[s],a=s+1;t>a;a++)o[a]<f&&(l=a,f=o[a]);if(l!==s)for(o[l]=o[s],o[s]=f,a=0;t>a;a++)f=n[a][s],n[a][s]=n[a][l],n[a][l]=f}}function s(t,i,o,n){var r,e,s,a,l,u,h,p=0,f=t-1;for(u=p+1;f-1>=u;u++){for(h=0,a=u;f>=a;a++)h+=Math.abs(i[a][u-1]);if(0!==h){for(s=0,a=f;a>=u;a--)o[a]=i[a][u-1]/h,s+=o[a]*o[a];for(e=Math.sqrt(s),o[u]>0&&(e=-e),s-=o[u]*e,o[u]=o[u]-e,l=u;t>l;l++){for(r=0,a=f;a>=u;a--)r+=o[a]*i[a][l];for(r/=s,a=u;f>=a;a++)i[a][l]-=r*o[a]}for(a=0;f>=a;a++){for(r=0,l=f;l>=u;l--)r+=o[l]*i[a][l];for(r/=s,l=u;f>=l;l++)i[a][l]-=r*o[l]}o[u]=h*o[u],i[u][u-1]=h*e}}for(a=0;t>a;a++)for(l=0;t>l;l++)n[a][l]=a===l?1:0;for(u=f-1;u>=p+1;u--)if(0!==i[u][u-1]){for(a=u+1;f>=a;a++)o[a]=i[a][u-1];for(l=u;f>=l;l++){for(e=0,a=u;f>=a;a++)e+=o[a]*n[a][l];for(e=e/o[u]/i[u][u-1],a=u;f>=a;a++)n[a][l]+=e*o[a]}}}function a(t,i,o,n,r){var e,s,a,u,h,p,f,c,m,g,y,v,d,C,H,w=t-1,b=0,M=t-1,x=Math.pow(2,-52),A=0,k=0,D=0,S=0,X=0,Y=0,O=0,_=0;for(e=0;t>e;e++)for((b>e||e>M)&&(o[e]=r[e][e],i[e]=0),s=Math.max(e-1,0);t>s;s++)k+=Math.abs(r[e][s]);for(;w>=b;){for(u=w;u>b&&(Y=Math.abs(r[u-1][u-1])+Math.abs(r[u][u]),0===Y&&(Y=k),!(Math.abs(r[u][u-1])<x*Y));)u--;if(u===w)r[w][w]=r[w][w]+A,o[w]=r[w][w],i[w]=0,w--,_=0;else if(u===w-1){if(f=r[w][w-1]*r[w-1][w],D=(r[w-1][w-1]-r[w][w])/2,S=D*D+f,O=Math.sqrt(Math.abs(S)),r[w][w]=r[w][w]+A,r[w-1][w-1]=r[w-1][w-1]+A,c=r[w][w],S>=0){for(O=D>=0?D+O:D-O,o[w-1]=c+O,o[w]=o[w-1],0!==O&&(o[w]=c-f/O),i[w-1]=0,i[w]=0,c=r[w][w-1],Y=Math.abs(c)+Math.abs(O),D=c/Y,S=O/Y,X=Math.sqrt(D*D+S*S),D/=X,S/=X,s=w-1;t>s;s++)O=r[w-1][s],r[w-1][s]=S*O+D*r[w][s],r[w][s]=S*r[w][s]-D*O;for(e=0;w>=e;e++)O=r[e][w-1],r[e][w-1]=S*O+D*r[e][w],r[e][w]=S*r[e][w]-D*O;for(e=b;M>=e;e++)O=n[e][w-1],n[e][w-1]=S*O+D*n[e][w],n[e][w]=S*n[e][w]-D*O}else o[w-1]=c+D,o[w]=c+D,i[w-1]=O,i[w]=-O;w-=2,_=0}else{if(c=r[w][w],m=0,f=0,w>u&&(m=r[w-1][w-1],f=r[w][w-1]*r[w-1][w]),10===_){for(A+=c,e=b;w>=e;e++)r[e][e]-=c;Y=Math.abs(r[w][w-1])+Math.abs(r[w-1][w-2]),c=m=.75*Y,f=-.4375*Y*Y}if(30===_&&(Y=(m-c)/2,Y=Y*Y+f,Y>0)){for(Y=Math.sqrt(Y),c>m&&(Y=-Y),Y=c-f/((m-c)/2+Y),e=b;w>=e;e++)r[e][e]-=Y;A+=Y,c=m=f=.964}for(_+=1,h=w-2;h>=u&&(O=r[h][h],X=c-O,Y=m-O,D=(X*Y-f)/r[h+1][h]+r[h][h+1],S=r[h+1][h+1]-O-X-Y,X=r[h+2][h+1],Y=Math.abs(D)+Math.abs(S)+Math.abs(X),D/=Y,S/=Y,X/=Y,h!==u)&&!(Math.abs(r[h][h-1])*(Math.abs(S)+Math.abs(X))<x*(Math.abs(D)*(Math.abs(r[h-1][h-1])+Math.abs(O)+Math.abs(r[h+1][h+1]))));)h--;for(e=h+2;w>=e;e++)r[e][e-2]=0,e>h+2&&(r[e][e-3]=0);for(a=h;w-1>=a&&(C=a!==w-1,a!==h&&(D=r[a][a-1],S=r[a+1][a-1],X=C?r[a+2][a-1]:0,c=Math.abs(D)+Math.abs(S)+Math.abs(X),0!==c&&(D/=c,S/=c,X/=c)),0!==c);a++)if(Y=Math.sqrt(D*D+S*S+X*X),0>D&&(Y=-Y),0!==Y){for(a!==h?r[a][a-1]=-Y*c:u!==h&&(r[a][a-1]=-r[a][a-1]),D+=Y,c=D/Y,m=S/Y,O=X/Y,S/=D,X/=D,s=a;t>s;s++)D=r[a][s]+S*r[a+1][s],C&&(D+=X*r[a+2][s],r[a+2][s]=r[a+2][s]-D*O),r[a][s]=r[a][s]-D*c,r[a+1][s]=r[a+1][s]-D*m;for(e=0;e<=Math.min(w,a+3);e++)D=c*r[e][a]+m*r[e][a+1],C&&(D+=O*r[e][a+2],r[e][a+2]=r[e][a+2]-D*X),r[e][a]=r[e][a]-D,r[e][a+1]=r[e][a+1]-D*S;for(e=b;M>=e;e++)D=c*n[e][a]+m*n[e][a+1],C&&(D+=O*n[e][a+2],n[e][a+2]=n[e][a+2]-D*X),n[e][a]=n[e][a]-D,n[e][a+1]=n[e][a+1]-D*S}}}if(0!==k){for(w=t-1;w>=0;w--)if(D=o[w],S=i[w],0===S)for(u=w,r[w][w]=1,e=w-1;e>=0;e--){for(f=r[e][e]-D,X=0,s=u;w>=s;s++)X+=r[e][s]*r[s][w];if(i[e]<0)O=f,Y=X;else if(u=e,0===i[e]?r[e][w]=0!==f?-X/f:-X/(x*k):(c=r[e][e+1],m=r[e+1][e],S=(o[e]-D)*(o[e]-D)+i[e]*i[e],p=(c*Y-O*X)/S,r[e][w]=p,r[e+1][w]=Math.abs(c)>Math.abs(O)?(-X-f*p)/c:(-Y-m*p)/O),p=Math.abs(r[e][w]),x*p*p>1)for(s=e;w>=s;s++)r[s][w]=r[s][w]/p}else if(0>S)for(u=w-1,Math.abs(r[w][w-1])>Math.abs(r[w-1][w])?(r[w-1][w-1]=S/r[w][w-1],r[w-1][w]=-(r[w][w]-D)/r[w][w-1]):(H=l(0,-r[w-1][w],r[w-1][w-1]-D,S),r[w-1][w-1]=H[0],r[w-1][w]=H[1]),r[w][w-1]=0,r[w][w]=1,e=w-2;e>=0;e--){for(g=0,y=0,s=u;w>=s;s++)g+=r[e][s]*r[s][w-1],y+=r[e][s]*r[s][w];if(f=r[e][e]-D,i[e]<0)O=f,X=g,Y=y;else if(u=e,0===i[e]?(H=l(-g,-y,f,S),r[e][w-1]=H[0],r[e][w]=H[1]):(c=r[e][e+1],m=r[e+1][e],v=(o[e]-D)*(o[e]-D)+i[e]*i[e]-S*S,d=2*(o[e]-D)*S,0===v&&0===d&&(v=x*k*(Math.abs(f)+Math.abs(S)+Math.abs(c)+Math.abs(m)+Math.abs(O))),H=l(c*X-O*g+S*y,c*Y-O*y-S*g,v,d),r[e][w-1]=H[0],r[e][w]=H[1],Math.abs(c)>Math.abs(O)+Math.abs(S)?(r[e+1][w-1]=(-g-f*r[e][w-1]+S*r[e][w])/c,r[e+1][w]=(-y-f*r[e][w]-S*r[e][w-1])/c):(H=l(-X-m*r[e][w-1],-Y-m*r[e][w],O,S),r[e+1][w-1]=H[0],r[e+1][w]=H[1])),p=Math.max(Math.abs(r[e][w-1]),Math.abs(r[e][w])),x*p*p>1)for(s=e;w>=s;s++)r[s][w-1]=r[s][w-1]/p,r[s][w]=r[s][w]/p}for(e=0;t>e;e++)if(b>e||e>M)for(s=e;t>s;s++)n[e][s]=r[e][s];for(s=t-1;s>=b;s--)for(e=b;M>=e;e++){for(O=0,a=b;a<=Math.min(s,M);a++)O+=n[e][a]*r[a][s];n[e][s]=O}}}function l(t,i,o,n){var r,e;return Math.abs(o)>Math.abs(n)?(r=n/o,e=o+r*n,[(t+r*i)/e,(i-r*t)/e]):(r=o/n,e=n+r*o,[(r*t+i)/e,(r*i-t)/e])}var u=o(10),h=o(13).hypotenuse;n.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var t,i,o=this.n,n=this.e,r=this.d,e=new u(o,o);for(t=0;o>t;t++){for(i=0;o>i;i++)e[t][i]=0;e[t][t]=r[t],n[t]>0?e[t][t+1]=n[t]:n[t]<0&&(e[t][t-1]=n[t])}return e}},t.exports=n},function(t,i,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=r.checkMatrix(t);var i,o,e,s,a,l,u,h,p,f,c=t.clone(),m=c.rows,g=c.columns,y=new Array(m),v=1;for(i=0;m>i;i++)y[i]=i;for(p=new Array(m),o=0;g>o;o++){for(i=0;m>i;i++)p[i]=c[i][o];for(i=0;m>i;i++){for(h=c[i],f=Math.min(i,o),a=0,e=0;f>e;e++)a+=h[e]*p[e];h[o]=p[i]-=a}for(s=o,i=o+1;m>i;i++)Math.abs(p[i])>Math.abs(p[s])&&(s=i);if(s!==o){for(e=0;g>e;e++)l=c[s][e],c[s][e]=c[o][e],c[o][e]=l;u=y[s],y[s]=y[o],y[o]=u,v=-v}if(m>o&&0!==c[o][o])for(i=o+1;m>i;i++)c[i][o]/=c[o][o]}this.LU=c,this.pivotVector=y,this.pivotSign=v}var r=o(10);n.prototype={isSingular:function(){for(var t=this.LU,i=t.columns,o=0;i>o;o++)if(0===t[o][o])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var i=this.pivotSign,o=t.columns,n=0;o>n;n++)i*=t[n][n];return i},get lowerTriangularFactor(){for(var t=this.LU,i=t.rows,o=t.columns,n=new r(i,o),e=0;i>e;e++)for(var s=0;o>s;s++)e>s?n[e][s]=t[e][s]:e===s?n[e][s]=1:n[e][s]=0;return n},get upperTriangularFactor(){for(var t=this.LU,i=t.rows,o=t.columns,n=new r(i,o),e=0;i>e;e++)for(var s=0;o>s;s++)s>=e?n[e][s]=t[e][s]:n[e][s]=0;return n},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=r.checkMatrix(t);var i=this.LU,o=i.rows;if(o!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,e,s,a=t.columns,l=t.subMatrixRow(this.pivotVector,0,a-1),u=i.columns;for(s=0;u>s;s++)for(n=s+1;u>n;n++)for(e=0;a>e;e++)l[n][e]-=l[s][e]*i[n][s];for(s=u-1;s>=0;s--){for(e=0;a>e;e++)l[s][e]/=i[s][s];for(n=0;s>n;n++)for(e=0;a>e;e++)l[n][e]-=l[s][e]*i[n][s]}return l}},t.exports=n},function(t,i,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=r.checkMatrix(t);var i,o,s,a,l=t.clone(),u=t.rows,h=t.columns,p=new Array(h);for(s=0;h>s;s++){var f=0;for(i=s;u>i;i++)f=e(f,l[i][s]);if(0!==f){for(l[s][s]<0&&(f=-f),i=s;u>i;i++)l[i][s]/=f;for(l[s][s]+=1,o=s+1;h>o;o++){for(a=0,i=s;u>i;i++)a+=l[i][s]*l[i][o];for(a=-a/l[s][s],i=s;u>i;i++)l[i][o]+=a*l[i][s]}}p[s]=-f}this.QR=l,this.Rdiag=p}var r=o(10),e=o(13).hypotenuse;n.prototype={solve:function(t){t=r.checkMatrix(t);var i=this.QR,o=i.rows;if(t.rows!==o)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,e,s,a,l=t.columns,u=t.clone(),h=i.columns;for(s=0;h>s;s++)for(e=0;l>e;e++){for(a=0,n=s;o>n;n++)a+=i[n][s]*u[n][e];for(a=-a/i[s][s],n=s;o>n;n++)u[n][e]+=a*i[n][s]}for(s=h-1;s>=0;s--){for(e=0;l>e;e++)u[s][e]/=this.Rdiag[s];for(n=0;s>n;n++)for(e=0;l>e;e++)u[n][e]-=u[s][e]*i[n][s]}return u.subMatrix(0,h-1,0,l-1)},isFullRank:function(){for(var t=this.QR.columns,i=0;t>i;i++)if(0===this.Rdiag[i])return!1;return!0},get upperTriangularFactor(){var t,i,o=this.QR,n=o.columns,e=new r(n,n);for(t=0;n>t;t++)for(i=0;n>i;i++)i>t?e[t][i]=o[t][i]:t===i?e[t][i]=this.Rdiag[t]:e[t][i]=0;return e},get orthogonalFactor(){var t,i,o,n,e=this.QR,s=e.rows,a=e.columns,l=new r(s,a);for(o=a-1;o>=0;o--){for(t=0;s>t;t++)l[t][o]=0;for(l[o][o]=1,i=o;a>i;i++)if(0!==e[o][o]){for(n=0,t=o;s>t;t++)n+=e[t][o]*l[t][i];for(n=-n/e[o][o],t=o;s>t;t++)l[t][i]+=n*e[t][o]}}return l}},t.exports=n},function(t,i,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);if(t=r.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");var i,o,e,s=t,a=s.rows,l=new r(a,a),u=!0;for(o=0;a>o;o++){var h=l[o],p=0;for(e=0;o>e;e++){var f=l[e],c=0;for(i=0;e>i;i++)c+=f[i]*h[i];h[e]=c=(s[o][e]-c)/l[e][e],p+=c*c}for(p=s[o][o]-p,u&=p>0,l[o][o]=Math.sqrt(Math.max(p,0)),e=o+1;a>e;e++)l[o][e]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=l}var r=o(10);n.prototype={get leftTriangularFactor(){return this.L},solve:function(t){t=r.checkMatrix(t);var i=this.L,o=i.rows;if(t.rows!==o)throw new Error("Matrix dimensions do not match");var n,e,s,a=t.columns,l=t.clone();for(s=0;o>s;s++)for(e=0;a>e;e++){for(n=0;s>n;n++)l[s][e]-=l[n][e]*i[s][n];l[s][e]/=i[s][s]}for(s=o-1;s>=0;s--)for(e=0;a>e;e++){for(n=s+1;o>n;n++)l[s][e]-=l[n][e]*i[n][s];l[s][e]/=i[s][s]}return l}},t.exports=n},function(t,i,o){"use strict";function n(t){if("number"==typeof t)return t;var i=t.clone();return i.transpose()}function r(t,i){if("number"==typeof t&&"number"==typeof i)return t+i;if("number"==typeof t)return this.add(i,t);var o=t.clone();return o.add(i)}function e(t,i){if("number"==typeof t&&"number"==typeof i)return t-i;if("number"==typeof t)return this.subtract(i,t);var o=t.clone();return o.sub(i)}function s(t,i){if("number"==typeof t&&"number"==typeof i)return t*i;if("number"==typeof t)return this.multiply(i,t);var o=t.clone();return"number"==typeof i?o.mul(i):o=o.mmul(i),1==o.rows&&1==o.columns?o[0][0]:o}function a(t,i){var o=t.clone();return o.mul(i)}function l(t,i){var o=t.clone();return o.div(i)}function u(t){var i,o,n=null,r=t.rows,e=t.columns;if("undefined"==typeof e&&"object"==typeof t)if(t[0]&&t[0].length)for(r=t.length,e=t[0].length,o=Math.min(r,e),n=new d.zeros(e,e),i=0;e>i;i++)n[i][i]=t[i][i];else for(e=t.length,n=new d.zeros(e,e),i=0;e>i;i++)n[i][i]=t[i];if(1==r)for(n=new d.zeros(e,e),i=0;e>i;i++)n[i][i]=t[0][i];else if(r>0&&e>0)for(o=Math.min(r,e),n=new Array(o),i=0;o>i;i++)n[i]=t[i][i];return n}function h(t,i){if("number"==typeof t&&"number"==typeof i)return Math.min(t,i);for(var o=t.rows,n=t.columns,r=new d(o,n),e=0;o>e;e++)for(var s=0;n>s;s++)t[e][s]<i[e][s]?r[e][s]=t[e][s]:r[e][s]=i[e][s];return r}function p(t,i){if("number"==typeof t&&"number"==typeof i)return Math.max(t,i);for(var o=t.rows,n=t.columns,r=new d(o,n),e=0;o>e;e++)for(var s=0;n>s;s++)t[e][s]>i[e][s]?r[e][s]=t[e][s]:r[e][s]=i[e][s];return r}function f(t){if("number"==typeof t)return Math.sqrt(t);for(var i=t.rows,o=t.columns,n=new d(i,o),r=0;i>r;r++)for(var e=0;o>e;e++)n[r][e]=Math.sqrt(t[r][e]);return n}function c(t){if("number"==typeof t)return Math.abs(t);for(var i=t.rows,o=t.columns,n=new d(i,o),r=0;i>r;r++)for(var e=0;o>e;e++)n[r][e]=Math.abs(t[r][e]);return n}function m(t){if("number"==typeof t)return Math.sqrt(t);for(var i=t.rows,o=t.columns,n=new d(i,o),r=0;i>r;r++)for(var e=0;o>e;e++)n[r][e]=Math.exp(t[r][e]);return n}function g(t,i){if("number"==typeof t)return Math.pow(t,i);for(var o=t.rows,n=t.columns,r=new d(o,n),e=0;o>e;e++)for(var s=0;n>s;s++)r[e][s]=Math.pow(t[e][s],i);return r}function y(t,i){return t.solve(i)}function v(t){return"number"==typeof t?1/t:t.inverse()}var d=o(9);t.exports={transpose:n,add:r,subtract:e,multiply:s,dotMultiply:a,dotDivide:l,diag:u,min:h,max:p,solve:y,inv:v,sqrt:f,exp:m,dotPow:g,abs:c}},function(t,i,o){function n(t){r.call(this,t)}var r=o(1),e=o(20),s=o(3);n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.fromJcamp=function(t,i){i=i||{xy:!0,keepSpectra:!0,keepRecordsRegExp:/^.+$/};var o=s.convert(t,i);return new n(o)},n.prototype.isHomoNuclear=function(){return this.sd.xType==this.sd.yType},n.prototype.observeFrequencyX=function(){return this.sd.spectra[0].observeFrequency},n.prototype.observeFrequencyY=function(){return this.sd.indirectFrequency},n.prototype.getSolventName=function(){return(this.sd.info[".SOLVENTNAME"]||this.sd.info.$SOLVENT).replace("<","").replace(">","")},n.prototype.getXUnits=function(){return this.sd.ntuples[1].units},n.prototype.getYUnits=function(){return this.sd.ntuples[0].units},n.prototype.getZUnits=function(){return this.sd.ntuples[2].units},n.prototype.getLastY=function(){return this.sd.minMax.maxY},n.prototype.getFirstY=function(){return this.sd.minMax.minY},n.prototype.getDeltaY=function(){return(this.getLastY()-this.getFirstY())/(this.getNbSubSpectra()-1)},n.prototype.nmrPeakDetection2D=function(t){t=t||{},t.thresholdFactor||(t.thresholdFactor=1);var i=Math.round(255*Math.random());t.id||(i=t.id);for(var o=e.findPeaks2D(this,t.thresholdFactor),n=0;n<o.length;n++)o[n]._highlight=[i+"_"+n];return o},n.prototype.getNMRPeakThreshold=function(t){return"1H"==t?3:"13C"==t?5:1},n.prototype.getNucleus=function(t){return 1==t?this.sd.xType:2==t?this.sd.yType:this.sd.xType},t.exports=n},function(t,i,o){var n=o(21),r=o(23),e=o(24),s=o(2),a={DEBUG:!1,smallFilter:[[0,0,1,2,2,2,1,0,0],[0,1,4,7,7,7,4,1,0],[1,4,5,3,0,3,5,4,1],[2,7,3,-12,-23,-12,3,7,2],[2,7,0,-23,-40,-23,0,7,2],[2,7,3,-12,-23,-12,3,7,2],[1,4,5,3,0,3,5,4,1],[0,1,3,7,7,7,3,1,0],[0,0,1,2,2,2,1,0,0]],getLoGnStdDevNMR:function(t){return t.isHomoNuclear()?1.5:3},findPeaks2D:function(t,i){0==i&&(i=1),0>i&&(i=-i);for(var o=t.getNbPoints(),n=t.getNbSubSpectra(),e=new Array(o*n),s=t.isHomoNuclear(),a=0;n>a;a++)for(var l=t.getYData(a),u=0;o>u;u++)s?e[a*o+u]=l[u]>0?l[u]:0:e[a*o+u]=Math.abs(l[u]);var h=this.getLoGnStdDevNMR(t);if(s){for(var p=this.convoluteWithLoG(e,n,o),f=this.findPeaks2DLoG(e,p,n,o,h*i),c=this.findPeaks2DMax(e,p,n,o,(h+.5)*i),m=0;m<f.length;m++)c.push(f[m]);return r.enhanceSymmetry(this.createSignals2D(c,t,24))}var p=this.convoluteWithLoG(e,n,o),f=this.findPeaks2DLoG(e,p,n,o,h*i);return this.createSignals2D(r.clean(f,.05),t,24)},convoluteWithLoG:function(t,i,o){for(var r=new Array(o*i),e=i*o-1;e>=0;e--)r[e]=t[e];r=n.fft2DArray(r,i,o);for(var s=this.smallFilter.length,a=new Array(o*i),e=o*i-1;e>=0;e--)a[e]=0;for(var l,u,h=(s-1)/2,p=0;s>p;p++){l=(p-h+i)%i;for(var f=0;s>f;f++)u=(f-h+o)%o,a[l*o+u]=this.smallFilter[p][f]}a=n.fft2DArray(a,i,o);var c=2*i,m=o/2+1;return n.convolute2DI(r,a,c,m),n.ifft2DArray(r,c,m)},findPeaks2DLoG:function(t,i,o,n,r){for(var e=0,s=n*o-2;s>=0;s--)e+=Math.pow(i[s]-i[s+1],2);e=-Math.sqrt(e),e*=r/o;for(var a=new Array(n*o),s=n*o-1;s>=0;s--)a[s]=0;for(var l=0,s=i.length-1;s>=0;s--)i[s]<e&&(a[s]=1,l++);for(var u=0,h=[];0!=l;){for(u;u<a.length&&0==a[u];u++);if(u==a.length)break;l-=this.extractArea(t,i,a,u,o,n,h,e)}return h.length>0&&this.DEBUG&&console.log("No peak found"),h},findPeaks2DMax:function(t,i,o,n,r){for(var e=0,s=n*o-2;s>=0;s--)e+=Math.pow(i[s]-i[s+1],2);e=-Math.sqrt(e),e*=r/o;for(var a,l,u=[],h=0,s=0;s<i.length;s++)i[s]<e&&(a=Math.floor(s/n),l=s%n,a>0&&o>a+1&&n>l+1&&l>0&&i[s]<i[s+1]&&i[s]<i[s-1]&&(h=(a-1)*n+l,i[s]<i[h-1]&&i[s]<i[h]&&i[s]<i[h+1]&&(h=(a+1)*n+l,i[s]<i[h-1]&&i[s]<i[h]&&i[s]<i[h+1]&&u.push({x:l,y:a,z:t[s]}))));return u},extractArea:function(t,i,o,n,r,e,a,l){var u=Math.floor(n/e),h=n%e,p=[];this.scanBitmask(o,r,e,u,h,p);var f=new Array(p.length),c=new Array(p.length),m=new Array(p.length),g=p.length,y=0,v=0,d=0;if(g>=9){this.DEBUG&&console.log("nValues="+g);for(var C=Number.NEGATIVE_INFINITY,H=-1,w=0;g>w;w++){var b=p.splice(0,1)[0];f[w]=b[0],c[w]=b[1],m[w]=t[b[1]*e+b[0]],y+=f[w]*m[w],v+=c[w]*m[w],d+=m[w],m[w]>C&&(C=m[w],H=w)}if(-1!=H){y/=d,v/=d;var M,x={x:y,y:v,z:d};M=s.minMax(f),x.minX=M.min,x.maxX=M.max,M=s.minMax(c),x.minY=M.min,x.maxY=M.max,a.push(x)}}return g},scanBitmask:function(t,i,o,n,r,e){0>n||0>r||r==o||n==i||t[n*o+r]&&(t[n*o+r]=0,e.push([r,n]),this.scanBitmask(t,i,o,n+1,r,e),this.scanBitmask(t,i,o,n-1,r,e),this.scanBitmask(t,i,o,n,r+1,e),this.scanBitmask(t,i,o,n,r-1,e))},createSignals2D:function(t,i,o){for(var n=[],r=(i.getNbSubSpectra(),i.observeFrequencyX()),s=i.observeFrequencyY(),a=i.getFirstY(),l=(i.getLastY(),i.getDeltaY()),u=t.length-1;u>=0;u--)t[u].x=i.arrayPointToUnits(t[u].x),t[u].y=a+l*t[u].y,(t[u].y<-1||t[u].y>=210)&&t.splice(u,1);var h=[],p=0;o*=o;for(var u=0;u<t.length;u++)for(var f=u;f<t.length;f++)p=Math.pow((t[u].x-t[f].x)*r,2)+Math.pow((t[u].y-t[f].y)*s,2),o>p?h.push(1):h.push(0);var c=e.fullClusterGenerator(h),n=[];if(null!=t)for(var m=0;m<c.length;m++){var g={nucleusX:i.getNucleus(1),nucleusY:i.getNucleus(2)};g.resolutionX=(i.getLastX()-i.getFirstX())/i.getNbPoints(),g.resolutionY=l;var y=[];g.shiftX=0,g.shiftY=0;for(var v=0,d=c[m].length-1;d>=0;d--)1==c[m][d]&&(y.push(t[d]),g.shiftX+=t[d].x*t[d].z,g.shiftY+=t[d].y*t[d].z,v+=t[d].z);g.shiftX/=v,g.shiftY/=v,g.peaks=y,n.push(g)}return n}};t.exports=a},function(t,i,o){var n=o(22),r={DEBUG:!1,ifft2DArray:function(t,i,o){var r=new Array(i*o),e=i/2,s=2*(o-1);n.init(e);for(var a={re:new Array(e),im:new Array(e)},l=0;o>l;l++){for(var u=e-1;u>=0;u--)a.re[u]=t[2*u*o+l],a.im[u]=t[(2*u+1)*o+l];n.bt(a.re,a.im);for(var u=e-1;u>=0;u--)r[2*u*o+l]=a.re[u],r[(2*u+1)*o+l]=a.im[u]}var h=new Array(e*s);n.init(s);for(var p={re:new Array(s),im:new Array(s)},f=s*e,u=0;i>u;u+=2){p.re[0]=r[u*o],p.im[0]=r[(u+1)*o];for(var l=1;o>l;l++)p.re[l]=r[u*o+l],p.im[l]=r[(u+1)*o+l],p.re[s-l]=r[u*o+l],p.im[s-l]=-r[(u+1)*o+l];n.bt(p.re,p.im);for(var c=u/2*s,l=s-1;l>=0;l--)h[c+l]=p.re[l]/f}return h},fft2DArray:function(t,i,o){var r=o/2+1,e=2*i,s=new Array(e*r);n.init(o);for(var a,l,u,h,p,f={re:new Array(o),im:new Array(o)},c={re:new Array(o),im:new Array(o)},m={re:new Array(o),im:new Array(o)},g=0;i/2>g;g++){a=2*g*o,f.re=t.slice(a,a+o),a=(2*g+1)*o,f.im=t.slice(a,a+o),n.fft1d(f.re,f.im),this.reconstructTwoRealFFT(f,c,m),l=4*g*r,u=(4*g+1)*r,h=(4*g+2)*r,p=(4*g+3)*r;for(var y=r-1;y>=0;y--)s[l+y]=c.re[y],s[u+y]=c.im[y],s[h+y]=m.re[y],s[p+y]=m.im[y]}c=null,m=null;var v=new Array(e*r);n.init(i);for(var d={re:new Array(i),im:new Array(i)},C=r-1;C>=0;C--){for(var g=i-1;g>=0;g--)d.re[g]=s[2*g*r+C],d.im[g]=s[(2*g+1)*r+C];n.fft1d(d.re,d.im);for(var g=i-1;g>=0;g--)v[2*g*r+C]=d.re[g],v[(2*g+1)*r+C]=d.im[g]}return v},reconstructTwoRealFFT:function(t,i,o){var n=t.re.length;i.re[0]=t.re[0],i.im[0]=0,o.re[0]=t.im[0],o.im[0]=0;for(var r,e,s,a,l,u=n/2;u>0;u--)l=n-u,r=.5*(t.re[u]-t.re[l]),e=.5*(t.re[u]+t.re[l]),s=.5*(t.im[u]-t.im[l]),a=.5*(t.im[u]+t.im[l]),i.re[u]=e,i.im[u]=s,i.re[l]=e,i.im[l]=-s,o.re[u]=a,o.im[u]=-r,o.re[l]=a,o.im[l]=r},convolute2DI:function(t,i,o,n){for(var r,e,s=0;o/2>s;s++)for(var a=0;n>a;a++)r=t[2*s*n+a]*i[2*s*n+a]-t[(2*s+1)*n+a]*i[(2*s+1)*n+a],e=t[2*s*n+a]*i[(2*s+1)*n+a]+t[(2*s+1)*n+a]*i[2*s*n+a],t[2*s*n+a]=r,t[(2*s+1)*n+a]=e}};t.exports=r},function(t,i,o){(function(){var t;t=i;var o={release:"0.3.0",date:"2013-03"};t.toString=function(){return"version "+o.release+", released "+o.date};for(var n=0,r=null,e=null,s={init:function(t){if(0===t||0!==(t&t-1))throw new Error("init: radix-2 required");n=t,s._initArray(),s._makeBitReversalTable(),s._makeCosSinTable()},fft1d:function(t,i){s.fft(t,i,1)},ifft1d:function(t,i){var o=1/n;s.fft(t,i,-1);for(var r=0;n>r;r++)t[r]*=o,i[r]*=o},bt1d:function(t,i){s.fft(t,i,-1)},fft2d:function(t,i){for(var o=[],r=[],e=0,a=0;n>a;a++){e=a*n;for(var l=0;n>l;l++)o[l]=t[l+e],r[l]=i[l+e];s.fft1d(o,r);for(var u=0;n>u;u++)t[u+e]=o[u],i[u+e]=r[u]}for(var h=0;n>h;h++){for(var p=0;n>p;p++)e=h+p*n,o[p]=t[e],r[p]=i[e];s.fft1d(o,r);for(var f=0;n>f;f++)e=h+f*n,t[e]=o[f],i[e]=r[f]}},ifft2d:function(t,i){for(var o=[],r=[],e=0,a=0;n>a;a++){e=a*n;for(var l=0;n>l;l++)o[l]=t[l+e],r[l]=i[l+e];s.ifft1d(o,r);for(var u=0;n>u;u++)t[u+e]=o[u],i[u+e]=r[u]}for(var h=0;n>h;h++){for(var p=0;n>p;p++)e=h+p*n,o[p]=t[e],r[p]=i[e];s.ifft1d(o,r);for(var f=0;n>f;f++)e=h+f*n,t[e]=o[f],i[e]=r[f]}},fft:function(t,i,o){for(var s,a,l,u,h,p,f,c,m,g=n>>2,y=0;n>y;y++)u=r[y],u>y&&(h=t[y],t[y]=t[u],t[u]=h,h=i[y],i[y]=i[u],i[u]=h);for(var v=1;n>v;v<<=1){a=0,s=n/(v<<1);for(var d=0;v>d;d++){p=e[a+g],f=o*e[a];for(var C=d;n>C;C+=v<<1)l=C+v,c=p*t[l]+f*i[l],m=p*i[l]-f*t[l],t[l]=t[C]-c,t[C]+=c,i[l]=i[C]-m,i[C]+=m;a+=s}}},_initArray:function(){r="undefined"!=typeof Uint32Array?new Uint32Array(n):[],e="undefined"!=typeof Float64Array?new Float64Array(1.25*n):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,i=0,o=0;for(r[0]=0;++t<n;){for(o=n>>1;i>=o;)i-=o,o>>=1;i+=o,r[t]=i}},_makeCosSinTable:function(){var t=n>>1,i=n>>2,o=n>>3,r=t+i,s=Math.sin(Math.PI/n),a=2*s*s,l=Math.sqrt(a*(2-a)),u=e[i]=1,h=e[0]=0;s=2*a;for(var p=1;o>p;p++)u-=a,a+=s*u,h+=l,l-=s*h,e[p]=h,e[i-p]=u;0!==o&&(e[o]=Math.sqrt(.5));for(var f=0;i>f;f++)e[t-f]=e[f];for(var c=0;r>c;c++)e[c+t]=-e[c]}},a=["init","fft1d","ifft1d","fft2d","ifft2d"],l=0;l<a.length;l++)t[a[l]]=s[a[l]];return t.bt=s.bt1d,t.fft=s.fft1d,t.ifft=s.ifft1d,t}).call(this)},function(t,i){var o={diagonalError:.05,tolerance:.05,DEBUG:!1,toleranceX:.025,toleranceY:.5,clean:function(t,i){var o,n=Number.NEGATIVE_INFINITY;for(o=t.length-1;o>=0;o--)Math.abs(t[o].z)>n&&(n=Math.abs(t[o].z));for(n*=i,o=t.length-1;o>=0;o--)Math.abs(t[o].z)<n&&t.splice(o,1);return t},enhanceSymmetry:function(t){var i=this.initializeProperties(t),o=t;this.DEBUG&&console.log("Before optimization size: "+o.size());var n,r,e,s;for(n=o.length-1;n>=0;n--)s=o[n],s.peaks.length>1&&i[n][1]++,1==i[n][0]&&(e=this.exist(o,i,s,-1,!0),e>=0&&(i[n][1]+=2,i[e][1]+=2));for(n=o.length-1;n>=0;n--)s=o[n],0==i[n][0]&&(r=this.checkCrossPeaks(o,i,s,!0),i[n][1]+=r);var a=0;for(n=o.length-1;n>=0;n--)0!==i[n][0]&&i[n][1]>2&&(a++,a+=this.completeMissingIfNeeded(o,i,o[n],i[n])),i[n][1]>=2&&0===i[n][0]&&a++;this.DEBUG&&console.log("After optimization size: "+a);var l=new Array(a);for(a--,n=o.length-1;n>=0;n--)0!==i[n][0]&&i[n][1]>2||0===i[n][0]&&i[n][1]>1?l[a--]=o[n]:console.log("Removed "+n+" "+o[n].peaks.length);return l},completeMissingIfNeeded:function(t,i,o,n){var r=this.exist(t,i,o,-n[0],!0),e=0,s=null,a=null;0>r&&(s={nucleusX:o.nucleusX,nucleusY:o.nucleusY},s.resolutionX=o.resolutionX,s.resolutionY=o.resolutionY,s.shiftX=o.shiftY,s.shiftY=o.shiftX,s.peaks=[{x:o.shiftY,y:o.shiftX,z:1}],t.push(s),a=[-n[0],n[1]],i.push(a),e++);var l,u=0,h=!1,p=!1;for(u=t.length-1;u>=0;u--)l=t[u],0===i[u][0]&&(Math.abs(l.shiftX-o.shiftX)<this.diagonalError&&(h=!0),Math.abs(l.shiftY-o.shiftY)<this.diagonalError&&(p=!0));return h===!1&&(s={nucleusX:o.nucleusX,nucleusY:o.nucleusY},s.resolutionX=o.resolutionX,s.resolutionY=o.resolutionY,s.shiftX=o.shiftX,s.shiftY=o.shiftX,s.peaks=[{x:o.shiftX,y:o.shiftX,z:1}],t.push(s),a=[0,n[1]],i.push(a),e++),p===!1&&(s={nucleusX:o.nucleusX,nucleusY:o.nucleusY},s.resolutionX=o.resolutionX,s.resolutionY=o.resolutionY,s.shiftX=o.shiftY,s.shiftY=o.shiftY,s.peaks=[{x:o.shiftY,y:o.shiftY,z:1}],t.push(s),a=[0,n[1]],i.push(a),e++),e},checkCrossPeaks:function(t,i,o,n){var r,e=0,s=0,a=4*o.shiftX,l=[],u=[];for(s=t.length-1;s>=0;s--)r=t[s],0!==i[s][0]&&(Math.abs(r.shiftX-o.shiftX)<this.diagonalError?(e++,n&&i[s][1]++,l.push(s),a+=r.shiftX):Math.abs(r.shiftY-o.shiftY)<this.diagonalError&&(e++,n&&i[s][1]++,u.push(s),a+=r.shiftY));if(a/=l.length+u.length+4,l.length>0)for(s=l.length-1;s>=0;s--)t[l[s]].shiftX=a;if(u.length>0)for(s=u.length-1;s>=0;s--)t[u[s]].shiftY=a;return o.shiftX=a,o.shiftY=a,e},exist:function(t,i,o,n,r){for(var e=t.length-1;e>=0;e--)if(i[e][0]==n&&this.distanceTo(o,t[e],r)<this.tolerance){if(r){var s=o.shiftX,a=t[e].shiftX;t[e].shiftY=s,o.shiftY=a}else{var s=(t[e].shiftX+o.shiftX)/2,a=(t[e].shiftY+o.shiftY)/2;t[e].shiftX=s,t[e].shiftY=a,o.shiftX=s,o.shiftY=a}return e}return-1},initializeProperties:function(t){for(var i=new Array(t.length),o=t.length-1;o>=0;o--)if(i[o]=[0,0],Math.abs(t[o].shiftX-t[o].shiftY)<=this.diagonalError){i[o][1]=1;var n=(2*t[o].shiftX+t[o].shiftY)/3;t[o].shiftX=n,t[o].shiftY=n}else t[o].shiftX-t[o].shiftY>0?i[o][0]=1:i[o][0]=-1;return i},distanceTo:function(t,i,o){return o?Math.sqrt(Math.pow(t.shiftX-i.shiftY,2)+Math.pow(t.shiftY-i.shiftX,2)):Math.sqrt(Math.pow(t.shiftX-i.shiftX,2)+Math.pow(t.shiftY-i.shiftY,2))}};t.exports=o},function(t,i){var o={fullClusterGenerator:function(t){var i=Math.sqrt(2*t.length+.25)-.5,o=[],n=new Array(i),r=i,e=0,s=[];for(e=i-1;e>=0;e--)n[e]=1;for(var a=-1,l=[];r>0;){if(0===l.length){for(s=new Array(i),e=i-1;e>=0;e--)s[e]=0;for(o.push(s),a=i-1;0==n[a];a--);}else a=l.splice(0,1);s[a]=1,n[a]=0,r--;var u=new Array(i);for(e=i-1;e>=0;e--){var h=Math.max(a,e),p=Math.min(a,e);u[e]=t[p*(2*i-p-1)/2+h],1==u[e]&&1==n[e]&&0==s[e]&&(l.push(e),s[e]=1)}}return o}};t.exports=o},function(t,i){var o=o||{};o.formater=function(){function t(t,o){g="",y="",v="";var n=null;return o&&o.solvent&&(n=o.solvent),o&&void 0!=o.rangeForMultiplet&&(rangeForMultiplet=o.rangeForMultiplet),t.type="NMR SPEC","1H"==t[0].nucleus?i(t,!1,2,1,n):"13C"==t[0].nucleus&&i(t,!1,1,0,n),g.length>0&&(g+="."),g}function i(t,i,e,s,a){f(),o(t,a);for(var l=t.length,u=0;l>u;u++){if(i)var h=t[u];else var h=t[l-u-1];h&&(f(),n(h,e),r(h,s))}}function o(t,i){"NMR SPEC"==t.type?(t[0].nucleus&&(g+=p(t[0].nucleus)),g+=" NMR",(i||t[0].observe)&&(g+=" (",t[0].observe&&(g+=(1*t[0].observe).toFixed(0)+" MHz",i&&(g+=", ")),i&&(g+=h(i)),g+=")"),g+="  "):"IR"==t.type?g+=" IR ":"MASS"==t.type&&(g+=" MASS ")}function n(t,i){var o=0,n=0,r=0;t.startX&&(o="string"==typeof t.startX?parseFloat(t.startX):t.startX),t.stopX&&(n="string"==typeof t.stopX?parseFloat(t.stopX):t.stopX),t.delta1&&(r="string"==typeof t.delta1?parseFloat(t.delta1):t.delta1),t.asymmetric===!0||"m"==t.multiplicity&&rangeForMultiplet===!0?t.startX&&t.stopX?g+=n>o?o.toFixed(i)+"-"+n.toFixed(i):n.toFixed(i)+"-"+o.toFixed(i):t.delta1&&(g+=r.toFixed(i)):t.delta1?g+=r.toFixed(i):t.startX&&t.stopX&&(g+=((o+n)/2).toFixed(i))}function r(t,i){y="",a(t),e(t),l(t,i),s(t),y.length>0&&(g+=" ("+y+")")}function e(t){t.pubIntegration?(c(),y+=t.pubIntegration):t.integralData&&(c(),y+=t.integralData.value.toFixed(0)+" H")}function s(t){t.pubAssignment?(c(),y+=u(t.pubAssignment)):t.assignment&&(c(),y+=u(t.assignment))}function a(t){t.pubMultiplicity?(c(),y+=t.pubMultiplicity):t.multiplicity&&(c(),y+=t.multiplicity)}function l(t,i){if(t.nmrJs){for(var o="<i>J</i> = ",n=0;n<t.nmrJs.length;n++){var r=t.nmrJs[n].coupling;o.length>11&&(o+=", "),o+=r.toFixed(i)}c(),y+=o+" Hz"}}function u(t){return t=t.replace(/([0-9])/g,"<sub>$1</sub>"),t=t.replace(/\"([^\"]*)\"/g,"<i>$1</i>")}function h(t){return t=t.replace(/([0-9])/g,"<sub>$1</sub>")}function p(t){return t=t.replace(/([0-9])/g,"<sup>$1</sup>")}function f(){g.length>0&&!g.match(/ $/)&&(g+=", ")}function c(){y.length>0&&!y.match(", $")&&(y+=", ")}function m(t){return JSON.parse(SDAPI.AcsParserAsJSONString(t))}var g="",y="",v="";return rangeForMultiplet=!1,{toACS:t,toNMRSignal:m}}(),t.exports=o}])});
//# sourceMappingURL=spectra-data.min.js.map