!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.spectraData=r():t.spectraData=r()}(this,function(){return function(t){function r(n){if(e[n])return e[n].exports;var o=e[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var e={};return r.m=t,r.c=e,r.p="",r(0)}([function(t,r,e){"use strict";r.SD=e(1),r.NMR=e(7),r.NMR2D=e(42),r.ACS=e(49),r.JAnalyzer=e(9)},function(t,r,e){function n(t){this.sd=t,this.activeElement=0,this.DATACLASS_XY=1,this.DATACLASS_PEAK=2,this.TYPE_NMR_SPECTRUM="NMR Spectrum",this.TYPE_NMR_FID="NMR FID",this.TYPE_IR="IR",this.TYPE_RAMAN="RAMAN",this.TYPE_UV="UV",this.TYPE_MASS="MASS",this.TYPE_HPLC="HPLC",this.TYPE_GC="GC",this.TYPE_CD="CD",this.TYPE_2DNMR_SPECTRUM="nD NMR SPECTRUM",this.TYPE_2DNMR_FID="nD NMR FID",this.TYPE_XY_DEC="XY DEC",this.TYPE_XY_INC="XY INC",this.TYPE_IV="IV"}var o=e(2),i=e(3),a=e(4),s=e(6);n.fromJcamp=function(t,r){r=r||{},"undefined"==typeof r.xy&&(r.xy=!0);var e=i.convert(t,r);return new n(e)},n.prototype.setActiveElement=function(t){this.activeElement=t},n.prototype.getActiveElement=function(){return this.activeElement},n.prototype.getXUnits=function(){return this.getSpectrum().xUnit},n.prototype.getYUnits=function(){return this.getSpectrum().yUnit},n.prototype.getSpectraVariable=function(t){return this.sd.ntuples[t]},n.prototype.getNbPoints=function(t){return this.getSpectrumData(t).y.length},n.prototype.getFirstX=function(t){return t=t||this.activeElement,this.sd.spectra[t].firstX},n.prototype.getLastX=function(t){return t=t||this.activeElement,this.sd.spectra[t].lastX},n.prototype.getFirstY=function(t){return t=t||this.activeElement,this.sd.spectra[t].firstY},n.prototype.getLastY=function(t){return t=t||this.activeElement,this.sd.spectra[t].lastY},n.prototype.setDataClass=function(t){t==this.DATACLASS_PEAK&&(this.getSpectrum().isPeaktable=!0,this.getSpectrum().isXYdata=!1),t==this.DATACLASS_XY&&(this.getSpectrum().isXYdata=!0,this.getSpectrum().isPeaktable=!1)},n.prototype.isDataClassPeak=function(){return this.getSpectrum().isPeaktable?this.getSpectrum().isPeaktable:!1},n.prototype.isDataClassXY=function(){return this.getSpectrum().isXYdata?this.getSpectrum().isXYdata:!1},n.prototype.setDataType=function(t){this.getSpectrum().dataType=t},n.prototype.getDataType=function(){return this.getSpectrum().dataType},n.prototype.getSpectrumData=function(t){return t=t||this.activeElement,this.sd.spectra[t].data[0]},n.prototype.getSpectrum=function(t){return t=t||this.activeElement,this.sd.spectra[t]},n.prototype.getNbSubSpectra=function(){return this.sd.spectra.length},n.prototype.getXData=function(t){return this.getSpectrumData(t).x},n.prototype.getYData=function(t){return this.getSpectrumData(t).y},n.prototype.getX=function(t){return this.getXData()[t]},n.prototype.getY=function(t){return this.getYData()[t]},n.prototype.getXYData=function(t){return[this.getXData(t),this.getYData(t)]},n.prototype.getTitle=function(t){return this.getSpectrum(t).title},n.prototype.setTitle=function(t,r){this.getSpectrum(r).title=t},n.prototype.getMinY=function(t){return o.min(this.getYData(t))},n.prototype.getMaxY=function(t){return o.max(this.getYData(t))},n.prototype.getMinMaxY=function(t){return o.minMax(this.getYData(t))},n.prototype.getNoiseLevel=function(){var t=0,r=0,e=this.getYData(),n=this.getNbPoints(),o=0;for(o=0;n>o;o++)t+=e[o];t/=this.getNbPoints();var i=new Array(n);for(o=0;n>o;o++)i[o]=Math.abs(e[o]-t);return i.sort(),r=n%2==1?i[(n-1)/2]/.6745:.5*(i[n/2]+i[n/2-1])/.6745,r*this.getNMRPeakThreshold(this.getNucleus(1))},n.prototype.arrayPointToUnits=function(t){return this.getFirstX()-t*(this.getFirstX()-this.getLastX())/(this.getNbPoints()-1)},n.prototype.unitsToArrayPoint=function(t){if(this.isDataClassXY())return Math.round((this.getFirstX()-t)*(-1/this.getDeltaX()));if(this.isDataClassPeak()){var r,e=0,n=this.getNbPoints()-1,o=0;if(this.getFirstX()>this.getLastX()){if(n=0,o=this.getNbPoints()-1,t>this.getFirstX())return this.getNbPoints();if(t<this.getLastX())return-1}else{if(t<this.getFirstX())return-1;if(t>this.getLastX())return this.getNbPoints()}for(;Math.abs(n-o)>1;){if(r=Math.round(Math.floor((n+o)/2)),this.getX(r)==t)return r;this.getX(r)>t?n=r:o=r}return e=o,Math.abs(this.getX(o)-t)>Math.abs(this.getX(n)-t)&&(e=n),e}return 0},n.prototype.getDeltaX=function(){return(this.getLastX()-this.getFirstX())/(this.getNbPoints()-1)},n.prototype.setMinMax=function(t,r){for(var e=this.getYData(),n=o.minMax(e),i=(r-t)/(n.max-n.min),a=0;a<e.length;a++)e[a]=(e[a]-n.min)*i+t},n.prototype.setMin=function(t){for(var r=this.getYData(),e=o.min(r),n=t/e,i=0;i<r.length;i++)r[i]*=n},n.prototype.setMax=function(t){for(var r=this.getYData(),e=o.max(r),n=t/e,i=0;i<r.length;i++)r[i]*=n},n.prototype.YShift=function(t){var r=this.getSpectrumData().y,e=this.getNbPoints(),n=0;for(n=0;e>n;n++)r[n]+=t;this.getSpectrum().firstY+=t,this.getSpectrum().lastY+=t},n.prototype.shift=function(t){for(var r=0;r<this.getNbSubSpectra();r++){this.setActiveElement(r);var e=this.getSpectrumData().x,n=this.getNbPoints(),r=0;for(r=0;n>r;r++)e[r]+=t;this.getSpectrum().firstX+=t,this.getSpectrum().lastX+=t}},n.prototype.fillWith=function(t,r,e){var n,o,i,a,s;if(t>r){var n=t;t=r,r=n}for(var f=0;f<this.getNbSubSpectra();f++)for(this.setActiveElement(f),a=this.getXData(),s=this.getYData(),o=this.unitsToArrayPoint(t),i=this.unitsToArrayPoint(r),o>i&&(n=o,o=i,i=n),0>o&&(o=0),i>=this.getNbPoints&&(i=this.getNbPoints-1),f=o;i>=f;f++)s[f]=e},n.prototype.suppressZone=function(t,r){var e,n,o,i,a;if(t>r){var e=t;t=r,r=e}for(var s=0;s<this.getNbSubSpectra();s++)for(this.setActiveElement(s),i=this.getXData(),a=this.getYData(),n=this.unitsToArrayPoint(t),o=this.unitsToArrayPoint(r),n>o&&(e=n,n=o,o=e),0>n&&(n=0),o>=this.getNbPoints&&(o=this.getNbPoints-1),s=o;s>=n;s--)a.splice(s,1),i.splice(s,1);this.setDataClass(this.DATACLASS_PEAK)},n.prototype.simplePeakPicking=function(t){},n.prototype.getMaxPeak=function(){for(var t=this.getSpectraDataY(),r=t[0],e=0,n=0;n<t.length;n++)r<t[n]&&(r=t[n],e=n);return[this.getSpectraDataX()[e],r]},n.prototype.getParamDouble=function(t,r){var e=this.sd.info[t];return e||(e=r),e},n.prototype.getParamString=function(t,r){var e=this.sd.info[t];return e||(e=r),e+""},n.prototype.getParamInt=function(t,r){var e=this.sd.info[t];return e||(e=r),e},n.prototype.getParam=function(t,r){var e=this.sd.info[t];return e||(e=r),e},n.prototype.containsParam=function(t){return this.sd.info[t]?!0:!1},n.prototype.getSpectraDataY=function(){return this.getYData()},n.prototype.getSpectraDataX=function(){return this.getXData()},n.prototype.putParam=function(t,r){this.sd.info[t]=r},n.prototype.getArea=function(t,r){var e=this.unitsToArrayPoint(t),n=this.unitsToArrayPoint(r),o=0;if(e>n){var i=e;e=n,n=i}e=0>e?0:e,n=n>=this.getNbPoints()?this.getNbPoints()-1:n;for(var a=e;n>a;a++)o+=this.getY(a);return o*Math.abs(this.getDeltaX())},n.prototype.getVector=function(t,r,e){var n=this.getSpectraDataX(),o=this.getSpectraDataY(),i=0,a=n.length-1,s=1,f=!1;if(n[0]>n[1]&&(s=-1,i=n.length-1,a=0),t>r){var u=t;t=r,r=u,f=!0}if(n[i]>r||n[a]<t)return[];for(;n[i]<t;)i+=s;for(;n[a]>r;)a-=s;var h=Math.abs(a-i)+1;e||(e=h);var l=new Array(e),c=new Array(e),p=0;-1==s&&(p=e-1);for(var g=h/e,m=i-s,v=0;e>v;v++)m+=Math.round(g*s),l[p]=n[m],c[p]=o[m],p+=s;return[l,c]},n.prototype.is2D=function(){return"undefined"==typeof this.sd.twoD?!1:this.sd.twoD},n.prototype.toJcamp=function(t){var r={encode:"DIFDUP",yFactor:1,type:"SIMPLE",keep:[]};return t=s({},r,t),a.convert(this,t.encode,t.yFactor,t.type,t.keep)},t.exports=n},function(t,r){"use strict";function e(t,r){return t-r}r.sum=function n(t){for(var n=0,r=0;r<t.length;r++)n+=t[r];return n},r.max=function o(t){for(var o=-(1/0),r=t.length,e=0;r>e;e++)t[e]>o&&(o=t[e]);return o},r.min=function i(t){for(var i=1/0,r=t.length,e=0;r>e;e++)t[e]<i&&(i=t[e]);return i},r.minMax=function(t){for(var r=1/0,e=-(1/0),n=t.length,o=0;n>o;o++)t[o]<r&&(r=t[o]),t[o]>e&&(e=t[o]);return{min:r,max:e}},r.arithmeticMean=function(t){for(var r=0,e=t.length,n=0;e>n;n++)r+=t[n];return r/e},r.mean=r.arithmeticMean,r.geometricMean=function(t){for(var r=1,e=t.length,n=0;e>n;n++)r*=t[n];return Math.pow(r,1/e)},r.logMean=function(t){for(var r=0,e=t.length,n=0;e>n;n++)r+=Math.log(t[n]);return r/e},r.grandMean=function(t,r){for(var e=0,n=0,o=t.length,i=0;o>i;i++)e+=r[i]*t[i],n+=r[i];return e/n},r.truncatedMean=function(t,r,n){void 0===n&&(n=!1),n||(t=t.slice().sort(e));for(var o=t.length,i=Math.floor(o*r),a=0,s=i;o-i>s;s++)a+=t[s];return a/(o-2*i)},r.harmonicMean=function(t){for(var r=0,e=t.length,n=0;e>n;n++){if(0===t[n])throw new RangeError("value at index "+n+"is zero");r+=1/t[n]}return e/r},r.contraHarmonicMean=function(t){for(var r=0,e=0,n=t.length,o=0;n>o;o++)r+=t[o]*t[o],e+=t[o];if(0>e)throw new RangeError("sum of values is negative");return r/e},r.median=function(t,r){void 0===r&&(r=!1),r||(t=t.slice().sort(e));var n=t.length,o=Math.floor(n/2);return n%2===0?.5*(t[o-1]+t[o]):t[o]},r.variance=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=0,i=t.length,a=0;i>a;a++){var s=t[a]-n;o+=s*s}return e?o/(i-1):o/i},r.standardDeviation=function(t,e){return Math.sqrt(r.variance(t,e))},r.standardError=function(t){return r.standardDeviation(t)/Math.sqrt(t.length)},r.quartiles=function(t,n){"undefined"==typeof n&&(n=!1),n||(t=t.slice(),t.sort(e));var o=t.length/4,i=t[Math.ceil(o)-1],a=r.median(t,!0),s=t[Math.ceil(3*o)-1];return{q1:i,q2:a,q3:s}},r.pooledStandardDeviation=function(t,e){return Math.sqrt(r.pooledVariance(t,e))},r.pooledVariance=function(t,e){"undefined"==typeof e&&(e=!0);for(var n=0,o=0,i=t.length,a=0;i>a;a++){var s=t[a],f=r.variance(s);n+=(s.length-1)*f,o+=e?s.length-1:s.length}return n/o},r.mode=function(t){var r,e=t.length,n=new Array(e);for(r=0;e>r;r++)n[r]=0;var o=new Array(e),i=0;for(r=0;e>r;r++){var a=o.indexOf(t[r]);a>=0?n[a]++:(o[i]=t[r],n[i]=1,i++)}var s=0,f=0;for(r=0;i>r;r++)n[r]>s&&(s=n[r],f=r);return o[f]},r.covariance=function(t,e,n){"undefined"==typeof n&&(n=!0);var o=r.mean(t),i=r.mean(e);if(t.length!==e.length)throw"Vectors do not have the same dimensions";for(var a=0,s=t.length,f=0;s>f;f++){var u=t[f]-o,h=e[f]-i;a+=u*h}return n?a/(s-1):a/s},r.skewness=function(t,e){"undefined"==typeof e&&(e=!0);for(var n=r.mean(t),o=0,i=0,a=t.length,s=0;a>s;s++){var f=t[s]-n;o+=f*f,i+=f*f*f}var u=o/a,h=i/a,l=h/Math.pow(u,1.5);if(e){var c=Math.sqrt(a*(a-1)),p=a-2;return c/p*l}return l},r.kurtosis=function(t,e){"undefined"==typeof e&&(e=!0);for(var n=r.mean(t),o=t.length,i=0,a=0,s=0;o>s;s++){var f=t[s]-n;i+=f*f,a+=f*f*f*f}var u=i/o,h=a/o;if(e){var l=i/(o-1),c=o*(o+1)/((o-1)*(o-2)*(o-3)),p=a/(l*l),g=(o-1)*(o-1)/((o-2)*(o-3));return c*p-3*g}return h/(u*u)-3},r.entropy=function(t,r){"undefined"==typeof r&&(r=0);for(var e=0,n=t.length,o=0;n>o;o++)e+=t[o]*Math.log(t[o]+r);return-e},r.weightedMean=function(t,r){for(var e=0,n=t.length,o=0;n>o;o++)e+=t[o]*r[o];return e},r.weightedStandardDeviation=function(t,e){return Math.sqrt(r.weightedVariance(t,e))},r.weightedVariance=function(t,e){for(var n=r.weightedMean(t,e),o=0,i=t.length,a=0,s=0,f=0;i>f;f++){var u=t[f]-n,h=e[f];o+=h*(u*u),s+=h,a+=h*h}return o*(s/(s*s-a))},r.center=function(t,e){"undefined"==typeof e&&(e=!1);var n=t;e||(n=t.slice());for(var o=r.mean(n),i=n.length,a=0;i>a;a++)n[a]-=o},r.standardize=function(t,e,n){"undefined"==typeof e&&(e=r.standardDeviation(t)),"undefined"==typeof n&&(n=!1);for(var o=t.length,i=n?t:new Array(o),a=0;o>a;a++)i[a]=t[a]/e;return i},r.cumulativeSum=function(t){var r=t.length,e=new Array(r);e[0]=t[0];for(var n=1;r>n;n++)e[n]=e[n-1]+t[n];return e}},function(t,r){"use strict";function e(){function t(t){for(var r=t.length,e=new Array(r),n=0;r>n;n++)e[n]=parseFloat(t[n]);return e}function r(r,u){u=u||{};var l=/^$/;u.keepRecordsRegExp&&(l=u.keepRecordsRegExp);var c,p,g,v,y,d,w,M,b,x=new Date,A={},S={};S.profiling=[],S.logs=[];var D=[];S.spectra=D,S.info={};var E={};if("string"!=typeof r)return S;for(S.profiling&&S.profiling.push({action:"Before split to LDRS",time:new Date-x}),v=r.split(/[\r\n]+##/),S.profiling&&S.profiling.push({action:"Split to LDRS",time:new Date-x}),v[0]&&(v[0]=v[0].replace(/^[\r\n ]*##/,"")),y=0,d=v.length;d>y;y++){if(c=v[y],w=c.indexOf("="),w>0?(p=c.substring(0,w),g=c.substring(w+1).trim()):(p=c,g=""),p=p.replace(/[_ -]/g,"").toUpperCase(),"DATATABLE"===p&&(M=g.indexOf("\n"),-1===M&&(M=g.indexOf("\r")),M>0)){var R=-1,k=-1;if(b=g.substring(0,M).split(/[ ,;\t]+/),b[0].indexOf("++")>0){var P=b[0].replace(/.*\(([a-zA-Z0-9]+)\+\+.*/,"$1"),F=b[0].replace(/.*\.\.([a-zA-Z0-9]+).*/,"$1");R=A.symbol.indexOf(P),k=A.symbol.indexOf(F)}-1===R&&(R=0),-1===k&&(k=0),A.first&&(A.first.length>R&&(E.firstX=A.first[R]),A.first.length>k&&(E.firstY=A.first[k])),A.last&&(A.last.length>R&&(E.lastX=A.last[R]),A.last.length>k&&(E.lastY=A.last[k])),A.vardim&&A.vardim.length>R&&(E.nbPoints=A.vardim[R]),A.factor&&(A.factor.length>R&&(E.xFactor=A.factor[R]),A.factor.length>k&&(E.yFactor=A.factor[k])),A.units&&(A.units.length>R&&(E.xUnit=A.units[R]),A.units.length>k&&(E.yUnit=A.units[k])),E.datatable=b[0],b[1]&&b[1].indexOf("PEAKS")>-1?p="PEAKTABLE":b[1]&&(b[1].indexOf("XYDATA")||b[0].indexOf("++")>0)&&(p="XYDATA",E.deltaX=(E.lastX-E.firstX)/(E.nbPoints-1))}if("TITLE"===p)E.title=g;else if("DATATYPE"===p)E.dataType=g,g.indexOf("nD")>-1&&(S.twoD=!0);else if("NTUPLES"===p)g.indexOf("nD")>-1&&(S.twoD=!0);else if("XUNITS"===p)E.xUnit=g;else if("YUNITS"===p)E.yUnit=g;else if("FIRSTX"===p)E.firstX=parseFloat(g);else if("LASTX"===p)E.lastX=parseFloat(g);else if("FIRSTY"===p)E.firstY=parseFloat(g);else if("LASTY"===p)E.lastY=parseFloat(g);else if("NPOINTS"===p)E.nbPoints=parseFloat(g);else if("XFACTOR"===p)E.xFactor=parseFloat(g);else if("YFACTOR"===p)E.yFactor=parseFloat(g);else if("DELTAX"===p)E.deltaX=parseFloat(g);else if(".OBSERVEFREQUENCY"===p||"$SFO1"===p)E.observeFrequency||(E.observeFrequency=parseFloat(g));else if(".OBSERVENUCLEUS"===p)E.xType||(S.xType=g.replace(/[^a-zA-Z0-9]/g,""));else if("$SFO2"===p)S.indirectFrequency||(S.indirectFrequency=parseFloat(g));else if("$OFFSET"===p)S.shiftOffsetNum=0,S.shiftOffsetVal||(S.shiftOffsetVal=parseFloat(g));else if("$REFERENCEPOINT"===p);else if("VARNAME"===p)A.varname=g.split(m);else if("SYMBOL"===p)A.symbol=g.split(m);else if("VARTYPE"===p)A.vartype=g.split(m);else if("VARFORM"===p)A.varform=g.split(m);else if("VARDIM"===p)A.vardim=t(g.split(m));else if("UNITS"===p)A.units=g.split(m);else if("FACTOR"===p)A.factor=t(g.split(m));else if("FIRST"===p)A.first=t(g.split(m));else if("LAST"===p)A.last=t(g.split(m));else if("MIN"===p)A.min=t(g.split(m));else if("MAX"===p)A.max=t(g.split(m));else if(".NUCLEUS"===p)S.twoD&&(S.yType=g.split(m)[0]);else if("PAGE"===p){E.page=g.trim(),E.pageValue=parseFloat(g.replace(/^.*=/,"")),E.pageSymbol=E.page.replace(/=.*/,"");var X=A.symbol.indexOf(E.pageSymbol),Y="";A.units&&A.units[X]&&(Y=A.units[X]),S.indirectFrequency&&"PPM"!==Y&&(E.pageValue/=S.indirectFrequency)}else"RETENTIONTIME"===p?E.pageValue=parseFloat(g):"XYDATA"===p?(a(S,E),g.match(/.*\+\+.*/)?f(E,g,S):s(E,g,S),D.push(E),E={}):"PEAKTABLE"===p?(a(S,E),s(E,g,S),D.push(E),E={}):n(p)&&(E[e(p)]=g);p.match(l)&&(S.info[p]=g.trim())}if(S.profiling&&S.profiling.push({action:"Finished parsing",time:new Date-x}),Object.keys(A).length>0){for(var N=[],C=Object.keys(A),y=0;y<C.length;y++)for(var T=C[y],I=A[T],O=0;O<I.length;O++)N[O]||(N[O]={}),N[O][T]=I[O];S.ntuples=N}S.twoD&&(h(S),S.profiling&&S.profiling.push({action:"Finished countour plot calculation",time:new Date-x}),u.keepSpectra||delete S.spectra);var V=D.length>1&&(!D[0].dataType||D[0].dataType.match(/.*mass.*/i));if(V&&u.newGCMS&&(u.xy=!0),u.xy&&D.length>0)for(var y=0;y<D.length;y++){var E=D[y];if(E.data.length>0)for(var O=0;O<E.data.length;O++){for(var z=E.data[O],U={x:new Array(z.length/2),y:new Array(z.length/2)},L=0;L<z.length;L+=2)U.x[L/2]=z[L],U.y[L/2]=z[L+1];E.data[O]=U}}return V&&(u.newGCMS?o(S):i(S),S.profiling&&S.profiling.push({action:"Finished GCMS calculation",time:new Date-x})),S.profiling&&S.profiling.push({action:"Total time",time:new Date-x}),S}function e(t){return t.toLowerCase().replace(/[^a-z0-9]/g,"")}function n(t){return-1!==y.indexOf(t)}function o(t){var r,n=t.spectra,o=n.length,i={times:new Array(o),series:[{name:"ms",dimension:2,data:new Array(o)}]},a=[];for(r=0;r<y.length;r++){var s=e(y[r]);n[0][s]&&(a.push(s),i.series.push({name:s,dimension:1,data:new Array(o)}))}for(r=0;o>r;r++){var f=n[r];i.times[r]=f.pageValue;for(var u=0;u<a.length;u++)i.series[u+1].data[r]=parseFloat(f[a[u]]);f.data&&(i.series[0].data[r]=[f.data[0].x,f.data[0].y])}t.gcms=i}function i(t){var r,n=t.spectra,o=[];for(r=0;r<y.length;r++){var i=e(y[r]);n[0][i]&&o.push(i)}if(0!==o.length){var a={};for(a.gc={},a.ms=[],r=0;r<o.length;r++)a.gc[o[r]]=[];for(r=0;r<n.length;r++){for(var s=n[r],f=0;f<o.length;f++)a.gc[o[f]].push(s.pageValue),a.gc[o[f]].push(parseFloat(s[o[f]]));s.data&&(a.ms[r]=s.data[0])}t.gcms=a}}function a(t,r){if(r.xFactor||(r.xFactor=1),r.yFactor||(r.yFactor=1),r.observeFrequency&&r.xUnit&&"HZ"===r.xUnit.toUpperCase()&&(r.xUnit="PPM",r.xFactor=r.xFactor/r.observeFrequency,r.firstX=r.firstX/r.observeFrequency,r.lastX=r.lastX/r.observeFrequency,r.deltaX=r.deltaX/r.observeFrequency),t.shiftOffsetVal){var e=r.firstX-t.shiftOffsetVal;r.firstX=r.firstX-e,r.lastX=r.lastX-e}}function s(t,r,e){t.isPeaktable=!0;var n,o,i,a,s,f=[];t.data=[f];var u=r.split(/,? *,?[;\r\n]+ */),h=0;for(n=1,o=u.length;o>n;n++)if(s=u[n].trim().replace(p,"").split(g),s.length%2===0)for(i=0,a=s.length;a>i;i+=2)f[h++]=parseFloat(s[i])*t.xFactor,f[h++]=parseFloat(s[i+1])*t.yFactor;else e.logs.push("Format error: "+s)}function f(t,r,e){t.deltaX||(t.deltaX=(t.lastX-t.firstX)/(t.nbPoints-1)),t.isXYdata=!0;var n=[];t.data=[n];var o,i,a,s=t.firstX,f=t.firstY,u=r.split(/[\r\n]+/);i=[];for(var h=1,l=u.length;l>h;h++)if(i=u[h].trim().replace(p,"").split(c),i.length>0){if(v){t.firstPoint||(t.firstPoint=parseFloat(i[0]));var g=parseFloat(i[0]-t.firstPoint)*t.xFactor+t.firstX;(o||0===o)&&(g+=t.deltaX),e.logs.push("Checking X value: currentX: "+s+" - expectedCurrentX: "+g)}for(var m=1,y=i.length;y>m;m++)if(1!==m||!o&&0!==o){if(i[m].length>0)if(a=i[m].charCodeAt(0),43===a||45===a||46===a||a>47&&58>a)o=null,f=parseFloat(i[m]),n.push(s,f*t.yFactor),s+=t.deltaX;else if(a>63&&74>a)o=null,f=parseFloat(String.fromCharCode(a-16)+i[m].substring(1)),n.push(s,f*t.yFactor),s+=t.deltaX;else if(a>96&&106>a)o=null,f=-parseFloat(String.fromCharCode(a-48)+i[m].substring(1)),n.push(s,f*t.yFactor),s+=t.deltaX;else if(a>82&&91>a||115===a){var d=parseFloat(String.fromCharCode(a-34)+i[m].substring(1))-1;115===a&&(d=parseFloat("9"+i[m].substring(1))-1);for(var w=0;d>w;w++)o&&(f+=o),n.push(s,f*t.yFactor),s+=t.deltaX}else 37===a?(o=parseFloat("0"+i[m].substring(1)),f+=o,n.push(s,f*t.yFactor),s+=t.deltaX):a>73&&83>a?(o=parseFloat(String.fromCharCode(a-25)+i[m].substring(1)),f+=o,n.push(s,f*t.yFactor),s+=t.deltaX):a>105&&115>a&&(o=-parseFloat(String.fromCharCode(a-57)+i[m].substring(1)),f+=o,n.push(s,f*t.yFactor),s+=t.deltaX)}else o=null,a=i[m].charCodeAt(0)}}function u(t){for(var r=0,e=t[0].data[0][0],n=e,o=t.length,i=t[0].data[0].length/2,a=new Array(o),s=0;o>s;s++){a[s]=new Array(i);for(var f=0;i>f;f++)a[s][f]=t[s].data[0][2*f+1],a[s][f]<e&&(e=t[s].data[0][2*f+1]),a[s][f]>n&&(n=t[s].data[0][2*f+1]),0!==s&&0!==f&&(r+=Math.abs(a[s][f]-a[s][f-1])+Math.abs(a[s][f]-a[s-1][f]))}return{z:a,minX:t[0].data[0][0],maxX:t[0].data[0][t[0].data[0].length-2],minY:t[0].pageValue,maxY:t[o-1].pageValue,minZ:e,maxZ:n,noise:r/((o-1)*(i-1)*2)}}function h(t){var r=u(t.spectra);t.contourLines=l(r),delete r.z,t.minMax=r}function l(t,r){for(var e,n,o,i,a,s=t.noise,f=t.z,u=[],h=7,l=new Float32Array(4),c=[],p=f.length,g=f[0].length,m=t.minX,v=t.maxX,y=(v-m)/(g-1),d=t.minY,w=t.maxY,M=(w-d)/(p-1),b=t.minZ,x=t.maxZ,A=0;2*h>A;A++){var S={};u.push(S);var D=A%2;a=0===D?(x-5*s)*Math.exp(A/2-h)+5*s:-(x-5*s)*Math.exp(A/2-h)-5*s;var E=[];if(S.zValue=a,S.lines=E,!(b>=a||a>=x))for(var R=0;p-1>R;R++)for(var k=0;g-1>k;k++){l[0]=f[R][k],l[1]=f[R][k+1],l[2]=f[R+1][k],l[3]=f[R+1][k+1];for(var P=0;4>P;P++)c[P]=l[P]>a;c[0]!==c[1]&&c[0]!==c[2]&&(e=k+(a-l[0])/(l[1]-l[0]),n=R,o=k,i=R+(a-l[0])/(l[2]-l[0]),E.push(e*y+m,n*M+d,o*y+m,i*M+d)),c[3]!==c[1]&&c[3]!==c[2]&&(e=k+1,n=R+1-(a-l[3])/(l[1]-l[3]),o=k+1-(a-l[3])/(l[2]-l[3]),i=R+1,E.push(e*y+m,n*M+d,o*y+m,i*M+d)),c[1]!==c[2]&&(e=k+1-(a-l[1])/(l[2]-l[1]),n=R+(a-l[1])/(l[2]-l[1]),c[1]!==c[0]&&(o=k+1-(a-l[1])/(l[0]-l[1]),i=R,E.push(e*y+m,n*M+d,o*y+m,i*M+d)),c[2]!==c[0]&&(o=k,i=R+1-(a-l[2])/(l[0]-l[2]),E.push(e*y+m,n*M+d,o*y+m,i*M+d)),c[1]!==c[3]&&(o=k+1,i=R+(a-l[1])/(l[3]-l[1]),E.push(e*y+m,n*M+d,o*y+m,i*M+d)),c[2]!==c[3]&&(o=k+(a-l[2])/(l[3]-l[2]),i=R+1,E.push(e*y+m,n*M+d,o*y+m,i*M+d)))}}return{minX:t.minX,maxX:t.maxX,minY:t.minY,maxY:t.maxY,segments:u}}var c=/[,\t \+-]*(?=[^\d,\t \.])|[ \t]+(?=[\d+\.-])/,p=/\$\$.*/,g=/[,\t ]+/,m=/[, \t]{1,}/,v=!1,y=["TIC",".RIC","SCANNUMBER"];return r}function n(t,r,e){return"boolean"==typeof r&&(e=r,r={}),e?o(t,r):s(t,r)}function o(t,r){return a||i(),new Promise(function(e){var n=Date.now()+""+Math.random();f[n]=e,a.postMessage({stamp:n,input:t,options:r})})}function i(){var t=URL.createObjectURL(new Blob(["var getConverter ="+e.toString()+";var convert = getConverter(); onmessage = function (event) { postMessage({stamp: event.data.stamp, output: convert(event.data.input, event.data.options)}); };"],{type:"application/javascript"}));a=new Worker(t),URL.revokeObjectURL(t),a.addEventListener("message",function(t){var r=t.data.stamp;f[r]&&f[r](t.data.output)})}var a,s=e(),f={};t.exports={convert:n}},function(t,r,e){var n=e(5),o=function(){const t={MAX_VALUE:2e31,MIN_VALUE:-2e31},r="\r\n",e="Cheminfo tools, March 2016";var o=function(n,o,s,f,u){o=o.toUpperCase().trim(),(null===f||0==f.length)&&(f="SIMPLE");var h="";n.setActiveElement(0);var l=s/n.getParamDouble("YFACTOR",1);n.getMaxY()*l>=t.MAX_VALUE/2&&(l=t.MAX_VALUE/(2*n.getMaxY())),Math.abs(n.getMaxY()-n.getMinY())*l<16&&(l=16/Math.abs(n.getMaxY()-n.getMinY()));var c=Math.abs(1/n.getDeltaX());return h+="##TITLE= "+n.getTitle()+r,h+="##JCAMP-DX= 5.00	$$"+e+r,h+="##OWNER= "+n.getParamString("##OWNER=","")+r,h+="##DATA TYPE= "+n.getDataType()+r,"NTUPLES"==f&&(h+=i(n,l,c,o,u)),"SIMPLE"==f&&(h+=a(n,l,c,o,u)),h},i=function(t,e,o,i,a){var s="",f=t.getSpectraVariable(0),u=t.getSpectraVariable(1),h=t.getSpectraVariable(2);s+="##DATA CLASS= NTUPLES\r\n",s+="##NUM DIM= 2\r\n";var l,c=t.getDataType().trim(),p={};for(l=0;l<t.getNbSubSpectra();l++)t.setActiveElement(l),p[t.getXUnits()]?p[t.getXUnits()].value++:p[t.getXUnits()]={value:1,index:l};var g=Object.keys(p),m=g[0],v=0;for(l=1;l<g.length;l++)p[g[l]].value>p[m].value&&(m=g[l],v=p[g[l]].index);var y=!1;t.setActiveElement(v);var d=t.getDataType().indexOf("NMR")>=0;d&&(s+="##.OBSERVE FREQUENCY= "+t.getParamDouble("observefrequency",0)+r,s+="##.OBSERVE NUCLEUS= ^"+t.getNucleus()+r,s+="##$DECIM= "+t.getParamDouble("$DECIM",0)+r,s+="##$DSPFVS= "+t.getParamDouble("$DSPFVS",0)+r,s+="##$FCOR= "+Math.floor(t.getParamDouble("$FCOR",0))+r,t.containsParam("$SW_h")?s+="##$SW_h= "+t.getParamDouble("$SW_h",0)+r:t.containsParam("$SW_p")&&(s+="##$SW_p= "+t.getParamDouble("$SW_p",0)+r),s+="##$SW= "+t.getParamDouble("$SW",0)+r,s+="##$TD= "+Math.floor(t.getParamDouble("$TD",0))+r,s+="##$BF1= "+t.getParamDouble("$BF1",0)+r,s+="##$GRPDLY= "+t.getParamDouble("$GRPDLY",0)+r,s+="##.DIGITISER RES= "+t.getParamInt(".DIGITISER RES",0)+r,s+="##.PULSE SEQUENCE= "+t.getParamString(".PULSE SEQUENCE","")+r,s+="##.SOLVENT NAME= "+t.getSolventName()+r,s+="##$NUC1= <"+t.getNucleus()+">"+r,s+=t.containsParam("2D_X_FREQUENCY")?"##$SFO1= "+t.getParamDouble("2D_X_FREQUENCY",0)+r:"##$SFO1= "+t.getParamDouble("$SFO1",0)+r,t.containsParam("2D_X_OFFSET")&&(s+="##$OFFSET= "+t.getParamDouble("2D_X_OFFSET",0)+r),t.is2D()&&(s+="$$Parameters for 2D NMR Spectrum\r\n",s+="##$NUC1= <"+t.getNucleus(2)+">"+r,t.containsParam("2D_Y_FREQUENCY")&&(s+="##$SFO1= "+t.getParamDouble("2D_Y_FREQUENCY",0)+r,s+="##$SFO2= "+t.getParamDouble("2D_Y_FREQUENCY",0)+r,s+="##$BF2= "+t.getParamDouble("2D_Y_FREQUENCY",0)+r),t.containsParam("2D_Y_OFFSET")&&(s+="##$OFFSET= "+t.getParamDouble("2D_Y_OFFSET",0)+r),s+="$$End of Parameters for 2D NMR Spectrum\r\n")),s+="##NTUPLES=	"+c+r;var w=1,M=1;if(!t.is2D()&&t.getNbSubSpectra()>1&&d&&(y=!0),y?(s+="##VAR_NAME=	"+t.getXUnits()+",	"+c.substring(4)+"/REAL,	"+c.substring(4)+"/IMAG"+r,s+="##SYMBOL=	X,	R,	I\r\n",s+="##VAR_TYPE=	INDEPENDENT,	DEPENDENT,	DEPENDENT\r\n",s+="CSV"!=i||"PAC"!=i?"##VAR_FORM=	AFFN,	ASDF,	ASDF\r\n":"##VAR_FORM=	AFFN,	AFFN,	AFFN\r\n",s+="##VAR_DIM=	"+t.getNbPoints()+",	"+t.getNbPoints()+",	"+t.getNbPoints()+r,s+="##UNITS=	HZ,	"+t.getYUnits()+",	"+h.units+r,s+="##FACTOR=	"+1/o+",	"+1/e+",	"+1/e+r,"PPM"==t.getXUnits()&&(w=t.observeFrequencyX()),s+="##FIRST=	"+t.getFirstX()*w+",	"+t.getY(0)+",	0"+r,s+="##LAST=	"+t.getLastX()*w+",	"+t.getLastY()+",	0"+r):(w=1,t.is2D()?(s+="##VAR_NAME=	FREQUENCY1,	FREQUENCY2,	SPECTRUM\r\n",s+="##SYMBOL=	F1,	F2,	Y\r\n",s+="##.NUCLEUS=	"+t.getNucleus(2)+",	"+t.getNucleus(1)+r,s+="##VAR_TYPE=	INDEPENDENT,	INDEPENDENT,	DEPENDENT\r\n",s+="##VAR_FORM=	AFFN,	AFFN,	ASDF\r\n",s+="##VAR_DIM=	"+t.getNbSubSpectra()+",	"+t.getNbPoints()+",	"+t.getNbPoints()+r,s+="##UNITS=	HZ,	HZ,	"+t.getYUnits()+r,"PPM"==t.getXUnits()&&(w=t.getParamDouble("2D_Y_FREQUENCY",1)),"PPM"==t.getYUnits()&&(M=t.getParamDouble("2D_X_FREQUENCY",1)),s+="##FACTOR=	1,	"+M/o+",	"+1/e+r,s+="##FIRST=	"+t.getParamDouble("firstY",0)*w+",	"+t.getFirstX()*M+",	"+t.getY(0)+r,s+="##LAST=	"+t.getParamDouble("lastY",0)*w+",	"+t.getLastX()*M+",	"+t.getY(t.getNbPoints()-1)+r):(s+="##VAR_NAME=	"+f.varname+",	"+u.varname+",	"+f.varname+r,s+="##SYMBOL=	"+f.symbol+",	"+u.symbol+",	"+h.symbol+r,s+="##VAR_TYPE=	"+f.vartype+",	"+u.vartype+",	"+h.vartype+r,s+="CSV"!=i||"PAC"!=i?"##VAR_FORM=	AFFN,	ASDF,	ASDF\r\n":"##VAR_FORM=	AFFN,	AFFN,	AFFN\r\n",s+="##VAR_DIM=	"+f.vardim+",	"+u.vardim+",	"+h.vardim+r,s+="##UNITS=	HZ,	"+t.getYUnits()+",	"+h.units+r,"PPM"==t.getXUnits()&&(w=t.observeFrequencyX()),s+="##FACTOR=	"+1/o+",	"+1/e+r,s+="##FIRST=	"+f.first*w+",	"+u.first+",	"+h.first+r,s+="##LAST=	"+f.last*w+",	"+u.last+",	"+h.last+r)),null!=a)for(var b=a.length-1;b>=0;b--)t.containsParam(a[b])&&(s+="##"+a[b]+"= "+t.getParam(a[b],"")+r);var x=0,A=0,S=0;for(t.is2D()&&d&&(x=t.getParamDouble("firstY",0)*w,A=t.getParamDouble("lastY",0)*w,S=(A-x)/(t.getNbSubSpectra()-1)),l=0;l<t.getNbSubSpectra();l++)if(t.setActiveElement(l),s+="##PAGE= "+t.page+r,x+=S,t.is2D()&&d&&(s+="##FIRST=	"+t.getParamDouble("firstY",0)*w+",	"+t.getFirstX()*M+",	"+t.getY(0)+r),s+="##DATA TABLE= ",t.isDataClassPeak()){s+="(XY..XY), PEAKS\r\n";for(var D=0;D<t.getNbPoints();D++)s+=t.getX(D)+", "+t.getY(D)+r}else if(t.isDataClassXY()){s+=d?t.is2D()?"(F2++(Y..Y)), PROFILE\r\n":l%2==0?"(X++(R..R)), XYDATA\r\n":"(X++(I..I)), XYDATA\r\n":"(X++(Y..Y)), XYDATA\r\n";for(var E="",R=new Array(t.getNbPoints()),D=R.length-1;D>=0;D--)R[D]=Math.round(t.getY(D)*e);E+=n.encode(R,t.getFirstX()*o,t.getDeltaX()*o,i),s+=E+r}return s+="##END NTUPLES= "+c+r,s+="##END= ",t.setActiveElement(0),s},a=function(t,e,o,i,a){var s=(t.getSpectraVariable(0),t.getSpectraVariable(1),"");if(t.isDataClassPeak()&&(s+="##DATA CLASS= PEAK TABLE\r\n"),t.isDataClassXY()&&(s+="##DATA CLASS= XYDATA\r\n"),t.setActiveElement(0),t.getDataType().indexOf("NMR")>=0&&(s+="##.OBSERVE FREQUENCY= "+t.getParamDouble("observefrequency",0)+r,s+="##.OBSERVE NUCLEUS= ^"+t.getNucleus()+r,s+="##$DECIM= "+Math.round(t.getParamDouble("$DECIM",0))+r,s+="##$DSPFVS= "+Math.round(t.getParamDouble("$DSPFVS",0))+r,s+="##$FCOR= "+Math.round(t.getParamDouble("$FCOR",0))+r,s+="##$SW_h= "+t.getParamDouble("$SW_h",0)+r,s+="##$SW= "+t.getParamDouble("$SW",0)+r,s+="##$TD= "+Math.round(t.getParamDouble("$TD",0))+r,s+="##$GRPDLY= "+t.getParamDouble("$GRPDLY",0)+r,s+="##$BF1= "+t.getParamDouble("$BF1",0)+r,s+="##$SFO1= "+t.getParamDouble("$SFO1",0)+r,s+="##$NUC1= <"+t.getNucleus()+">"+r,s+="##.SOLVENT NAME= "+t.getSolventName()+r),s+="##XUNITS=	"+t.getXUnits()+r,s+="##YUNITS=	"+t.getYUnits()+r,s+="##NPOINTS=	"+t.getNbPoints()+r,s+="##FIRSTX=	"+t.getFirstX()+r,s+="##LASTX=	"+t.getLastX()+r,s+="##FIRSTY=	"+t.getFirstY()+r,s+="##LASTY=	"+t.getLastY()+r,t.isDataClassPeak()?(s+="##XFACTOR=1\r\n",s+="##YFACTOR=1\r\n"):t.isDataClassXY()&&(s+="##XFACTOR= "+1/o+r,s+="##YFACTOR= "+1/e+r),s+="##MAXY= "+t.getMaxY()+r,s+="##MINY= "+t.getMinY()+r,null!=a)for(var f=a.length-1;f>=0;f--)t.containsParam(a[f])&&(s+="##"+a[f]+"= "+t.getParam(a[f],"")+r);if(t.isDataClassPeak()){s+="##PEAK TABLE= (XY..XY)\r\n";for(var u=0;u<t.getNbPoints();u++)s+=t.getX(u)+", "+t.getY(u)+r;s+="##END "}else if(t.isDataClassXY()){s+="##DELTAX= "+t.getDeltaX()+r,s+="##XYDATA=(X++(Y..Y))\r\n";for(var h="",l=new Array(t.getNbPoints()),u=l.length-1;u>=0;u--)l[u]=Math.round(t.getY(u)*e);h+=n.encode(l,t.getFirstX()*o,t.getDeltaX()*o,i),s+=h+r,s+="##END= "}return t.setActiveElement(0),s};return{convert:o}}();t.exports=o},function(t,r){var e=function(){var t="\r\n",r=[["0","1","2","3","4","5","6","7","8","9"],["@","A","B","C","D","E","F","G","H","I"],["@","a","b","c","d","e","f","g","h","i"],["%","J","K","L","M","N","O","P","Q","R"],["%","j","k","l","m","n","o","p","q","r"],[" ","S","T","U","V","W","X","Y","Z","s"]],e=1,n=2,o=3,i=4,a=5,s=100,f=function(t,r,e,n){return"FIX"==n?h(t,r,e):"SQZ"==n?c(t,r,e):"DIF"==n?g(t,r,e):"DIFDUP"==n?p(t,r,e):"CSV"==n?u(t,r,e):"PAC"==n?l(t,r,e):g(t,r,e)},u=function(t,r,e){return h(t,r,e,",")},h=function(r,e,n,o){o||(o=" ");for(var i,a="",s=0,f=r.length;f-7>s;){for(a+=Math.ceil(e+s*n),i=0;8>i;i++)a+=o+r[s++];a+=t}if(f>s)for(a+=Math.ceil(e+s*n),i=s;f>i;i++)a+=o+r[i];return a},l=function(r,e,n){for(var o,i="",a=0,s=r.length;s-7>a;){for(i+=Math.ceil(e+a*n),o=0;8>o;o++)i+=r[a]<0?"-"+r[a++]:"+"+r[a++];i+=t}if(s>a)for(i+=Math.ceil(e+a*n),o=a;s>o;o++)i+=r[o]<0?"-"+r[o]:"+"+r[o];return i},c=function(r,e,n){for(var o,i="",a=0,s=r.length;s-10>a;){for(i+=Math.ceil(e+a*n),o=0;10>o;o++)i+=m(r[a++].toString());i+=t}if(s>a)for(i+=Math.ceil(e+a*n),o=a;s>o;o++)i+=m(r[o].toString());return i},p=function(r,e,n){var o,i=0,a=0,f=0,u="",h="",l="",c=new Array(r.length-1);for(o=0;o<c.length;o++)c[o]=r[o+1]-r[o];for(var p=c.length;p>a;)0==f?(h=Math.ceil(e+a*n)+m(r[a].toString())+v(c[a].toString()),u+=h,f+=h.length):c[a-1]==c[a]?i++:i>0?(i++,h=y(i.toString()),u+=h,f+=h.length,i=0,a--):(h=v(c[a].toString()),h.length+f<s?(u+=h,f+=h.length):(u+=t,l=Math.ceil(e+a*n)+m(r[a].toString())+h,u+=l,f=l.length)),a++;return i>0&&(u+=y((i+1).toString())),u+=t+Math.ceil(e+a*n)+m(r[a].toString())},g=function(r,e,n){var o,i=0,a=0,f="",u="",h="",l=new Array(r.length-1);for(o=0;o<l.length;o++)l[o]=r[o+1]-r[o];i=0;for(var c=l.length;c>i;)0==a?(u=Math.ceil(e+i*n)+m(r[i].toString())+v(l[i].toString()),f+=u,a+=u.length):(u=v(l[i].toString()),u.length+a<s?(f+=u,a+=u.length):(f+=t,h=Math.ceil(e+i*n)+m(r[i].toString())+u,f+=h,a=h.length)),i++;return f+=t+Math.ceil(e+i*n)+m(r[i].toString())},m=function(t){var o="";return"-"==t.charAt(0)?(o+=r[n][Number(t.charAt(1))],t.length>2&&(o+=t.substring(2))):(o+=r[e][Number(t.charAt(0))],t.length>1&&(o+=t.substring(1))),o},v=function(t){var e="";return"-"==t.charAt(0)?(e+=r[i][Number(t.charAt(1))],t.length>2&&(e+=t.substring(2))):(e+=r[o][Number(t.charAt(0))],t.length>1&&(e+=t.substring(1))),e},y=function(t){var e="";return e+=r[a][Number(t.charAt(0))],t.length>1&&(e+=t.substring(1)),e};return{encode:f,FIXencod:h,CSVencod:u,PACencod:l,SQZencod:c,DIFDUPencod:p,DIFencod:p}}();t.exports=e},function(t,r){"use strict";var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,o=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===n.call(t)},i=function(t){if(!t||"[object Object]"!==n.call(t))return!1;var r=e.call(t,"constructor"),o=t.constructor&&t.constructor.prototype&&e.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!o)return!1;var i;for(i in t);return"undefined"==typeof i||e.call(t,i);
};t.exports=function a(){var t,r,e,n,s,f,u=arguments[0],h=1,l=arguments.length,c=!1;for("boolean"==typeof u?(c=u,u=arguments[1]||{},h=2):("object"!=typeof u&&"function"!=typeof u||null==u)&&(u={});l>h;++h)if(t=arguments[h],null!=t)for(r in t)e=u[r],n=t[r],u!==n&&(c&&n&&(i(n)||(s=o(n)))?(s?(s=!1,f=e&&o(e)?e:[]):f=e&&i(e)?e:{},u[r]=a(c,f,n)):"undefined"!=typeof n&&(u[r]=n));return u}},function(t,r,e){function n(t){o.call(this,t)}var o=e(1),i=e(8),a=e(3);n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.fromJcamp=function(t,r){r=r||{xy:!0,keepSpectra:!0,keepRecordsRegExp:/^.+$/};var e=a.convert(t,r);return new n(e)},n.prototype.getNucleus=function(t){return t&&0!=t&&1!=t?"":this.sd.xType},n.prototype.getSolventName=function(){return(this.sd.info[".SOLVENTNAME"]||this.sd.info.$SOLVENT||"").replace("<","").replace(">","")},n.prototype.observeFrequencyX=function(){return this.sd.spectra[0].observeFrequency},n.prototype.getNMRPeakThreshold=function(t){return"1H"==t?3:"13C"==t?5:1},n.prototype.addNoise=function(t){},n.prototype.addSpectraDatas=function(t,r,e,n){},n.prototype.autoBaseline=function(){},n.prototype.fourierTransform=function(){},n.prototype.postFourierTransform=function(t){},n.prototype.zeroFilling=function(t,r){},n.prototype.haarWhittakerBaselineCorrection=function(t,r){},n.prototype.whittakerBaselineCorrection=function(t,r){},n.prototype.brukerSpectra=function(t){},n.prototype.apodization=function(t,r){},n.prototype.echoAntiechoFilter=function(){},n.prototype.SNVFilter=function(){},n.prototype.powerFilter=function(t){var r=this.getMinY();1>t&&0>r&&(this.YShift(-1*r),console.warn("SD.powerFilter: The spectrum had negative values and was automatically shifted before applying the function."))},n.prototype.logarithmFilter=function(t){var r=this.getMinY();0>=r&&(this.YShift(-1*r+1),console.warn("SD.logarithmFilter: The spectrum had negative values and was automatically shifted before applying the function."))},n.prototype.correlationFilter=function(t){},n.prototype.phaseCorrection=function(t,r){},n.prototype.automaticPhase=function(){},n.prototype.useBrukerPhase=function(){},n.prototype.nmrPeakDetection=function(t){return i.peakPicking(this,t)},t.exports=n},function(t,r,e){var n=e(9),o=e(10),i=e(6),a={impurities:[],maxJ:20,defaultOptions:{nH:10,clean:!0,realTop:!1,thresholdFactor:1,compile:!0,integralFn:0,optimize:!0,id:""},peakPicking:function(t,r){var e,a,s,f,u=i({},this.defaultOptions,r),h=Math.abs(t.getNoiseLevel())*u.thresholdFactor,l=i({},{noiseLevel:h,minMaxRatio:.01,broadRatio:.0025,smoothY:!0,nL:4,sgOptions:{windowSize:9,polynomial:3}},u.gsdOptions),c=t.getXYData(),p=o.gsd(c[0],c[1],l),p=o.post.joinBroadPeaks(p,{width:.25});u.optimize&&(p=o.post.optimizePeaks(p,c[0],c[1],l.nL,"lorentzian")),p=this.clearList(p,h);var g=this.detectSignals(p,t,u.nH,u.integralFn);if(u.clean)for(var e=g.length-1;e>=0;e--)g[e].integralData.value<.5&&g.splice(e,1);if(u.compile){for(e=0;e<g.length;e++)if(n.compilePattern(g[e]),g[e].maskPattern&&"m"!=g[e].multiplicity&&""!=g[e].multiplicity){s=0,f=0;var m=[];for(a=g[e].maskPattern.length-1;a>=0;a--)if(f+=this.area(g[e].peaks[a]),g[e].maskPattern[a]===!1){var v=g[e].peaks.splice(a,1)[0];m.push({x:v.x,y:v.intensity,width:v.width}),g[e].mask.splice(a,1),g[e].mask2.splice(a,1),g[e].maskPattern.splice(a,1),g[e].nbPeaks--,s+=this.area(v)}if(m.length>0){s=s*g[e].integralData.value/f,g[e].integralData.value-=s;for(var y=[],a=m.length-1;a>=0;a--)y.push(m[a]);var d=this.detectSignals(y,t,s,u.integralFn);for(a=0;a<d.length;a++)g.push(d[a])}}this.updateIntegrals(g,u.nH)}if(g.sort(function(t,r){return r.delta1-t.delta1}),u.clean)for(var e=g.length-1;e>=0;e--)g[e].integralData.value<.5&&g.splice(e,1);for(var e=0;e<g.length;e++)u.id&&u.id.length>0?g[e].signalID=u.id+"_"+(e+1):g[e].signalID=e+1+"",g[e]._highlight=[g[e].signalID];return g},clearList:function(t,r){for(var e=t.length-1;e>=0;e--)Math.abs(t[e].y)<r&&t.splice(e,1);return t},sampling:function(t,r,e){var n,o,i,a,s,f=[];if(n>o){var u=n;n=o,o=u}for(a=0;a<r.length;a++)for(var h=!0,l=4;h;)if(n=t.unitsToArrayPoint(r[a][0]-r[a][2]*l),o=t.unitsToArrayPoint(r[a][0]+r[a][2]*l),i=t.unitsToArrayPoint(r[a][0]),n>o&&(u=n,n=o,o=u),n=0>n?0:n,o=o>=t.getNbPoints()?t.getNbPoints()-1:o,10>o-n){for(s=n;o>=s;s++)f.push([t.getX(s),t.getY(s)]);h=!1}else f.push([t.getX(n),t.getY(n)]),f.push([t.getX(o),t.getY(o)]),l>.5?l-=.5:l/=2;f.sort(function(t,r){return t[0]-r[0]});var c=[],p=[],g=0;if(e)for(c=[f[0][0]],p=[f[0][1]],a=1;a<f.length;a++)c[g]!=f[a][0]&&(c.push(f[a][0]),p.push(f[a][1]),g++);else for(c=[[f[0][0]]],p=[[f[0][1]]],a=1;a<f.length;a++)c[g][0]!=f[a][0]&&(c.push([f[a][0]]),p.push([f[a][1]]),g++);return[c,p]},getVector:function(t,r,e,n){var o=t.unitsToArrayPoint(r),i=t.unitsToArrayPoint(e),a=[],s=[];if(o>i){var f=o;o=i,i=f}o=0>o?0:o,i=i>=t.getNbPoints()?t.getNbPoints()-1:i;for(var u=o;i>u;u+=10)n?(s.push(t.getY(u)),a.push(t.getX(u))):(s.push([t.getY(u)]),a.push([t.getX(u)]));return[a,s]},updateLimits:function(t){if("m"!=t.multiplicity&&""!=t.multiplicity){for(var r=t.peaks,e=r.length,n=0,o=0,i=0;e>i;i++)t.maskPattern[i]===!1&&(o+=this.area(r[i])),n+=this.area(r[i]);n=t.integralData.value/n,t.integralData.value-=o*n}return t.integralData.value},updateIntegrals:function(t,r){var e,n=0,o=0;for(e=0;e<t.length;e++)o+=Math.round(t[e].integralData.value);if(o!=r)for(n=r/o,e=0;e<t.length;e++)t[e].integralData.value*=n},detectSignals:function(t,r,e,n){var o,i,a,s,f=r.observeFrequencyX(),u=[],h={},l={x:1e5,y:0,width:0},c=null,p=16/f,g=0;for(a=0;a<t.length;a++){if(Math.abs(t[a].x-l.x)>p)h={nbPeaks:1,units:"PPM",startX:t[a].x+t[a].width,stopX:t[a].x-t[a].width,multiplicity:"",pattern:"",observe:f,nucleus:"1H",integralData:{from:t[a].x-3*t[a].width,to:t[a].x+3*t[a].width},peaks:[]},h.peaks.push({x:t[a].x,intensity:t[a].y,width:t[a].width}),u.push(h);else{var m=t[a].x-t[a].width;h.stopX=Math.min(h.stopX,m),m=t[a].x+t[a].width,h.stopX=Math.max(h.stopX,m),h.nbPeaks++,h.peaks.push({x:t[a].x,intensity:t[a].y,width:t[a].width}),h.integralData.from=Math.min(h.integralData.from,t[a].x-3*t[a].width),h.integralData.to=Math.max(h.integralData.to,t[a].x+3*t[a].width)}l=t[a]}for(a=0;a<u.length;a++){c=u[a].peaks;var v=u[a].integralData;o=0,i=0;for(var s=0;s<c.length;s++)o+=c[s].x*this.area(c[s]),i+=this.area(c[s]);u[a].delta1=o/i,0==n?v.value=i:v.value=r.getArea(v.from,v.to),g+=v.value}for(var a=0;a<u.length;a++){var v=u[a].integralData;v.value*=e/g}return u},area:function(t){return Math.abs(t.intensity*t.width*1.57)},labelPeaks:function(t,r,e){var n=0;for(n=4;n<this.impurities.length&&!(this.impurities[0][n].indexOf(r)>=0);n++);for(var o,i=this.impurities.length-1,a=t.length,s=new Array(i),f=0,u=0,h=0,l=.2,c=-1,p="",g=0,m=a-1;m>=0;m--)t[m][1]>g&&(g=t[m][1]);for(o=i-1;o>=0;o--){this.impurities[o+1][0]!=p&&(c++,p=this.impurities[o+1][0]),s[o]=[c,this.impurities[o+1][2],this.impurities[o+1][3],0,[],0],f=0;for(var m=a-1;m>=0;m--)u=1e4,this.impurities[o+1][n]>0&&(u=Math.abs(t[m][0]-this.impurities[o+1][n])),3*l>u&&(h=this.score(u,l),h>f&&(f=h,s[o][3]=f,s[o][4]=[m]))}for(var v=-1,y=0,d=0,w=[],M=[],o=i-1;o>=-1;){if(-1==o||s[o][0]!=v&&-1!=v){if(-1!=v&&(s[o+1][5]=y/d,s[o+1][5]>.9&&(h=this.updateScore(w,t,g,e),h>.9)))for(var m=0;m<w.length;m++)for(var b=w[m][4].length-1;b>=0;b--)M.push(t[w[m][4][b]]);o>=0&&(v=s[o][0],y=s[o][3],d=1,w=[s[o]])}else v=s[o][0],w.push(s[o]),y+=s[o][3],d++;o--}return M},updateScore:function(t,r,e,n){for(var o,i,a="",s=0,f=(this.maxJ/n,0),u=0,h=0,l=t.length-1;l>=0;l--){if(a=t[l][1],s=t[l][2],o=t[l][4][0],a.indexOf("sep")>=0)r[o][1]>.33*e&&t.splice(l,1);else if(a.indexOf("s")>=0||a.indexOf("X")>=0){for(i=o-1,f=r[o][1],u=o;i>=0&&Math.abs(r[o][0]-r[i][0])<.025;)r[i][1]<f&&(f=r[i][1],u=i),i--;for(i=o+1;i<r.length&&Math.abs(r[o][0]-r[i][0])<.025;)r[i][1]<f&&(f=r[i][1],u=i),i++;t[l][4][0]=u,h+=1}if(a.indexOf("d")>=0&&o>0&&o<r.length-1){var c=Math.abs(Math.abs(r[o-1][0]-r[o][0])*n-s),p=Math.abs(Math.abs(r[o+1][0]-r[o][0])*n-s),g=Math.abs(Math.abs(r[o+1][0]-r[o-1][0])*n-s);(2>c||2>p||2>g)&&(p>c?g>c?(t[l][4]=[o-1,o],h+=1):(t[l][4]=[o-1,o+1],h+=1):g>p?(t[l][4]=[o,o+1],h+=1):(t[l][4]=[o-1,o+1],h+=1))}if(a.indexOf("t")>=0&&o>0&&o<r.length-1){var c=Math.abs(Math.abs(r[o-1][0]-r[o][0])*n-s),p=Math.abs(Math.abs(r[o+1][0]-r[o][0])*n-s),m=Math.abs(Math.abs(r[o+1][0]-r[o+2][0])*n-s);2>c&&(t[l][4]=[o-1,o],h+=.5),2>p&&(t[l][4].push(o+1),h+=.5),2>g&&(t[l][4].push(o+2),h+=.5)}if(a.indexOf("q")>=0&&o>1&&o<r.length-2){var c=Math.abs(Math.abs(r[o-2][0]-r[o-1][0])*n-s),p=Math.abs(Math.abs(r[o-1][0]-r[o][0])*n-s),g=Math.abs(Math.abs(r[o+1][0]-r[o][0])*n-s),m=Math.abs(Math.abs(r[o+2][0]-r[o+1][0])*n-s);2>c&&(t[l][4].push(o-2),h+=.25),2>p&&(t[l][4].push(o-1),h+=.25),2>g&&(t[l][4].push(o+1),h+=.25),2>m&&(t[l][4].push(o+2),h+=.25)}}if(h/t.length<.5){for(var l=t.length-1;l>=0;l--)t.splice(l,1);return 0}return 1},score:function(t,r){return Math.exp(-Math.pow(t/r,2)/2)},createSignals:function(){}};t.exports=a},function(t,r){var e={pascalTriangle:[[0],[1],[1,1],[1,2,1],[1,3,3,1],[1,4,6,4,1],[1,5,10,10,5,1],[1,6,15,20,15,6,1]],patterns:["s","d","t","q","quint","h","sept","o","n"],symRatio:1.5,maxErrorIter1:2.5,maxErrorIter2:1,DEBUG:!1,compilePattern:function(t){if(this.DEBUG&&console.log("Debugin..."),t.multiplicity="m",t.symRank=this.symmetrizeChoiseBest(t,this.maxErrorIter1,1),t.asymmetric=!0,t.symRank>=.95&&t.peaksComp.length<32){this.DEBUG&&console.log(t.delta1+" nbPeaks "+t.peaksComp.length),t.asymmetric=!1;for(var r,e,n,o,i,a=1,s=[],f=0;9>f;f++){this.DEBUG&&console.log("Trying "+f+" couplings"),peaks=this.normalize(t,f);var u=!1;if(1==peaks.length&&0===f)u=!0;else if(peaks.length<=1)continue;var h=this.getRanges(peaks);o=Math.pow(2,f),this.DEBUG&&(console.log("ranges: "+JSON.stringify(h)),console.log("Target sum: "+o));for(var l=null;!u&&null!==(l=this.getNextCombination(h,o));){this.DEBUG&&(console.log("Possible pattern found with "+f+" couplings!!!"),console.log(l));var c=new Array(l.length);for(a=1,r=0;r<l.length;r++)for(c[r]=new Array(l[r]),e=0;e<l[r];e++)c[r][e]=a++;this.DEBUG&&console.log("Numbering: "+JSON.stringify(c)),s=[],e=1,s.push(peaks[1].x-peaks[0].x),n=peaks[0].x,c[0].splice(0,1),c[1].splice(0,1),a=1;var p=2;for(i=Math.pow(2,f)-1;s.length<f&&i>p&&a<peaks.length;){for(this.DEBUG&&(console.log("New Jc"+JSON.stringify(s)),console.log("Aval. numbering "+JSON.stringify(c))),e++;a<peaks.length&&0===c[a].length;)a++;if(a<peaks.length){s.push(peaks[a].x-peaks[0].x),c[a].splice(0,1),p++;for(var g=2;e>=g;g++){var m=0;for(r=0;g>r;r++)m+=s[r];for(r=1;r<c.length;r++)if(Math.abs(peaks[r].x-(n+m))<.25){c[r].splice(0,1),p++;break}}}}var v=this.idealPattern(s);for(u=!0,r=0;r<v.length;r++)v[r].intensity!=l[r]&&(u=!1);this.DEBUG&&(console.log("Jc "+JSON.stringify(s)),console.log("Heights "+JSON.stringify(l)),console.log("pattern "+JSON.stringify(v)),console.log("Valid? "+u))}u&&this.updateSignal(t,s)}}for(r=0;r<t.peaksComp.length;r++)t.peaksComp[r].x/=t.observe},updateSignal:function(t,r){var e=t.peaksComp,n=e.length;t.startX=e[0].x/t.observe+e[0].width,t.stopX=e[n-1].x/t.observe-e[n-1].width,t.integralData.to=e[0].x/t.observe+3*e[0].width,t.integralData.from=e[n-1].x/t.observe-3*e[n-1].width,t.maskPattern=t.mask2,t.multiplicity=this.abstractPattern(t,r),t.pattern=t.multiplicity,this.DEBUG&&console.log("Final j-couplings: "+JSON.stringify(r))},abstractPattern:function(t,r){var e,n=.05,o="",i=1,a=[];if(r&&r.length>0){for(r.sort(function(t,r){return t-r}),e=0;e<r.length-1;e++)Math.abs(r[e]-r[e+1])<n?i++:(a.push({coupling:Math.abs(r[e]),multiplicity:this.patterns[i]}),o+=this.patterns[i],i=1);a.push({coupling:Math.abs(r[e]),multiplicity:this.patterns[i]}),o+=this.patterns[i],t.nmrJs=a}else o="s",Math.abs(t.startX-t.stopX)*t.observe>16&&(o="bs");return o},idealPattern:function(t){var r,e,n=Math.pow(2,t.length),o=[{x:0,intensity:n}];for(r=0;r<t.length;r++)for(e=o.length-1;e>=0;e--)o.push({x:o[e].x+t[r]/2,intensity:o[e].intensity/2}),o[e].x=o[e].x-t[r]/2,o[e].intensity=o[e].intensity/2;for(o.sort(function(t,r){return t.x-r.x}),e=o.length-2;e>=0;e--)Math.abs(o[e].x-o[e+1].x)<.1&&(o[e].intensity+=o[e+1].intensity,o.splice(e+1,1));return o},getNextCombination:function(t,r){for(var e,n=Math.ceil(t.values.length/2),o=t.values.length,i=0;i!=r;){ok=!1;for(;!ok;)if(ok=!0,t.currentIndex[t.active]++,t.currentIndex[t.active]>=t.values[t.active].length){if(t.active+1==n)return null;t.currentIndex[t.active]=0,ok=!1,t.active++}else t.active=0;for(i=0,e=0;n>e;e++)i+=2*t.values[e][t.currentIndex[e]];t.values.length%2!==0&&(i-=t.values[n-1][t.currentIndex[n-1]]),this.DEBUG&&(console.log(t.currentIndex),console.log(i+" "+r))}if(i==r){var a=new Array(o);for(e=0;n>e;e++)a[e]=t.values[e][t.currentIndex[e]],a[o-e-1]=t.values[e][t.currentIndex[e]];return a}return null},getRanges:function(t){var r,e,n=new Array(t.length),o=new Array(t.length);n[0]=[1],n[t.length-1]=[1],o[0]=-1,o[t.length-1]=0;for(var i=1;i<t.length-1;i++){r=Math.round(.85*t[i].intensity),e=Math.round(1.15*t[i].intensity),n[i]=[];for(var a=r;e>=a;a++)n[i].push(a);o[i]=0}return{values:n,currentIndex:o,active:0}},symmetrizeChoiseBest:function(t,r,e){var n=this.symmetrize(t,r,e),o=t.peaksComp,i=t.mask,a=t.delta1;t.delta1=(t.peaks[0].x+t.peaks[t.peaks.length-1].x)/2;var s=this.symmetrize(t,r,e);return t.peaksComp.length>o.length?s:(t.delta1=a,t.peaksComp=o,t.mask=i,n)},symmetrize:function(t,r,e){var n,o,i,a,s,f=new Array(t.peaks.length);for(j=0;j<f.length;j++)f[j]={x:t.peaks[j].x*t.observe,intensity:t.peaks[j].intensity,width:t.peaks[j].width};for(j=f.length-2;j>=0;j--)Math.abs(f[j].x-f[j+1].x)<.25&&(f[j].x=f[j].x*f[j].intensity+f[j+1].x*f[j+1].intensity,f[j].intensity=f[j].intensity+f[j+1].intensity,f[j].x/=f[j].intensity,f[j].intensity/=2,f[j].width+=f[j+1].width,f.splice(j+1,1));t.peaksComp=f;var u=f.length,h=new Array(u);t.mask=h;var l=0,c=f.length-1,p=t.delta1*t.observe,g=[(f[0].x+f[u-1].x)/2,1];r=this.error(Math.abs(p-g[0]));for(var m=0,v=0;u>v;v++)h[v]=!0,m+=t.peaks[v].intensity;for(;c>=l;){if(h[l]=!0,h[c]=!0,l==c)u>2&&Math.abs(f[l].x-p)>r&&(h[l]=!1);else if(n=Math.max(f[l].intensity,f[c].intensity),o=Math.min(f[l].intensity,f[c].intensity),a=n/o,a>this.symRatio)f[l].intensity==o?(h[l]=!1,c++):(h[c]=!1,l--);else{var y=Math.abs(f[l].x-p),d=Math.abs(f[c].x-p);Math.abs(y-d)<r?(i=Math.min(f[l].intensity,f[c].intensity),s=Math.min(f[l].width,f[c].width),f[l].intensity=f[c].intensity=i,f[l].width=f[c].width=s,g=[g[0]+(f[c].x+f[l].x)/2,g[1]+1]):Math.max(y,d)==d?(h[c]=!1,l--):(h[l]=!1,c++),this.DEBUG&&(console.log("MaxError: "+r+" "+g[0]+" "+g[1]),console.log(e+" CS: "+p+" Hz "+p/t.observe+" PPM"),console.log("Middle: "+g[0]/g[1]+" Hz "+g[0]/g[1]/t.observe+" PPM"),console.log(y+" "+d),console.log(Math.abs(y-d)),console.log(JSON.stringify(f)),console.log(JSON.stringify(h)))}if(l++,c--,1==e&&(p=this.chemicalShift(f,h),isNaN(p)))return 0;r=this.error(Math.abs(p-g[0]/g[1]))}for(v=u-1;v>=0;v--)h[v]===!1&&f.splice(v,1);if(p=this.chemicalShift(f),isNaN(p))return 0;t.delta1=p/t.observe;var w=0,M=0;if(f.length>1){for(v=Math.ceil(f.length/2)-1;v>=0;v--)w+=(3+Math.min(Math.abs(f[v].x-p),Math.abs(f[f.length-1-v].x-p)))/(3+Math.max(Math.abs(f[v].x-p),Math.abs(f[f.length-1-v].x-p)))*f[v].intensity,M+=f[v].intensity;w/=M}else 1==f.length&&(w=1);var b=0;for(v=0;v<f.length;v++)b+=f[v].intensity;if(w-=(m-b)/m*.12,this.DEBUG&&(console.log("Penalty "+(m-b)/m*.12),console.log("cs: "+p/t.observe+" symFactor: "+w)),w>.8&&.97>w&&2>e)return this.symmetrize(t,this.maxErrorIter2,2);if(f.length>1){var x,M=0;for(v=Math.ceil(f.length/2)-1;v>=0;v--)x=(f[v].x-f[f.length-1-v].x)/2,f[v].x=p+x,f[f.length-1-v].x=p-x}return w},error:function(t){var r=2.5*t;return.75>r&&(r=.75),r>3&&(r=3),r},normalize:function(t,r){var e,n=JSON.parse(JSON.stringify(t.peaksComp)),o=0,i=0;for(e=0;e<n.length;e++)o+=n[e].intensity;o=Math.pow(2,r)/o,t.mask2=JSON.parse(JSON.stringify(t.mask));var a=t.mask2.length-1;for(e=n.length-1;e>=0;e--){for(n[e].intensity*=o;a>=0&&t.mask2[a]===!1;)a--;n[e].intensity<.75?(this.DEBUG&&console.log("Peak "+e+" does not seem to belong to this multiplet "+n[e].intensity),n.splice(e,1),t.mask2[a]=!1):i+=n[e].intensity,a--}for(i=Math.pow(2,r)/i,e=n.length-1;e>=0;e--)n[e].intensity*=i;return this.DEBUG&&console.log(JSON.stringify(n)),n},chemicalShift:function(t,r){var e,n,o=0,i=0;if(r)for(e=0;e<t.length;e++)r[e]===!0&&(n=this.area(t[e]),o+=n,i+=n*t[e].x);else for(e=0;e<t.length;e++)n=this.area(t[e]),o+=n,i+=n*t[e].x;return i/o},area:function(t){return Math.abs(t.intensity*t.width*1.57)}};t.exports=e},function(t,r,e){t.exports.post=e(11),t.exports.gsd=e(34)},function(t,r,e){function n(t,r,e,n,o){var i=e.length,a=[],s=[],f=Math.sign(e[1]-e[0]);-1==f&&(o[0]=e.length-1);for(var u=Math.abs(r-t)/2,h=(t+r)/2,l=!1,c=o[0];!l&&i>c&&c>=0;)Math.abs(e[c]-h)<=u?(a.push(e[c]),s.push(n[c]),c+=f):1==Math.sign(h-e[c])?c+=f:l=!0;return o[0]=c,[a,s]}function o(t,r,e,o,a){var f,u,h=[0],l=i(t,o),c=[],p=1;for("gaussian"==a&&(p=1.17741),f=0;f<l.length;f++){var g=l[f].group;if(g.length>1){var m=n(l[f].limits[0]-l[f].limits[1],l[f].limits[0]+l[f].limits[1],r,e,h);if(m[0].length>5){var v=g[0].width/1e3,y=[3,100,v,v,v,10*v,10*v,11,9,1],d=[];for("gaussian"==a?d=s.optimizeGaussianSum(m,g,y):"lorentzian"==a&&(d=s.optimizeLorentzianSum(m,g,y)),u=0;u<d.length;u++)c.push({x:d[u][0][0],y:d[u][1][0],width:d[u][2][0]*p})}}else{g=g[0];var m=n(g.x-o*g.width,g.x+o*g.width,r,e,h);if(m[0].length>5){var v=g.width/1e3,y=[3,100,v,v,v,10*v,10*v,11,9,1],w=[];if("gaussian"==a)var w=s.optimizeSingleGaussian([m[0],m[1]],g,y);else if("lorentzian"==a)var w=s.optimizeSingleLorentzian([m[0],m[1]],g,y);c.push({x:w[0][0],y:w[1][0],width:w[2][0]*p})}}}return c}function i(t,r){var e,n,o,i,a=[],s=[],f=[t[0].x,r*t[0].width];for(e=0;e<t.length;e++)Math.abs(t[e].x-f[0])<r*t[e].width+f[1]?(a.push(t[e]),o=f[0]+f[1],t[e].x+r*t[e].width>o&&(o=t[e].x+r*t[e].width),i=f[0]-f[1],t[e].x-r*t[e].width<i&&(i=t[e].x-r*t[e].width),f=[(o+i)/2,Math.abs(o-i)/2]):(s.push({limits:f,group:a}),a=[t[e]],f=[t[e].x,r*t[e].width]);for(s.push({limits:f,group:a}),e=s.length-2;e>=0;e--)if(Math.abs(s[e].limits[0]-s[e+1].limits[0])<(s[e].limits[1]+s[e+1].limits[1])/2){for(n=0;n<s[e+1].group.length;n++)s[e].group.push(s[e+1].group[n]);o=s[e].limits[0]+s[e].limits[1],s[e+1].limits[0]+s[e+1].limits[1]>o&&(o=s[e+1].limits[0]+s[e+1].limits[1]),i=s[e].limits[0]-s[e].limits[1],s[e+1].limits[0]-s[e+1].limits[1]<i&&(i=s[e+1].limits[0]-s[e+1].limits[1]),s[e].limits=[(o+i)/2,Math.abs(o-i)/2],s.splice(e+1,1)}return s}function a(t,r){for(var e=r.width,n=[],o=0,i=0,a=1,f=t.length-1;f>=0;f--)t[f].soft&&n.push(t.splice(f,1)[0]);n.push({x:Number.MAX_VALUE});for(var u=[[n[0].x,n[0].y]],h=[0],f=1;f<n.length;f++)if(Math.abs(n[f-1].x-n[f].x)<e)u.push([n[f].x,n[f].y]),n[f].y>o&&(o=n[f].y,i=f),h.push(f),a++;else{if(a>2){var l=s.optimizeSingleLorentzian(u,{x:n[i].x,y:o,width:Math.abs(u[0][0]-u[u.length-1][0])});t.push({x:l[0][0],y:l[1][0],width:l[2][0],soft:!1})}else h.map(function(r){t.push(n[r])});u=[[n[f].x,n[f].y]],h=[f],o=n[f].y,i=f,a=1}return t.sort(function(t,r){return t.x-r.x}),t}var s=e(12);t.exports={optimizePeaks:o,joinBroadPeaks:a}},function(t,r,e){"use strict";function n(t,r,e){var n,o,i,a,s=r.length/3,f=t.rows,u=p.zeros(t.length,1);for(o=0;s>o;o++)for(a=Math.pow(r[o+2*s][0]/2,2),n=r[o+s][0]*a,i=0;f>i;i++)u[i][0]+=n/(Math.pow(t[i][0]-r[o][0],2)+a);return u}function o(t,r,e){for(var n=r[1][0]*Math.pow(r[2][0]/2,2),o=t.rows,i=new p(t.rows,t.columns),a=0;o>a;a++)i[a][0]=n/(Math.pow(t[a][0]-r[0][0],2)+Math.pow(r[2][0]/2,2));return i}function i(t,r,e){for(var n=r[2][0]*r[2][0]/2,o=t.rows,i=new p(t.rows,t.columns),a=0;o>a;a++)i[a][0]=r[1][0]*Math.exp(-(t[a][0]-r[0][0])*(t[a][0]-r[0][0])/n);return i}function a(t,r,e){var n=h(t),i=n[0],a=n[1],s=n[2],f=i.columns,u=[f/Math.sqrt(a.dot(a))],e=Object.create(e||[3,100,.001,.001,.001,.01,.01,11,9,1]),c=[],g=Math.abs(i[0][0]-i[1][0]),m=new p([[-g/1e4],[-.001],[-g/1e4]]),v=new p([[r.x],[1],[r.width]]),y=new p([[r.x-g],[.75],[r.width/4]]),d=new p([[r.x+g],[1.25],[4*r.width]]),w=l.optimize(o,v,i,a,u,m,y,d,c,e);return w=w.p,[w[0],[w[1][0]*s],w[2]]}function s(t,r,e){var n=h(t),o=n[0],a=n[1],s=n[2],f=o.columns,u=[f/Math.sqrt(a.dot(a))],e=Object.create(e||[3,100,.001,.001,.001,.01,.01,11,9,1]),c=[],g=Math.abs(o[0][0]-o[1][0]),m=new p([[-g/1e4],[-.001],[-g/1e4]]),m=new p([[-Math.abs(o[0][0]-o[1][0])/1e3],[-.001],[-r.width/1e3]]),v=new p([[r.x],[1],[r.width]]),y=new p([[r.x-g],[.75],[r.width/4]]),d=new p([[r.x+g],[1.25],[4*r.width]]),w=l.optimize(i,v,o,a,u,m,y,d,c,e);return w=w.p,[w[0],[w[1][0]*s],w[2]]}function f(t,r,e){var o,i=h(t),a=i[0],s=i[1],f=i[2],u=a.columns,g=[u/c.sqrt(s.dot(s))],e=Object.create(e||[3,100,.001,.001,.001,.01,.01,11,9,1]),m=[],v=r.length,y=new p(3*v,1),d=new p(3*v,1),w=new p(3*v,1),M=new p(3*v,1),b=Math.abs(a[0][0]-a[1][0]);for(o=0;v>o;o++)y[o][0]=r[o].x,y[o+v][0]=1,y[o+2*v][0]=r[o].width,d[o][0]=r[o].x-b,d[o+v][0]=0,d[o+2*v][0]=r[o].width/4,w[o][0]=r[o].x+b,w[o+v][0]=1.5,w[o+2*v][0]=4*r[o].width,M[o][0]=-b/1e3,M[o+v][0]=-.001,M[o+2*v][0]=-b/1e3;var M=-Math.abs(a[0][0]-a[1][0])/1e4,x=l.optimize(n,y,a,s,g,M,d,w,m,e);x=x.p;var A=new Array(v);for(o=0;v>o;o++)A[o]=[x[o],[x[o+v][0]*f],x[o+2*v]];return A}function u(t,r,e){var o,i=h(t),a=i[0],s=i[1],f=i[2],u=a.rows,g=new p(u,1),m=u/c.sqrt(s.dot(s));for(o=0;u>o;o++)g[o][0]=m;var e=Object.create(e||[3,100,.001,.001,.001,.01,.01,11,9,2]),v=[],y=r.length,d=new p(3*y,1),w=new p(3*y,1),M=new p(3*y,1),b=new p(3*y,1),x=Math.abs(a[0][0]-a[1][0]);for(o=0;y>o;o++)d[o][0]=r[o].x,d[o+y][0]=r[o].y/f,d[o+2*y][0]=r[o].width,w[o][0]=r[o].x-x,w[o+y][0]=.8*r[o].y/f,w[o+2*y][0]=r[o].width/2,M[o][0]=r[o].x+x,M[o+y][0]=1.2*r[o].y/f,M[o+2*y][0]=2*r[o].width,b[o][0]=-x/1e3,b[o+y][0]=-.001,b[o+2*y][0]=-x/1e3;var A=l.optimize(n,d,a,s,g,b,w,M,v,e);A=A.p;var S=new Array(y);for(o=0;y>o;o++)S[o]=[A[o],[A[o+y][0]*f],A[o+2*y]];return S}function h(t){var r,e,n,o=t.length,i=null,a=null,s=0;if(2==o){var f=t[0].length;if(3>f)throw new SizeException(f);if(i=new p(f,1),a=new p(f,1),r=t[0],e=t[1],"number"==typeof r[0])for(n=0;f>n;n++)i[n][0]=r[n],a[n][0]=e[n],e[n]>s&&(s=e[n]);else if("object"==typeof r[0])for(n=0;f>n;n++)i[n][0]=r[n][0],a[n][0]=e[n][0],e[n][0]>s&&(s=e[n][0])}else{var f=o;if(3>f)throw new SizeException(f);for(i=new p(f,1),a=new p(f,1),n=0;f>n;n++)i[n][0]=t[n][0],a[n][0]=t[n][1],a[n][0]>s&&(s=a[n][0])}for(n=0;f>n;n++)a[n][0]/=s;return[i,a,s]}var l=e(13),c=l.Matrix.algebra,p=e(25);t.exports.optimizeSingleLorentzian=a,t.exports.optimizeLorentzianSum=f,t.exports.optimizeSingleGaussian=s,t.exports.optimizeGaussianSum=u,t.exports.singleGaussian=i,t.exports.singleLorentzian=o},function(t,r,e){"use strict";t.exports=e(14),t.exports.Matrix=e(15),t.exports.Matrix.algebra=e(24)},function(t,r,e){var n=e(15),o=e(24),i={optimize:function(t,r,e,i,a,s,f,u,h,l){var c=0,p=0;if("object"!=typeof r[0])for(var g=0;g<r.length;g++)r[g]=[r[g]];var g,m,v=-50,y=r.length,d=i.length,w=n.zeros(y,1),M=n.zeros(d,1),b=.01/v,x=.01/v,A=n.zeros(d,y);if(e.length!=i.length){console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=e.length,length_y_dat=i.length;var b=0;if(!c)return}a=a||Math.sqrt((d-y+1)/o.multiply(o.transpose(i),i)),s=s||.001,f=f||o.multiply(Math.abs(r),-100),u=u||o.multiply(Math.abs(r),100),h=h||1,l=l||[3,10*y,.001,.001,.001,.01,.01,11,9,1];var S=l[0],D=l[1],E=l[2],R=(l[3],l[4],l[5]),k=l[6],P=l[7],F=l[8],X=l[9];if(c&&3==S&&(S=2),!s.length||1==s.length){for(var Y=new Array(y),g=0;y>g;g++)Y[g]=[s];s=Y}var N=[];for(g=0;g<s.length;g++)0!=s[g][0]&&N.push(g);var C=N.length,T=!1,I=null;if(!a.length||a.length<d){var O=o.multiply(n.ones(d,1),a[0]);I=o.dotMultiply(O,O)}else I=o.dotMultiply(a,a);var V=this.lm_matx(t,e,w,M,1,A,r,i,I,s,h),z=V.JtWJ,U=V.JtWdy,b=V.Chi_sq,L=V.y_hat,A=V.J;switch(Math.max(Math.abs(U))<E&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",E),T=!0),X){case 1:lambda=k;break;default:lambda=k*Math.max(o.diag(z)),nu=2}x=b;for(var j=null;!T&&D>=p;){switch(p+=1,X){case 1:j=o.solve(o.add(z,o.multiply(o.diag(o.diag(z)),lambda)),U);break;default:j=o.solve(o.add(z,o.multiply(n.eye(y),lambda)),U)}var _=new Array(N.length);for(m=0;m<N.length;m++)_[m]=j[N[m]];var q=o.add(r,_);for(m=0;m<q.length;m++)q[m][0]=Math.min(Math.max(f[m][0],q[m][0]),u[m][0]);var $=o.subtract(i,t(e,q,h)),B=o.multiply(o.transpose($),o.dotMultiply($,I));if(2==X){var J=o.multiply(o.transpose(U),j),G=o.multiply(J,o.inv(o.add(o.multiply(o.subtract(B-b),.5)),o.multiply(J,2)));j=o.multiply(G,j);for(var m=0;m<N.length;m++)_[m]=j[N[m]];q=o.add(r,_),q=o.min(o.max(f,q),u),$=o.subtract(i,t(e,q,h)),B=o.multiply(o.transpose($),mat.dotMultiply($,I))}var Q=(b-B)/o.multiply(o.multiply(o.transpose(j),2),o.add(o.multiply(lambda,j),U));if(Q>R)switch(dX2=b-x,x=b,w=r,M=L,r=q,V=this.lm_matx(t,e,w,M,dX2,A,r,i,I,s,h),z=V.JtWJ,U=V.JtWdy,b=V.Chi_sq,L=V.y_hat,A=V.J,X){case 1:lambda=Math.max(lambda/F,1e-7);break;case 2:lambda=Math.max(lambda/(1+G),1e-7);break;case 3:lambda=o.multiply(Math.max(1/3,1-(2*Q-1)^3),lambda),nu=2}else switch(b=x,p%(2*y)==0&&(V=this.lm_matx(t,e,w,M,-1,A,r,i,I,s,h),z=V.JtWJ,U=V.JtWdy,dX2=V.Chi_sq,L=V.y_hat,A=V.J),X){case 1:lambda=Math.min(lambda*P,1e7);break;case 2:lambda+=Math.abs((B-b)/2/G);break;case 3:lambda*=nu,nu=2*nu}}return I=o.multiply(o.multiply(o.transpose($),$),n.ones(d,1)),I.apply(function(t,r){I[t][r]=(d-C+1)/I[t][r]}),V=this.lm_matx(t,e,w,M,-1,A,r,i,I,s,h),z=V.JtWJ,U=V.JtWdy,b=V.Chi_sq,L=V.y_hat,A=V.J,{p:r,X2:b}},lm_FD_J:function(t,r,e,i,a,s){var f=i.length,u=e.length;a=a||o.multiply(n.ones(u,1),.001);for(var h=e.clone(),l=new n(f,u),c=new Array(u),p=0;u>p;p++){if(c[p]=a[p]*(1+Math.abs(e[p][0])),e[p]=[h[p][0]+c[p]],0!=c[p])if(y1=t(r,e,s),a[p][0]<0)for(var g=o.dotDivide(o.subtract(y1,i),c[p]),m=0;f>m;m++)l[m][p]=g[m][0];else{e[p][0]=h[p][0]-c[p];for(var g=o.dotDivide(o.subtract(y1,t(r,e,s)),2*c[p]),m=0;f>m;m++)l[m][p]=g[m][0]}e[p]=h[p]}return l},lm_Broyden_J:function(t,r,e,n,i){var a=o.subtract(n,t),s=o.transpose(a);return s.div(o.multiply(s,a)),e=o.add(e,o.multiply(o.subtract(i,o.add(r,o.multiply(e,a))),s))},lm_matx:function(t,r,e,i,a,s,f,u,h,l,c,p){var g=(u.length,f.length);l=l||.001;var m=t(r,f,c);s=p%(2*g)==0||a>0?this.lm_FD_J(t,r,f,m,l,c):this.lm_Broyden_J(e,i,s,f,m);var v=o.subtract(u,m),y=o.multiply(o.transpose(v),o.dotMultiply(v,h)),d=o.transpose(s),w=o.multiply(d,o.dotMultiply(s,o.multiply(h,n.ones(1,g)))),M=o.multiply(d,o.dotMultiply(h,v));return{JtWJ:w,JtWdy:M,Chi_sq:y,y_hat:m,J:s}}};t.exports=i},function(t,r,e){"use strict";t.exports=e(16),t.exports.Decompositions=t.exports.DC=e(17)},function(t,r){"use strict";function e(t){for(var r=0,e=t.length,n=new Array(e);e>r;r++)n[r]=t[r];return n}function n(t,r){var o,i,a=0;if(Array.isArray(t)){if(i=r,o=i?e(t):t,t=o.length,r=o[0].length,"undefined"==typeof r)throw new TypeError("Data must be a 2D array");if(!(t>0&&r>0))throw new RangeError("Invalid dimensions: "+t+"x"+r);for(;t>a;a++){if(o[a].length!==r)throw new RangeError("Inconsistent array dimensions");i&&(o[a]=e(o[a]))}}else{if("number"!=typeof t)throw new TypeError("Invalid arguments");if(!(t>0&&r>0))throw new RangeError("Invalid dimensions: "+t+"x"+r);for(o=new Array(t);t>a;a++)o[a]=new Array(r)}return Object.defineProperty(o,"rows",{writable:!0,value:t}),Object.defineProperty(o,"columns",{writable:!0,value:r}),o.__proto__=n.prototype,o}var o=Array.prototype.splice,i=Array.prototype.concat;n.from1DArray=function(t,r,e){var o,i,a=0;if(o=t*r,o!==e.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(t);t>a;a++)i[a]=e.slice(a*r,(a+1)*r);return new n(i)},n.rowVector=function(t){return new n([t])},n.columnVector=function(t){for(var r=t.length,e=new Array(r),o=0;r>o;o++)e[o]=[t[o]];return new n(e)},n.empty=function(t,r){return new n(t,r)},n.zeros=function(t,r){return n.empty(t,r).fill(0)},n.ones=function(t,r){return n.empty(t,r).fill(1)},n.rand=function(t,r){for(var e=n.empty(t,r),o=0,i=e.rows;i>o;o++)for(var a=0,s=e.columns;s>a;a++)e[o][a]=Math.random();return e},n.eye=function(t){for(var r=n.zeros(t,t),e=r.rows,o=0;e>o;o++)r[o][o]=1;return r},n.diag=function(t){for(var r=t.length,e=n.zeros(r,r),o=0;r>o;o++)e[o][o]=t[o];return e},n.indices=function(t,r){for(var e=new Array(r-t),n=0;n<e.length;n++)e[n]=t++;return e},n.stack=function(t){var r,e,o;if(n.isMatrix(t)){var i=0,a=0;for(r=0;r<arguments.length;r++)i+=arguments[r].rows,arguments[r].columns>a&&(a=arguments[r].columns);var s=n.zeros(i,a),f=0;for(r=0;r<arguments.length;r++){var u=arguments[r];for(e=0;e<u.rows;e++){for(o=0;o<u.columns;o++)s[f][o]=u[e][o];f++}}return s}if(Array.isArray(t)){var h=n.empty(arguments.length,t.length);for(r=0;r<arguments.length;r++)h.setRow(r,arguments[r]);return h}},n.expand=function(t,r){for(var e=[],o=0;o<r.length;o++)for(var i=0;i<r[o];i++)e.push(t[o]);return new n(e)},n.checkMatrix=function(t){if(!t)throw new TypeError("Argument has to be a matrix");return"Matrix"!==t.klass&&(t=new n(t)),t},n.isMatrix=function(t){return t?"Matrix"===t.klass:!1},Object.defineProperty(n.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(n.prototype,"size",{get:function(){return this.rows*this.columns}}),n.prototype.checkRowIndex=function(t){if(0>t||t>this.rows-1)throw new RangeError("Row index out of range.")},n.prototype.checkColumnIndex=function(t){if(0>t||t>this.columns-1)throw new RangeError("Column index out of range.")},n.prototype.checkDimensions=function(t){if(this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal.")},n.prototype.apply=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)t.call(this,n,o);return this},n.prototype.clone=function(){return new n(this.to2DArray())},n.prototype.to1DArray=function(){return i.apply([],this)},n.prototype.to2DArray=function(){for(var t=this.rows,r=new Array(t),n=0;t>n;n++)r[n]=e(this[n]);return r},n.prototype.isRowVector=function(){return 1===this.rows},n.prototype.isColumnVector=function(){return 1===this.columns},n.prototype.isVector=function(){return 1===this.rows||1===this.columns},n.prototype.isSquare=function(){return this.rows===this.columns},n.prototype.isSymmetric=function(){if(this.isSquare()){for(var t=this.rows,r=0;t>r;r++)for(var e=0;r>=e;e++)if(this[r][e]!==this[e][r])return!1;return!0}return!1},n.prototype.set=function(t,r,e){return this[t][r]=e,this},n.prototype.get=function(t,r){return this[t][r]},n.prototype.fill=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]=t;return this},n.prototype.neg=function(){return this.mulS(-1)},n.prototype.add=function(t){return"number"==typeof t?this.addS(t):(t=n.checkMatrix(t),this.addM(t))},n.prototype.addS=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]+=t;return this},n.prototype.addM=function(t){this.checkDimensions(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]+=t[n][o];return this},n.prototype.sub=function(t){return"number"==typeof t?this.subS(t):(t=n.checkMatrix(t),this.subM(t))},n.prototype.subS=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]-=t;return this},n.prototype.subM=function(t){this.checkDimensions(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]-=t[n][o];return this},n.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):(t=n.checkMatrix(t),this.mulM(t))},n.prototype.mulS=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]*=t;return this},n.prototype.mulM=function(t){this.checkDimensions(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]*=t[n][o];return this},n.prototype.div=function(t){return"number"==typeof t?this.divS(t):(t=n.checkMatrix(t),this.divM(t))},n.prototype.divS=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]/=t;return this},n.prototype.divM=function(t){this.checkDimensions(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]/=t[n][o];return this},n.prototype.getRow=function(t){
return this.checkRowIndex(t),e(this[t])},n.prototype.getRowVector=function(t){return n.rowVector(this.getRow(t))},n.prototype.setRow=function(t,r){if(this.checkRowIndex(t),n.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("Invalid row size");return this[t]=e(r),this},n.prototype.removeRow=function(t){if(this.checkRowIndex(t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return o.call(this,t,1),this.rows-=1,this},n.prototype.addRow=function(t,r){if("undefined"==typeof r&&(r=t,t=this.rows),0>t||t>this.rows)throw new RangeError("Row index out of range.");if(n.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("Invalid row size");return o.call(this,t,0,e(r)),this.rows+=1,this},n.prototype.swapRows=function(t,r){this.checkRowIndex(t),this.checkRowIndex(r);var e=this[t];return this[t]=this[r],this[r]=e,this},n.prototype.getColumn=function(t){this.checkColumnIndex(t);for(var r=this.rows,e=new Array(r),n=0;r>n;n++)e[n]=this[n][t];return e},n.prototype.getColumnVector=function(t){return n.columnVector(this.getColumn(t))},n.prototype.setColumn=function(t,r){this.checkColumnIndex(t),n.isMatrix(r)&&(r=r.to1DArray());var e=this.rows;if(r.length!==e)throw new RangeError("Invalid column size");for(var o=0;e>o;o++)this[o][t]=r[o];return this},n.prototype.removeColumn=function(t){if(this.checkColumnIndex(t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var r=0,e=this.rows;e>r;r++)this[r].splice(t,1);return this.columns-=1,this},n.prototype.addColumn=function(t,r){if("undefined"==typeof r&&(r=t,t=this.columns),0>t||t>this.columns)throw new RangeError("Column index out of range.");n.isMatrix(r)&&(r=r.to1DArray());var e=this.rows;if(r.length!==e)throw new RangeError("Invalid column size");for(var o=0;e>o;o++)this[o].splice(t,0,r[o]);return this.columns+=1,this},n.prototype.swapColumns=function(t,r){this.checkRowIndex(t),this.checkRowIndex(r);for(var e,n,o=this.rows,i=0;o>i;i++)n=this[i],e=n[t],n[t]=n[r],n[r]=e;return this},n.prototype.checkRowVector=function(t){if(n.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return t},n.prototype.checkColumnVector=function(t){if(n.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return t},n.prototype.addRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]+=t[o];return this},n.prototype.subRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]-=t[o];return this},n.prototype.mulRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]*=t[o];return this},n.prototype.divRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]/=t[o];return this},n.prototype.addColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]+=t[n];return this},n.prototype.subColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]-=t[n];return this},n.prototype.mulColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]*=t[n];return this},n.prototype.divColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]/=t[n];return this},n.prototype.mulRow=function(t,r){this.checkRowIndex(t);for(var e=0,n=this.columns;n>e;e++)this[t][e]*=r;return this},n.prototype.mulColumn=function(t,r){this.checkColumnIndex(t);for(var e=0,n=this.rows;n>e;e++)this[e][t]*=r},n.prototype.max=function(){for(var t=-(1/0),r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]>t&&(t=this[n][o]);return t},n.prototype.maxIndex=function(){for(var t=-(1/0),r={},e=this.rows,n=this.columns,o=0;e>o;o++)for(var i=0;n>i;i++)this[o][i]>t&&(t=this[o][i],r.row=o,r.column=i);return r},n.prototype.min=function(){for(var t=1/0,r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]<t&&(t=this[n][o]);return t},n.prototype.minIndex=function(){for(var t=1/0,r={},e=this.rows,n=this.columns,o=0;e>o;o++)for(var i=0;n>i;i++)this[o][i]<t&&(t=this[o][i],r.row=o,r.column=i);return r},n.prototype.maxRow=function(t){this.checkRowIndex(t);for(var r=-(1/0),e=0,n=this.columns;n>e;e++)this[t][e]>r&&(r=this[t][e]);return r},n.prototype.maxRowIndex=function(t){this.checkRowIndex(t);for(var r=-(1/0),e={row:t},n=0,o=this.columns;o>n;n++)this[t][n]>r&&(r=this[t][n],e.column=n);return e},n.prototype.minRow=function(t){this.checkRowIndex(t);for(var r=1/0,e=0,n=this.columns;n>e;e++)this[t][e]<r&&(r=this[t][e]);return r},n.prototype.minRowIndex=function(t){this.checkRowIndex(t);for(var r=1/0,e={row:t,column:0},n=0,o=this.columns;o>n;n++)this[t][n]<r&&(r=this[t][n],e.column=n);return e},n.prototype.maxColumn=function(t){this.checkColumnIndex(t);for(var r=-(1/0),e=0,n=this.rows;n>e;e++)this[e][t]>r&&(r=this[e][t]);return r},n.prototype.maxColumnIndex=function(t){this.checkColumnIndex(t);for(var r=-(1/0),e={row:0,column:t},n=0,o=this.rows;o>n;n++)this[n][t]>r&&(r=this[n][t],e.row=n);return e},n.prototype.minColumn=function(t){this.checkColumnIndex(t);for(var r=1/0,e=0,n=this.rows;n>e;e++)this[e][t]<r&&(r=this[e][t]);return r},n.prototype.minColumnIndex=function(t){this.checkColumnIndex(t);for(var r=1/0,e={row:0,column:t},n=0,o=this.rows;o>n;n++)this[n][t]<r&&(r=this[n][t],e.row=n);return e},n.prototype.diag=function a(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var a=new Array(this.rows),t=0,r=this.rows;r>t;t++)a[t]=this[t][t];return a},n.prototype.sum=function(){for(var t=0,r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)t+=this[n][o];return t},n.prototype.mean=function(){return this.sum()/this.size},n.prototype.prod=function s(){for(var s=1,t=this.rows,r=this.columns,e=0;t>e;e++)for(var n=0;r>n;n++)s*=this[e][n];return s},n.prototype.cumulativeSum=function(){for(var t=0,r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)t+=this[n][o],this[n][o]=t;return this},n.prototype.dot=function f(t){if(this.size!==t.size)throw new RangeError("vectors do not have the same size");for(var r=this.to1DArray(),e=t.to1DArray(),f=0,n=r.length,o=0;n>o;o++)f+=r[o]*e[o];return f},n.prototype.mmul=function(t){if(!n.isMatrix(t))throw new TypeError('parameter "other" must be a matrix');this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var r,e,o,i=this.rows,a=this.columns,s=t.columns,f=new n(i,s),u=new Array(a);for(e=0;s>e;e++){for(o=0;a>o;o++)u[o]=t[o][e];for(r=0;i>r;r++){var h=this[r],l=0;for(o=0;a>o;o++)l+=h[o]*u[o];f[r][e]=l}}return f},n.prototype.sortRows=function(t){for(var r=0,e=this.rows;e>r;r++)this[r].sort(t);return this},n.prototype.sortColumns=function(t){for(var r=0,e=this.columns;e>r;r++)this.setColumn(r,this.getColumn(r).sort(t));return this},n.prototype.transpose=function(){for(var t=new n(this.columns,this.rows),r=this.rows,e=this.columns,o=0;r>o;o++)for(var i=0;e>i;i++)t[i][o]=this[o][i];return t},n.prototype.subMatrix=function(t,r,e,o){if(t>r||e>o||0>t||t>=this.rows||0>r||r>=this.rows||0>e||e>=this.columns||0>o||o>=this.columns)throw new RangeError("Argument out of range");for(var i=new n(r-t+1,o-e+1),a=t;r>=a;a++)for(var s=e;o>=s;s++)i[a-t][s-e]=this[a][s];return i},n.prototype.subMatrixRow=function(t,r,e){if("undefined"==typeof r?(r=0,e=this.columns-1):"undefined"==typeof e&&(e=this.columns-1),r>e||0>r||r>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range.");for(var o=t.length,i=this.rows,a=new n(o,e-r+1),s=0;o>s;s++)for(var f=r;e>=f;f++){if(t[s]<0||t[s]>=i)throw new RangeError("Argument out of range.");a[s][f-r]=this[t[s]][f]}return a},n.prototype.subMatrixColumn=function(t,r,e){if("undefined"==typeof r?(r=0,e=this.rows-1):"undefined"==typeof e&&(e=this.rows-1),r>e||0>r||r>=this.rows||0>e||e>=this.rows)throw new RangeError("Argument out of range.");for(var o=t.length,i=this.columns,a=new n(e-r+1,o),s=0;o>s;s++)for(var f=r;e>=f;f++){if(t[s]<0||t[s]>=i)throw new RangeError("Argument out of range.");a[f-r][s]=this[f][t[s]]}return a},n.prototype.trace=function u(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var u=0,t=0,r=this.rows;r>t;t++)u+=this[t][t];return u},n.prototype.abs=function(){for(var t=this.rows,r=this.columns,e=0;t>e;e++)for(var n=0;r>n;n++)this[e][n]=Math.abs(this[e][n])},t.exports=n},function(t,r,e){"use strict";function n(t){return o(t,i.eye(t.rows))}function o(t,r){return t.isSquare()?new f(t).solve(r):new u(t).solve(r)}var i=e(16),a=e(18),s=e(20),f=e(21),u=e(22),h=e(23);i.prototype.inverse=function(){return n(this)},i.prototype.solve=function(t){return o(this,t)},t.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:f,LU:f,QrDecomposition:u,QR:u,CholeskyDecomposition:h,CHO:h,inverse:n,solve:o}},function(t,r,e){"use strict";function n(t,r){if(!(this instanceof n))return new n(t,r);t=o.checkMatrix(t),r=r||{};var e=t.clone(),a=t.rows,s=t.columns,f=Math.min(a,s),u=!0,h=!0;r.computeLeftSingularVectors===!1&&(u=!1),r.computeRightSingularVectors===!1&&(h=!1);var l=r.autoTranspose===!0,c=!1;if(s>a)if(l){e=e.transpose(),a=e.rows,s=e.columns,c=!0;var p=u;u=h,h=p}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var g,m,v,y,d,w,M,b,x,A,S,D,E,R,k,P,F,X,Y,N,C,T=new Array(Math.min(a+1,s)),I=o.zeros(a,f),O=o.zeros(s,s),V=new Array(s),z=new Array(a),U=Math.min(a-1,s),L=Math.max(0,Math.min(s-2,a));for(v=0,A=Math.max(U,L);A>v;v++){if(U>v){for(T[v]=0,g=v;a>g;g++)T[v]=i(T[v],e[g][v]);if(0!==T[v]){for(e[v][v]<0&&(T[v]=-T[v]),g=v;a>g;g++)e[g][v]/=T[v];e[v][v]+=1}T[v]=-T[v]}for(m=v+1;s>m;m++){if(U>v&&0!==T[v]){for(d=0,g=v;a>g;g++)d+=e[g][v]*e[g][m];for(d=-d/e[v][v],g=v;a>g;g++)e[g][m]+=d*e[g][v]}V[m]=e[v][m]}if(u&&U>v)for(g=v;a>g;g++)I[g][v]=e[g][v];if(L>v){for(V[v]=0,g=v+1;s>g;g++)V[v]=i(V[v],V[g]);if(0!==V[v]){for(V[v+1]<0&&(V[v]=-V[v]),g=v+1;s>g;g++)V[g]/=V[v];V[v+1]+=1}if(V[v]=-V[v],a>v+1&&0!==V[v]){for(g=v+1;a>g;g++)z[g]=0;for(m=v+1;s>m;m++)for(g=v+1;a>g;g++)z[g]+=V[m]*e[g][m];for(m=v+1;s>m;m++)for(d=-V[m]/V[v+1],g=v+1;a>g;g++)e[g][m]+=d*z[g]}if(h)for(g=v+1;s>g;g++)O[g][v]=V[g]}}if(y=Math.min(s,a+1),s>U&&(T[U]=e[U][U]),y>a&&(T[y-1]=0),y>L+1&&(V[L]=e[L][y-1]),V[y-1]=0,u){for(m=U;f>m;m++){for(g=0;a>g;g++)I[g][m]=0;I[m][m]=1}for(v=U-1;v>=0;v--)if(0!==T[v]){for(m=v+1;f>m;m++){for(d=0,g=v;a>g;g++)d+=I[g][v]*I[g][m];for(d=-d/I[v][v],g=v;a>g;g++)I[g][m]+=d*I[g][v]}for(g=v;a>g;g++)I[g][v]=-I[g][v];for(I[v][v]=1+I[v][v],g=0;v-1>g;g++)I[g][v]=0}else{for(g=0;a>g;g++)I[g][v]=0;I[v][v]=1}}if(h)for(v=s-1;v>=0;v--){if(L>v&&0!==V[v])for(m=v+1;s>m;m++){for(d=0,g=v+1;s>g;g++)d+=O[g][v]*O[g][m];for(d=-d/O[v+1][v],g=v+1;s>g;g++)O[g][m]+=d*O[g][v]}for(g=0;s>g;g++)O[g][v]=0;O[v][v]=1}for(var j=y-1,_=0,q=Math.pow(2,-52);y>0;){for(v=y-2;v>=-1&&-1!==v;v--)if(Math.abs(V[v])<=q*(Math.abs(T[v])+Math.abs(T[v+1]))){V[v]=0;break}if(v===y-2)S=4;else{for(w=y-1;w>=v&&w!==v;w--)if(d=(w!==y?Math.abs(V[w]):0)+(w!==v+1?Math.abs(V[w-1]):0),Math.abs(T[w])<=q*d){T[w]=0;break}w===v?S=3:w===y-1?S=1:(S=2,v=w)}switch(v++,S){case 1:for(M=V[y-2],V[y-2]=0,m=y-2;m>=v;m--)if(d=i(T[m],M),b=T[m]/d,x=M/d,T[m]=d,m!==v&&(M=-x*V[m-1],V[m-1]=b*V[m-1]),h)for(g=0;s>g;g++)d=b*O[g][m]+x*O[g][y-1],O[g][y-1]=-x*O[g][m]+b*O[g][y-1],O[g][m]=d;break;case 2:for(M=V[v-1],V[v-1]=0,m=v;y>m;m++)if(d=i(T[m],M),b=T[m]/d,x=M/d,T[m]=d,M=-x*V[m],V[m]=b*V[m],u)for(g=0;a>g;g++)d=b*I[g][m]+x*I[g][v-1],I[g][v-1]=-x*I[g][m]+b*I[g][v-1],I[g][m]=d;break;case 3:for(D=Math.max(Math.max(Math.max(Math.max(Math.abs(T[y-1]),Math.abs(T[y-2])),Math.abs(V[y-2])),Math.abs(T[v])),Math.abs(V[v])),E=T[y-1]/D,R=T[y-2]/D,k=V[y-2]/D,P=T[v]/D,F=V[v]/D,X=((R+E)*(R-E)+k*k)/2,Y=E*k*(E*k),N=0,(0!==X||0!==Y)&&(N=Math.sqrt(X*X+Y),0>X&&(N=-N),N=Y/(X+N)),M=(P+E)*(P-E)+N,C=P*F,m=v;y-1>m;m++){if(d=i(M,C),b=M/d,x=C/d,m!==v&&(V[m-1]=d),M=b*T[m]+x*V[m],V[m]=b*V[m]-x*T[m],C=x*T[m+1],T[m+1]=b*T[m+1],h)for(g=0;s>g;g++)d=b*O[g][m]+x*O[g][m+1],O[g][m+1]=-x*O[g][m]+b*O[g][m+1],O[g][m]=d;if(d=i(M,C),b=M/d,x=C/d,T[m]=d,M=b*V[m]+x*T[m+1],T[m+1]=-x*V[m]+b*T[m+1],C=x*V[m+1],V[m+1]=b*V[m+1],u&&a-1>m)for(g=0;a>g;g++)d=b*I[g][m]+x*I[g][m+1],I[g][m+1]=-x*I[g][m]+b*I[g][m+1],I[g][m]=d}V[y-2]=M,_+=1;break;case 4:if(T[v]<=0&&(T[v]=T[v]<0?-T[v]:0,h))for(g=0;j>=g;g++)O[g][v]=-O[g][v];for(;j>v&&!(T[v]>=T[v+1]);){if(d=T[v],T[v]=T[v+1],T[v+1]=d,h&&s-1>v)for(g=0;s>g;g++)d=O[g][v+1],O[g][v+1]=O[g][v],O[g][v]=d;if(u&&a-1>v)for(g=0;a>g;g++)d=I[g][v+1],I[g][v+1]=I[g][v],I[g][v]=d;v++}_=0,y--}}if(c){var $=O;O=I,I=$}this.m=a,this.n=s,this.s=T,this.U=I,this.V=O}var o=e(16),i=e(19).hypotenuse;n.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),r=Math.max(this.m,this.n)*this.s[0]*t,e=0,n=this.s,o=0,i=n.length;i>o;o++)n[o]>r&&e++;return e},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return o.diag(this.s)},solve:function(t){var r,e=t,n=this.threshold,i=this.s.length,a=o.zeros(i,i);for(r=0;i>r;r++)Math.abs(this.s[r])<=n?a[r][r]=0:a[r][r]=1/this.s[r];var s,f,u,h=this.V.mmul(a),l=this.V.rows,c=this.U.rows,p=o.zeros(l,c);for(r=0;l>r;r++)for(s=0;c>s;s++){for(u=0,f=0;i>f;f++)u+=h[r][f]*this.U[s][f];p[r][s]=u}return p.mmul(e)},solveForDiagonal:function(t){return this.solve(o.diag(t))},inverse:function(){var t,r,e=this.threshold,n=this.V.rows,i=this.V.columns,a=new o(n,this.s.length);for(t=0;n>t;t++)for(r=0;i>r;r++)Math.abs(this.s[r])>e?a[t][r]=this.V[t][r]/this.s[r]:a[t][r]=0;var s,f,u=this.U.rows,h=this.U.columns,l=new o(n,u);for(t=0;n>t;t++)for(r=0;u>r;r++){for(f=0,s=0;h>s;s++)f+=a[t][s]*this.U[r][s];l[t][r]=f}return l}},t.exports=n},function(t,r){"use strict";r.hypotenuse=function(t,r){var e;return Math.abs(t)>Math.abs(r)?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0!==r?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0}},function(t,r,e){"use strict";function n(t){if(!(this instanceof n))return new n(t);if(t=u.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");var r,e,f=t.columns,h=u.zeros(f,f),l=new Array(f),c=new Array(f),p=t;if(t.isSymmetric()){for(r=0;f>r;r++)for(e=0;f>e;e++)h[r][e]=p[r][e];o(f,c,l,h),i(f,c,l,h)}else{var g=u.zeros(f,f),m=new Array(f);for(e=0;f>e;e++)for(r=0;f>r;r++)g[r][e]=p[r][e];a(f,g,m,h),s(f,c,l,h,g)}this.n=f,this.e=c,this.d=l,this.V=h}function o(t,r,e,n){var o,i,a,s,f,u,h,l;for(f=0;t>f;f++)e[f]=n[t-1][f];for(s=t-1;s>0;s--){for(l=0,a=0,u=0;s>u;u++)l+=Math.abs(e[u]);if(0===l)for(r[s]=e[s-1],f=0;s>f;f++)e[f]=n[s-1][f],n[s][f]=0,n[f][s]=0;else{for(u=0;s>u;u++)e[u]/=l,a+=e[u]*e[u];for(o=e[s-1],i=Math.sqrt(a),o>0&&(i=-i),r[s]=l*i,a-=o*i,e[s-1]=o-i,f=0;s>f;f++)r[f]=0;for(f=0;s>f;f++){for(o=e[f],n[f][s]=o,i=r[f]+n[f][f]*o,u=f+1;s-1>=u;u++)i+=n[u][f]*e[u],r[u]+=n[u][f]*o;r[f]=i}for(o=0,f=0;s>f;f++)r[f]/=a,o+=r[f]*e[f];for(h=o/(a+a),f=0;s>f;f++)r[f]-=h*e[f];for(f=0;s>f;f++){for(o=e[f],i=r[f],u=f;s-1>=u;u++)n[u][f]-=o*r[u]+i*e[u];e[f]=n[s-1][f],n[s][f]=0}}e[s]=a}for(s=0;t-1>s;s++){if(n[t-1][s]=n[s][s],n[s][s]=1,a=e[s+1],0!==a){for(u=0;s>=u;u++)e[u]=n[u][s+1]/a;for(f=0;s>=f;f++){for(i=0,u=0;s>=u;u++)i+=n[u][s+1]*n[u][f];for(u=0;s>=u;u++)n[u][f]-=i*e[u]}}for(u=0;s>=u;u++)n[u][s+1]=0}for(f=0;t>f;f++)e[f]=n[t-1][f],n[t-1][f]=0;n[t-1][t-1]=1,r[0]=0}function i(t,r,e,n){var o,i,a,s,f,u,l,c,p,g,m,v,y,d,w,M,b;for(a=1;t>a;a++)r[a-1]=r[a];r[t-1]=0;var x=0,A=0,S=Math.pow(2,-52);for(u=0;t>u;u++){for(A=Math.max(A,Math.abs(e[u])+Math.abs(r[u])),l=u;t>l&&!(Math.abs(r[l])<=S*A);)l++;if(l>u){b=0;do{for(b+=1,o=e[u],c=(e[u+1]-o)/(2*r[u]),p=h(c,1),0>c&&(p=-p),e[u]=r[u]/(c+p),e[u+1]=r[u]*(c+p),g=e[u+1],i=o-e[u],a=u+2;t>a;a++)e[a]-=i;for(x+=i,c=e[l],m=1,v=m,y=m,d=r[u+1],w=0,M=0,a=l-1;a>=u;a--)for(y=v,v=m,M=w,o=m*r[a],i=m*c,p=h(c,r[a]),r[a+1]=w*p,w=r[a]/p,m=c/p,c=m*e[a]-w*o,e[a+1]=i+w*(m*o+w*e[a]),f=0;t>f;f++)i=n[f][a+1],n[f][a+1]=w*n[f][a]+m*i,n[f][a]=m*n[f][a]-w*i;c=-w*M*y*d*r[u]/g,r[u]=w*c,e[u]=m*c}while(Math.abs(r[u])>S*A)}e[u]=e[u]+x,r[u]=0}for(a=0;t-1>a;a++){for(f=a,c=e[a],s=a+1;t>s;s++)e[s]<c&&(f=s,c=e[s]);if(f!==a)for(e[f]=e[a],e[a]=c,s=0;t>s;s++)c=n[s][a],n[s][a]=n[s][f],n[s][f]=c}}function a(t,r,e,n){var o,i,a,s,f,u,h,l=0,c=t-1;for(u=l+1;c-1>=u;u++){for(h=0,s=u;c>=s;s++)h+=Math.abs(r[s][u-1]);if(0!==h){for(a=0,s=c;s>=u;s--)e[s]=r[s][u-1]/h,a+=e[s]*e[s];for(i=Math.sqrt(a),e[u]>0&&(i=-i),a-=e[u]*i,e[u]=e[u]-i,f=u;t>f;f++){for(o=0,s=c;s>=u;s--)o+=e[s]*r[s][f];for(o/=a,s=u;c>=s;s++)r[s][f]-=o*e[s]}for(s=0;c>=s;s++){for(o=0,f=c;f>=u;f--)o+=e[f]*r[s][f];for(o/=a,f=u;c>=f;f++)r[s][f]-=o*e[f]}e[u]=h*e[u],r[u][u-1]=h*i}}for(s=0;t>s;s++)for(f=0;t>f;f++)n[s][f]=s===f?1:0;for(u=c-1;u>=l+1;u--)if(0!==r[u][u-1]){for(s=u+1;c>=s;s++)e[s]=r[s][u-1];for(f=u;c>=f;f++){for(i=0,s=u;c>=s;s++)i+=e[s]*n[s][f];for(i=i/e[u]/r[u][u-1],s=u;c>=s;s++)n[s][f]+=i*e[s]}}}function s(t,r,e,n,o){var i,a,s,u,h,l,c,p,g,m,v,y,d,w,M,b=t-1,x=0,A=t-1,S=Math.pow(2,-52),D=0,E=0,R=0,k=0,P=0,F=0,X=0,Y=0;for(i=0;t>i;i++)for((x>i||i>A)&&(e[i]=o[i][i],r[i]=0),a=Math.max(i-1,0);t>a;a++)E+=Math.abs(o[i][a]);for(;b>=x;){for(u=b;u>x&&(F=Math.abs(o[u-1][u-1])+Math.abs(o[u][u]),0===F&&(F=E),!(Math.abs(o[u][u-1])<S*F));)u--;if(u===b)o[b][b]=o[b][b]+D,e[b]=o[b][b],r[b]=0,b--,Y=0;else if(u===b-1){if(c=o[b][b-1]*o[b-1][b],R=(o[b-1][b-1]-o[b][b])/2,k=R*R+c,X=Math.sqrt(Math.abs(k)),o[b][b]=o[b][b]+D,o[b-1][b-1]=o[b-1][b-1]+D,p=o[b][b],k>=0){for(X=R>=0?R+X:R-X,e[b-1]=p+X,e[b]=e[b-1],0!==X&&(e[b]=p-c/X),r[b-1]=0,r[b]=0,p=o[b][b-1],F=Math.abs(p)+Math.abs(X),R=p/F,k=X/F,P=Math.sqrt(R*R+k*k),R/=P,k/=P,a=b-1;t>a;a++)X=o[b-1][a],o[b-1][a]=k*X+R*o[b][a],o[b][a]=k*o[b][a]-R*X;for(i=0;b>=i;i++)X=o[i][b-1],o[i][b-1]=k*X+R*o[i][b],o[i][b]=k*o[i][b]-R*X;for(i=x;A>=i;i++)X=n[i][b-1],n[i][b-1]=k*X+R*n[i][b],n[i][b]=k*n[i][b]-R*X}else e[b-1]=p+R,e[b]=p+R,r[b-1]=X,r[b]=-X;b-=2,Y=0}else{if(p=o[b][b],g=0,c=0,b>u&&(g=o[b-1][b-1],c=o[b][b-1]*o[b-1][b]),10===Y){for(D+=p,i=x;b>=i;i++)o[i][i]-=p;F=Math.abs(o[b][b-1])+Math.abs(o[b-1][b-2]),p=g=.75*F,c=-.4375*F*F}if(30===Y&&(F=(g-p)/2,F=F*F+c,F>0)){for(F=Math.sqrt(F),p>g&&(F=-F),F=p-c/((g-p)/2+F),i=x;b>=i;i++)o[i][i]-=F;D+=F,p=g=c=.964}for(Y+=1,h=b-2;h>=u&&(X=o[h][h],P=p-X,F=g-X,R=(P*F-c)/o[h+1][h]+o[h][h+1],k=o[h+1][h+1]-X-P-F,P=o[h+2][h+1],F=Math.abs(R)+Math.abs(k)+Math.abs(P),R/=F,k/=F,P/=F,h!==u)&&!(Math.abs(o[h][h-1])*(Math.abs(k)+Math.abs(P))<S*(Math.abs(R)*(Math.abs(o[h-1][h-1])+Math.abs(X)+Math.abs(o[h+1][h+1]))));)h--;for(i=h+2;b>=i;i++)o[i][i-2]=0,i>h+2&&(o[i][i-3]=0);for(s=h;b-1>=s&&(w=s!==b-1,s!==h&&(R=o[s][s-1],k=o[s+1][s-1],P=w?o[s+2][s-1]:0,p=Math.abs(R)+Math.abs(k)+Math.abs(P),0!==p&&(R/=p,k/=p,P/=p)),0!==p);s++)if(F=Math.sqrt(R*R+k*k+P*P),0>R&&(F=-F),0!==F){for(s!==h?o[s][s-1]=-F*p:u!==h&&(o[s][s-1]=-o[s][s-1]),R+=F,p=R/F,g=k/F,X=P/F,k/=R,P/=R,a=s;t>a;a++)R=o[s][a]+k*o[s+1][a],w&&(R+=P*o[s+2][a],o[s+2][a]=o[s+2][a]-R*X),o[s][a]=o[s][a]-R*p,o[s+1][a]=o[s+1][a]-R*g;for(i=0;i<=Math.min(b,s+3);i++)R=p*o[i][s]+g*o[i][s+1],w&&(R+=X*o[i][s+2],o[i][s+2]=o[i][s+2]-R*P),o[i][s]=o[i][s]-R,o[i][s+1]=o[i][s+1]-R*k;for(i=x;A>=i;i++)R=p*n[i][s]+g*n[i][s+1],w&&(R+=X*n[i][s+2],n[i][s+2]=n[i][s+2]-R*P),n[i][s]=n[i][s]-R,n[i][s+1]=n[i][s+1]-R*k}}}if(0!==E){for(b=t-1;b>=0;b--)if(R=e[b],k=r[b],0===k)for(u=b,o[b][b]=1,i=b-1;i>=0;i--){for(c=o[i][i]-R,P=0,a=u;b>=a;a++)P+=o[i][a]*o[a][b];if(r[i]<0)X=c,F=P;else if(u=i,0===r[i]?o[i][b]=0!==c?-P/c:-P/(S*E):(p=o[i][i+1],g=o[i+1][i],k=(e[i]-R)*(e[i]-R)+r[i]*r[i],l=(p*F-X*P)/k,o[i][b]=l,o[i+1][b]=Math.abs(p)>Math.abs(X)?(-P-c*l)/p:(-F-g*l)/X),l=Math.abs(o[i][b]),S*l*l>1)for(a=i;b>=a;a++)o[a][b]=o[a][b]/l}else if(0>k)for(u=b-1,Math.abs(o[b][b-1])>Math.abs(o[b-1][b])?(o[b-1][b-1]=k/o[b][b-1],o[b-1][b]=-(o[b][b]-R)/o[b][b-1]):(M=f(0,-o[b-1][b],o[b-1][b-1]-R,k),o[b-1][b-1]=M[0],o[b-1][b]=M[1]),o[b][b-1]=0,o[b][b]=1,i=b-2;i>=0;i--){for(m=0,v=0,a=u;b>=a;a++)m+=o[i][a]*o[a][b-1],v+=o[i][a]*o[a][b];if(c=o[i][i]-R,r[i]<0)X=c,P=m,F=v;else if(u=i,0===r[i]?(M=f(-m,-v,c,k),o[i][b-1]=M[0],o[i][b]=M[1]):(p=o[i][i+1],g=o[i+1][i],y=(e[i]-R)*(e[i]-R)+r[i]*r[i]-k*k,d=2*(e[i]-R)*k,0===y&&0===d&&(y=S*E*(Math.abs(c)+Math.abs(k)+Math.abs(p)+Math.abs(g)+Math.abs(X))),M=f(p*P-X*m+k*v,p*F-X*v-k*m,y,d),o[i][b-1]=M[0],o[i][b]=M[1],Math.abs(p)>Math.abs(X)+Math.abs(k)?(o[i+1][b-1]=(-m-c*o[i][b-1]+k*o[i][b])/p,o[i+1][b]=(-v-c*o[i][b]-k*o[i][b-1])/p):(M=f(-P-g*o[i][b-1],-F-g*o[i][b],X,k),o[i+1][b-1]=M[0],o[i+1][b]=M[1])),l=Math.max(Math.abs(o[i][b-1]),Math.abs(o[i][b])),S*l*l>1)for(a=i;b>=a;a++)o[a][b-1]=o[a][b-1]/l,o[a][b]=o[a][b]/l}for(i=0;t>i;i++)if(x>i||i>A)for(a=i;t>a;a++)n[i][a]=o[i][a];for(a=t-1;a>=x;a--)for(i=x;A>=i;i++){for(X=0,s=x;s<=Math.min(a,A);s++)X+=n[i][s]*o[s][a];n[i][a]=X}}}function f(t,r,e,n){var o,i;return Math.abs(e)>Math.abs(n)?(o=n/e,i=e+o*n,[(t+o*r)/i,(r-o*t)/i]):(o=e/n,i=n+o*e,[(o*t+r)/i,(o*r-t)/i])}var u=e(16),h=e(19).hypotenuse;n.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var t,r,e=this.n,n=this.e,o=this.d,i=new u(e,e);for(t=0;e>t;t++){for(r=0;e>r;r++)i[t][r]=0;i[t][t]=o[t],n[t]>0?i[t][t+1]=n[t]:n[t]<0&&(i[t][t-1]=n[t])}return i}},t.exports=n},function(t,r,e){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=o.checkMatrix(t);var r,e,i,a,s,f,u,h,l,c,p=t.clone(),g=p.rows,m=p.columns,v=new Array(g),y=1;for(r=0;g>r;r++)v[r]=r;for(l=new Array(g),e=0;m>e;e++){for(r=0;g>r;r++)l[r]=p[r][e];for(r=0;g>r;r++){for(h=p[r],c=Math.min(r,e),s=0,i=0;c>i;i++)s+=h[i]*l[i];h[e]=l[r]-=s}for(a=e,r=e+1;g>r;r++)Math.abs(l[r])>Math.abs(l[a])&&(a=r);if(a!==e){for(i=0;m>i;i++)f=p[a][i],p[a][i]=p[e][i],p[e][i]=f;u=v[a],v[a]=v[e],v[e]=u,y=-y}if(g>e&&0!==p[e][e])for(r=e+1;g>r;r++)p[r][e]/=p[e][e]}this.LU=p,this.pivotVector=v,this.pivotSign=y}var o=e(16);n.prototype={isSingular:function(){for(var t=this.LU,r=t.columns,e=0;r>e;e++)if(0===t[e][e])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,e=t.columns,n=0;e>n;n++)r*=t[n][n];return r},get lowerTriangularFactor(){for(var t=this.LU,r=t.rows,e=t.columns,n=new o(r,e),i=0;r>i;i++)for(var a=0;e>a;a++)i>a?n[i][a]=t[i][a]:i===a?n[i][a]=1:n[i][a]=0;return n},get upperTriangularFactor(){for(var t=this.LU,r=t.rows,e=t.columns,n=new o(r,e),i=0;r>i;i++)for(var a=0;e>a;a++)a>=i?n[i][a]=t[i][a]:n[i][a]=0;return n},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=o.checkMatrix(t);var r=this.LU,e=r.rows;if(e!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,i,a,s=t.columns,f=t.subMatrixRow(this.pivotVector,0,s-1),u=r.columns;for(a=0;u>a;a++)for(n=a+1;u>n;n++)for(i=0;s>i;i++)f[n][i]-=f[a][i]*r[n][a];for(a=u-1;a>=0;a--){for(i=0;s>i;i++)f[a][i]/=r[a][a];for(n=0;a>n;n++)for(i=0;s>i;i++)f[n][i]-=f[a][i]*r[n][a]}return f}},t.exports=n},function(t,r,e){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=o.checkMatrix(t);var r,e,a,s,f=t.clone(),u=t.rows,h=t.columns,l=new Array(h);for(a=0;h>a;a++){var c=0;for(r=a;u>r;r++)c=i(c,f[r][a]);if(0!==c){for(f[a][a]<0&&(c=-c),r=a;u>r;r++)f[r][a]/=c;for(f[a][a]+=1,e=a+1;h>e;e++){for(s=0,r=a;u>r;r++)s+=f[r][a]*f[r][e];for(s=-s/f[a][a],r=a;u>r;r++)f[r][e]+=s*f[r][a]}}l[a]=-c}this.QR=f,this.Rdiag=l}var o=e(16),i=e(19).hypotenuse;n.prototype={solve:function(t){t=o.checkMatrix(t);var r=this.QR,e=r.rows;if(t.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,i,a,s,f=t.columns,u=t.clone(),h=r.columns;for(a=0;h>a;a++)for(i=0;f>i;i++){for(s=0,n=a;e>n;n++)s+=r[n][a]*u[n][i];for(s=-s/r[a][a],n=a;e>n;n++)u[n][i]+=s*r[n][a]}for(a=h-1;a>=0;a--){for(i=0;f>i;i++)u[a][i]/=this.Rdiag[a];for(n=0;a>n;n++)for(i=0;f>i;i++)u[n][i]-=u[a][i]*r[n][a]}return u.subMatrix(0,h-1,0,f-1)},isFullRank:function(){for(var t=this.QR.columns,r=0;t>r;r++)if(0===this.Rdiag[r])return!1;return!0},get upperTriangularFactor(){var t,r,e=this.QR,n=e.columns,i=new o(n,n);for(t=0;n>t;t++)for(r=0;n>r;r++)r>t?i[t][r]=e[t][r]:t===r?i[t][r]=this.Rdiag[t]:i[t][r]=0;return i},get orthogonalFactor(){var t,r,e,n,i=this.QR,a=i.rows,s=i.columns,f=new o(a,s);for(e=s-1;e>=0;e--){for(t=0;a>t;t++)f[t][e]=0;for(f[e][e]=1,r=e;s>r;r++)if(0!==i[e][e]){for(n=0,t=e;a>t;t++)n+=i[t][e]*f[t][r];for(n=-n/i[e][e],t=e;a>t;t++)f[t][r]+=n*i[t][e]}}return f}},t.exports=n},function(t,r,e){"use strict";function n(t){if(!(this instanceof n))return new n(t);if(t=o.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");var r,e,i,a=t,s=a.rows,f=new o(s,s),u=!0;for(e=0;s>e;e++){var h=f[e],l=0;for(i=0;e>i;i++){var c=f[i],p=0;for(r=0;i>r;r++)p+=c[r]*h[r];h[i]=p=(a[e][i]-p)/f[i][i],l+=p*p}for(l=a[e][e]-l,u&=l>0,f[e][e]=Math.sqrt(Math.max(l,0)),i=e+1;s>i;i++)f[e][i]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=f}var o=e(16);n.prototype={get leftTriangularFactor(){return this.L},solve:function(t){t=o.checkMatrix(t);var r=this.L,e=r.rows;if(t.rows!==e)throw new Error("Matrix dimensions do not match");var n,i,a,s=t.columns,f=t.clone();for(a=0;e>a;a++)for(i=0;s>i;i++){for(n=0;a>n;n++)f[a][i]-=f[n][i]*r[a][n];f[a][i]/=r[a][a]}for(a=e-1;a>=0;a--)for(i=0;s>i;i++){for(n=a+1;e>n;n++)f[a][i]-=f[n][i]*r[n][a];f[a][i]/=r[a][a]}return f}},t.exports=n},function(t,r,e){"use strict";function n(t,r){return new A(t,r)}function o(t,r){return A.ones(t,r)}function i(t,r){return A.eye(t,r)}function a(t,r){return A.zeros(t,r)}function s(t,r){return A.rand(t,r)}function f(t){if("number"==typeof t)return t;var r=t.clone();return r.transpose()}function u(t,r){if("number"==typeof t&&"number"==typeof r)return t+r;if("number"==typeof t)return this.add(r,t);var e=t.clone();return e.add(r)}function h(t,r){if("number"==typeof t&&"number"==typeof r)return t-r;if("number"==typeof t)return this.subtract(r,t);var e=t.clone();return e.sub(r)}function l(t,r){if("number"==typeof t&&"number"==typeof r)return t*r;if("number"==typeof t)return this.multiply(r,t);var e=t.clone();return"number"==typeof r?e.mul(r):e=e.mmul(r),1==e.rows&&1==e.columns?e[0][0]:e}function c(t,r){var e=t.clone();return e.mul(r)}function p(t,r){var e=t.clone();return e.div(r)}function g(t){var r,e,n=null,o=t.rows,i=t.columns;if("undefined"==typeof i&&"object"==typeof t)if(t[0]&&t[0].length)for(o=t.length,i=t[0].length,e=Math.min(o,i),n=A.zeros(i,i),r=0;i>r;r++)n[r][r]=t[r][r];else for(i=t.length,n=A.zeros(i,i),r=0;i>r;r++)n[r][r]=t[r];if(1==o)for(n=A.zeros(i,i),r=0;i>r;r++)n[r][r]=t[0][r];else if(o>0&&i>0)for(e=Math.min(o,i),n=new Array(e),r=0;e>r;r++)n[r]=t[r][r];return n}function m(t,r){if("number"==typeof t&&"number"==typeof r)return Math.min(t,r);for(var e=t.rows,n=t.columns,o=new A(e,n),i=0;e>i;i++)for(var a=0;n>a;a++)t[i][a]<r[i][a]?o[i][a]=t[i][a]:o[i][a]=r[i][a];return o}function v(t,r){if("number"==typeof t&&"number"==typeof r)return Math.max(t,r);for(var e=t.rows,n=t.columns,o=new A(e,n),i=0;e>i;i++)for(var a=0;n>a;a++)t[i][a]>r[i][a]?o[i][a]=t[i][a]:o[i][a]=r[i][a];return o}function y(t){if("number"==typeof t)return Math.sqrt(t);for(var r=t.rows,e=t.columns,n=new A(r,e),o=0;r>o;o++)for(var i=0;e>i;i++)n[o][i]=Math.sqrt(t[o][i]);return n}function d(t){if("number"==typeof t)return Math.abs(t);for(var r=t.rows,e=t.columns,n=new A(r,e),o=0;r>o;o++)for(var i=0;e>i;i++)n[o][i]=Math.abs(t[o][i]);return n}function w(t){if("number"==typeof t)return Math.sqrt(t);for(var r=t.rows,e=t.columns,n=new A(r,e),o=0;r>o;o++)for(var i=0;e>i;i++)n[o][i]=Math.exp(t[o][i]);return n}function M(t,r){if("number"==typeof t)return Math.pow(t,r);for(var e=t.rows,n=t.columns,o=new A(e,n),i=0;e>i;i++)for(var a=0;n>a;a++)o[i][a]=Math.pow(t[i][a],r);return o}function b(t,r){return t.solve(r)}function x(t){return"number"==typeof t?1/t:t.inverse()}var A=e(15);t.exports={transpose:f,add:u,subtract:h,multiply:l,dotMultiply:c,dotDivide:p,diag:g,min:m,max:v,solve:b,inv:x,sqrt:y,exp:w,dotPow:M,abs:d,matrix:n,ones:o,zeros:a,random:s,eye:i}},function(t,r,e){"use strict";t.exports=e(26),t.exports.Decompositions=t.exports.DC=e(27)},function(t,r){"use strict";function e(t){for(var r=0,e=t.length,n=new Array(e);e>r;r++)n[r]=t[r];return n}function n(t,r){var o,i,a=0;if(Array.isArray(t)){if(i=r,o=i?e(t):t,t=o.length,r=o[0].length,"undefined"==typeof r)throw new TypeError("Data must be a 2D array");if(!(t>0&&r>0))throw new RangeError("Invalid dimensions: "+t+"x"+r);for(;t>a;a++){if(o[a].length!==r)throw new RangeError("Inconsistent array dimensions");i&&(o[a]=e(o[a]))}}else{if("number"!=typeof t)throw new TypeError("Invalid arguments");if(!(t>0&&r>0))throw new RangeError("Invalid dimensions: "+t+"x"+r);for(o=new Array(t);t>a;a++)o[a]=new Array(r)}return Object.defineProperty(o,"rows",{writable:!0,value:t}),Object.defineProperty(o,"columns",{writable:!0,value:r}),o.__proto__=n.prototype,o}var o=Array.prototype.splice,i=Array.prototype.concat;n.from1DArray=function(t,r,e){var o,i,a=0;if(o=t*r,o!==e.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(t);t>a;a++)i[a]=e.slice(a*r,(a+1)*r);return new n(i)},n.rowVector=function(t){return new n([t])},n.columnVector=function(t){for(var r=t.length,e=new Array(r),o=0;r>o;o++)e[o]=[t[o]];return new n(e)},n.empty=function(t,r){return new n(t,r)},n.zeros=function(t,r){return n.empty(t,r).fill(0)},n.ones=function(t,r){return n.empty(t,r).fill(1)},n.rand=function(t,r){for(var e=n.empty(t,r),o=0,i=e.rows;i>o;o++)for(var a=0,s=e.columns;s>a;a++)e[o][a]=Math.random();return e},n.eye=function(t){for(var r=n.zeros(t,t),e=r.rows,o=0;e>o;o++)r[o][o]=1;return r},n.diag=function(t){for(var r=t.length,e=n.zeros(r,r),o=0;r>o;o++)e[o][o]=t[o];return e},n.indices=function(t,r){for(var e=new Array(r-t),n=0;n<e.length;n++)e[n]=t++;return e},n.stack=function(t){var r,e,o;if(n.isMatrix(t)){var i=0,a=0;for(r=0;r<arguments.length;r++)i+=arguments[r].rows,arguments[r].columns>a&&(a=arguments[r].columns);var s=n.zeros(i,a),f=0;for(r=0;r<arguments.length;r++){var u=arguments[r];for(e=0;e<u.rows;e++){for(o=0;o<u.columns;o++)s[f][o]=u[e][o];f++}}return s}if(Array.isArray(t)){var h=n.empty(arguments.length,t.length);for(r=0;r<arguments.length;r++)h.setRow(r,arguments[r]);return h}},n.expand=function(t,r){for(var e=[],o=0;o<r.length;o++)for(var i=0;i<r[o];i++)e.push(t[o]);return new n(e)},n.checkMatrix=function(t){if(!t)throw new TypeError("Argument has to be a matrix");return"Matrix"!==t.klass&&(t=new n(t)),t},n.isMatrix=function(t){return t?"Matrix"===t.klass:!1},Object.defineProperty(n.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(n.prototype,"size",{get:function(){return this.rows*this.columns}}),n.prototype.checkRowIndex=function(t){if(0>t||t>this.rows-1)throw new RangeError("Row index out of range.")},n.prototype.checkColumnIndex=function(t){if(0>t||t>this.columns-1)throw new RangeError("Column index out of range.")},n.prototype.checkDimensions=function(t){if(this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal.")},n.prototype.apply=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)t.call(this,n,o);return this},n.prototype.clone=function(){return new n(this.to2DArray())},n.prototype.to1DArray=function(){return i.apply([],this)},n.prototype.to2DArray=function(){for(var t=this.rows,r=new Array(t),n=0;t>n;n++)r[n]=e(this[n]);return r},n.prototype.isRowVector=function(){return 1===this.rows},n.prototype.isColumnVector=function(){return 1===this.columns},n.prototype.isVector=function(){
return 1===this.rows||1===this.columns},n.prototype.isSquare=function(){return this.rows===this.columns},n.prototype.isSymmetric=function(){if(this.isSquare()){for(var t=this.rows,r=0;t>r;r++)for(var e=0;r>=e;e++)if(this[r][e]!==this[e][r])return!1;return!0}return!1},n.prototype.set=function(t,r,e){return this[t][r]=e,this},n.prototype.get=function(t,r){return this[t][r]},n.prototype.fill=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]=t;return this},n.prototype.neg=function(){return this.mulS(-1)},n.prototype.add=function(t){return"number"==typeof t?this.addS(t):(t=n.checkMatrix(t),this.addM(t))},n.prototype.addS=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]+=t;return this},n.prototype.addM=function(t){this.checkDimensions(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]+=t[n][o];return this},n.prototype.sub=function(t){return"number"==typeof t?this.subS(t):(t=n.checkMatrix(t),this.subM(t))},n.prototype.subS=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]-=t;return this},n.prototype.subM=function(t){this.checkDimensions(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]-=t[n][o];return this},n.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):(t=n.checkMatrix(t),this.mulM(t))},n.prototype.mulS=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]*=t;return this},n.prototype.mulM=function(t){this.checkDimensions(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]*=t[n][o];return this},n.prototype.div=function(t){return"number"==typeof t?this.divS(t):(t=n.checkMatrix(t),this.divM(t))},n.prototype.divS=function(t){for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]/=t;return this},n.prototype.divM=function(t){this.checkDimensions(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]/=t[n][o];return this},n.prototype.getRow=function(t){return this.checkRowIndex(t),e(this[t])},n.prototype.getRowVector=function(t){return n.rowVector(this.getRow(t))},n.prototype.setRow=function(t,r){if(this.checkRowIndex(t),n.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("Invalid row size");return this[t]=e(r),this},n.prototype.removeRow=function(t){if(this.checkRowIndex(t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return o.call(this,t,1),this.rows-=1,this},n.prototype.addRow=function(t,r){if("undefined"==typeof r&&(r=t,t=this.rows),0>t||t>this.rows)throw new RangeError("Row index out of range.");if(n.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("Invalid row size");return o.call(this,t,0,e(r)),this.rows+=1,this},n.prototype.swapRows=function(t,r){this.checkRowIndex(t),this.checkRowIndex(r);var e=this[t];return this[t]=this[r],this[r]=e,this},n.prototype.getColumn=function(t){this.checkColumnIndex(t);for(var r=this.rows,e=new Array(r),n=0;r>n;n++)e[n]=this[n][t];return e},n.prototype.getColumnVector=function(t){return n.columnVector(this.getColumn(t))},n.prototype.setColumn=function(t,r){this.checkColumnIndex(t),n.isMatrix(r)&&(r=r.to1DArray());var e=this.rows;if(r.length!==e)throw new RangeError("Invalid column size");for(var o=0;e>o;o++)this[o][t]=r[o];return this},n.prototype.removeColumn=function(t){if(this.checkColumnIndex(t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var r=0,e=this.rows;e>r;r++)this[r].splice(t,1);return this.columns-=1,this},n.prototype.addColumn=function(t,r){if("undefined"==typeof r&&(r=t,t=this.columns),0>t||t>this.columns)throw new RangeError("Column index out of range.");n.isMatrix(r)&&(r=r.to1DArray());var e=this.rows;if(r.length!==e)throw new RangeError("Invalid column size");for(var o=0;e>o;o++)this[o].splice(t,0,r[o]);return this.columns+=1,this},n.prototype.swapColumns=function(t,r){this.checkRowIndex(t),this.checkRowIndex(r);for(var e,n,o=this.rows,i=0;o>i;i++)n=this[i],e=n[t],n[t]=n[r],n[r]=e;return this},n.prototype.checkRowVector=function(t){if(n.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return t},n.prototype.checkColumnVector=function(t){if(n.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return t},n.prototype.addRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]+=t[o];return this},n.prototype.subRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]-=t[o];return this},n.prototype.mulRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]*=t[o];return this},n.prototype.divRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]/=t[o];return this},n.prototype.addColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]+=t[n];return this},n.prototype.subColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]-=t[n];return this},n.prototype.mulColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]*=t[n];return this},n.prototype.divColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]/=t[n];return this},n.prototype.mulRow=function(t,r){this.checkRowIndex(t);for(var e=0,n=this.columns;n>e;e++)this[t][e]*=r;return this},n.prototype.mulColumn=function(t,r){this.checkColumnIndex(t);for(var e=0,n=this.rows;n>e;e++)this[e][t]*=r},n.prototype.max=function(){for(var t=-(1/0),r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]>t&&(t=this[n][o]);return t},n.prototype.maxIndex=function(){for(var t=-(1/0),r={},e=this.rows,n=this.columns,o=0;e>o;o++)for(var i=0;n>i;i++)this[o][i]>t&&(t=this[o][i],r.row=o,r.column=i);return r},n.prototype.min=function(){for(var t=1/0,r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)this[n][o]<t&&(t=this[n][o]);return t},n.prototype.minIndex=function(){for(var t=1/0,r={},e=this.rows,n=this.columns,o=0;e>o;o++)for(var i=0;n>i;i++)this[o][i]<t&&(t=this[o][i],r.row=o,r.column=i);return r},n.prototype.maxRow=function(t){this.checkRowIndex(t);for(var r=-(1/0),e=0,n=this.columns;n>e;e++)this[t][e]>r&&(r=this[t][e]);return r},n.prototype.maxRowIndex=function(t){this.checkRowIndex(t);for(var r=-(1/0),e={row:t},n=0,o=this.columns;o>n;n++)this[t][n]>r&&(r=this[t][n],e.column=n);return e},n.prototype.minRow=function(t){this.checkRowIndex(t);for(var r=1/0,e=0,n=this.columns;n>e;e++)this[t][e]<r&&(r=this[t][e]);return r},n.prototype.minRowIndex=function(t){this.checkRowIndex(t);for(var r=1/0,e={row:t,column:0},n=0,o=this.columns;o>n;n++)this[t][n]<r&&(r=this[t][n],e.column=n);return e},n.prototype.maxColumn=function(t){this.checkColumnIndex(t);for(var r=-(1/0),e=0,n=this.rows;n>e;e++)this[e][t]>r&&(r=this[e][t]);return r},n.prototype.maxColumnIndex=function(t){this.checkColumnIndex(t);for(var r=-(1/0),e={row:0,column:t},n=0,o=this.rows;o>n;n++)this[n][t]>r&&(r=this[n][t],e.row=n);return e},n.prototype.minColumn=function(t){this.checkColumnIndex(t);for(var r=1/0,e=0,n=this.rows;n>e;e++)this[e][t]<r&&(r=this[e][t]);return r},n.prototype.minColumnIndex=function(t){this.checkColumnIndex(t);for(var r=1/0,e={row:0,column:t},n=0,o=this.rows;o>n;n++)this[n][t]<r&&(r=this[n][t],e.row=n);return e},n.prototype.diag=function a(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var a=new Array(this.rows),t=0,r=this.rows;r>t;t++)a[t]=this[t][t];return a},n.prototype.sum=function(){for(var t=0,r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)t+=this[n][o];return t},n.prototype.mean=function(){return this.sum()/this.size},n.prototype.prod=function s(){for(var s=1,t=this.rows,r=this.columns,e=0;t>e;e++)for(var n=0;r>n;n++)s*=this[e][n];return s},n.prototype.cumulativeSum=function(){for(var t=0,r=this.rows,e=this.columns,n=0;r>n;n++)for(var o=0;e>o;o++)t+=this[n][o],this[n][o]=t;return this},n.prototype.dot=function f(t){if(this.size!==t.size)throw new RangeError("vectors do not have the same size");for(var r=this.to1DArray(),e=t.to1DArray(),f=0,n=r.length,o=0;n>o;o++)f+=r[o]*e[o];return f},n.prototype.mmul=function(t){if(!n.isMatrix(t))throw new TypeError('parameter "other" must be a matrix');this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var r,e,o,i=this.rows,a=this.columns,s=t.columns,f=new n(i,s),u=new Array(a);for(e=0;s>e;e++){for(o=0;a>o;o++)u[o]=t[o][e];for(r=0;i>r;r++){var h=this[r],l=0;for(o=0;a>o;o++)l+=h[o]*u[o];f[r][e]=l}}return f},n.prototype.sortRows=function(t){for(var r=0,e=this.rows;e>r;r++)this[r].sort(t);return this},n.prototype.sortColumns=function(t){for(var r=0,e=this.columns;e>r;r++)this.setColumn(r,this.getColumn(r).sort(t));return this},n.prototype.transpose=function(){for(var t=new n(this.columns,this.rows),r=this.rows,e=this.columns,o=0;r>o;o++)for(var i=0;e>i;i++)t[i][o]=this[o][i];return t},n.prototype.subMatrix=function(t,r,e,o){if(t>r||e>o||0>t||t>=this.rows||0>r||r>=this.rows||0>e||e>=this.columns||0>o||o>=this.columns)throw new RangeError("Argument out of range");for(var i=new n(r-t+1,o-e+1),a=t;r>=a;a++)for(var s=e;o>=s;s++)i[a-t][s-e]=this[a][s];return i},n.prototype.subMatrixRow=function(t,r,e){if("undefined"==typeof r?(r=0,e=this.columns-1):"undefined"==typeof e&&(e=this.columns-1),r>e||0>r||r>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range.");for(var o=t.length,i=this.rows,a=new n(o,e-r+1),s=0;o>s;s++)for(var f=r;e>=f;f++){if(t[s]<0||t[s]>=i)throw new RangeError("Argument out of range.");a[s][f-r]=this[t[s]][f]}return a},n.prototype.subMatrixColumn=function(t,r,e){if("undefined"==typeof r?(r=0,e=this.rows-1):"undefined"==typeof e&&(e=this.rows-1),r>e||0>r||r>=this.rows||0>e||e>=this.rows)throw new RangeError("Argument out of range.");for(var o=t.length,i=this.columns,a=new n(e-r+1,o),s=0;o>s;s++)for(var f=r;e>=f;f++){if(t[s]<0||t[s]>=i)throw new RangeError("Argument out of range.");a[f-r][s]=this[f][t[s]]}return a},n.prototype.trace=function u(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var u=0,t=0,r=this.rows;r>t;t++)u+=this[t][t];return u},n.prototype.abs=function(){for(var t=this.rows,r=this.columns,e=0;t>e;e++)for(var n=0;r>n;n++)this[e][n]=Math.abs(this[e][n])},t.exports=n},function(t,r,e){"use strict";function n(t){return o(t,i.eye(t.rows))}function o(t,r){return t.isSquare()?new f(t).solve(r):new u(t).solve(r)}var i=e(26),a=e(28),s=e(30),f=e(31),u=e(32),h=e(33);i.prototype.inverse=function(){return n(this)},i.prototype.solve=function(t){return o(this,t)},t.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:f,LU:f,QrDecomposition:u,QR:u,CholeskyDecomposition:h,CHO:h,inverse:n,solve:o}},function(t,r,e){"use strict";function n(t,r){if(!(this instanceof n))return new n(t,r);t=o.checkMatrix(t),r=r||{};var e=t.clone(),a=t.rows,s=t.columns,f=Math.min(a,s),u=!0,h=!0;r.computeLeftSingularVectors===!1&&(u=!1),r.computeRightSingularVectors===!1&&(h=!1);var l=r.autoTranspose===!0,c=!1;if(s>a)if(l){e=e.transpose(),a=e.rows,s=e.columns,c=!0;var p=u;u=h,h=p}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var g,m,v,y,d,w,M,b,x,A,S,D,E,R,k,P,F,X,Y,N,C,T=new Array(Math.min(a+1,s)),I=o.zeros(a,f),O=o.zeros(s,s),V=new Array(s),z=new Array(a),U=Math.min(a-1,s),L=Math.max(0,Math.min(s-2,a));for(v=0,A=Math.max(U,L);A>v;v++){if(U>v){for(T[v]=0,g=v;a>g;g++)T[v]=i(T[v],e[g][v]);if(0!==T[v]){for(e[v][v]<0&&(T[v]=-T[v]),g=v;a>g;g++)e[g][v]/=T[v];e[v][v]+=1}T[v]=-T[v]}for(m=v+1;s>m;m++){if(U>v&&0!==T[v]){for(d=0,g=v;a>g;g++)d+=e[g][v]*e[g][m];for(d=-d/e[v][v],g=v;a>g;g++)e[g][m]+=d*e[g][v]}V[m]=e[v][m]}if(u&&U>v)for(g=v;a>g;g++)I[g][v]=e[g][v];if(L>v){for(V[v]=0,g=v+1;s>g;g++)V[v]=i(V[v],V[g]);if(0!==V[v]){for(V[v+1]<0&&(V[v]=-V[v]),g=v+1;s>g;g++)V[g]/=V[v];V[v+1]+=1}if(V[v]=-V[v],a>v+1&&0!==V[v]){for(g=v+1;a>g;g++)z[g]=0;for(m=v+1;s>m;m++)for(g=v+1;a>g;g++)z[g]+=V[m]*e[g][m];for(m=v+1;s>m;m++)for(d=-V[m]/V[v+1],g=v+1;a>g;g++)e[g][m]+=d*z[g]}if(h)for(g=v+1;s>g;g++)O[g][v]=V[g]}}if(y=Math.min(s,a+1),s>U&&(T[U]=e[U][U]),y>a&&(T[y-1]=0),y>L+1&&(V[L]=e[L][y-1]),V[y-1]=0,u){for(m=U;f>m;m++){for(g=0;a>g;g++)I[g][m]=0;I[m][m]=1}for(v=U-1;v>=0;v--)if(0!==T[v]){for(m=v+1;f>m;m++){for(d=0,g=v;a>g;g++)d+=I[g][v]*I[g][m];for(d=-d/I[v][v],g=v;a>g;g++)I[g][m]+=d*I[g][v]}for(g=v;a>g;g++)I[g][v]=-I[g][v];for(I[v][v]=1+I[v][v],g=0;v-1>g;g++)I[g][v]=0}else{for(g=0;a>g;g++)I[g][v]=0;I[v][v]=1}}if(h)for(v=s-1;v>=0;v--){if(L>v&&0!==V[v])for(m=v+1;s>m;m++){for(d=0,g=v+1;s>g;g++)d+=O[g][v]*O[g][m];for(d=-d/O[v+1][v],g=v+1;s>g;g++)O[g][m]+=d*O[g][v]}for(g=0;s>g;g++)O[g][v]=0;O[v][v]=1}for(var j=y-1,_=0,q=Math.pow(2,-52);y>0;){for(v=y-2;v>=-1&&-1!==v;v--)if(Math.abs(V[v])<=q*(Math.abs(T[v])+Math.abs(T[v+1]))){V[v]=0;break}if(v===y-2)S=4;else{for(w=y-1;w>=v&&w!==v;w--)if(d=(w!==y?Math.abs(V[w]):0)+(w!==v+1?Math.abs(V[w-1]):0),Math.abs(T[w])<=q*d){T[w]=0;break}w===v?S=3:w===y-1?S=1:(S=2,v=w)}switch(v++,S){case 1:for(M=V[y-2],V[y-2]=0,m=y-2;m>=v;m--)if(d=i(T[m],M),b=T[m]/d,x=M/d,T[m]=d,m!==v&&(M=-x*V[m-1],V[m-1]=b*V[m-1]),h)for(g=0;s>g;g++)d=b*O[g][m]+x*O[g][y-1],O[g][y-1]=-x*O[g][m]+b*O[g][y-1],O[g][m]=d;break;case 2:for(M=V[v-1],V[v-1]=0,m=v;y>m;m++)if(d=i(T[m],M),b=T[m]/d,x=M/d,T[m]=d,M=-x*V[m],V[m]=b*V[m],u)for(g=0;a>g;g++)d=b*I[g][m]+x*I[g][v-1],I[g][v-1]=-x*I[g][m]+b*I[g][v-1],I[g][m]=d;break;case 3:for(D=Math.max(Math.max(Math.max(Math.max(Math.abs(T[y-1]),Math.abs(T[y-2])),Math.abs(V[y-2])),Math.abs(T[v])),Math.abs(V[v])),E=T[y-1]/D,R=T[y-2]/D,k=V[y-2]/D,P=T[v]/D,F=V[v]/D,X=((R+E)*(R-E)+k*k)/2,Y=E*k*(E*k),N=0,(0!==X||0!==Y)&&(N=Math.sqrt(X*X+Y),0>X&&(N=-N),N=Y/(X+N)),M=(P+E)*(P-E)+N,C=P*F,m=v;y-1>m;m++){if(d=i(M,C),b=M/d,x=C/d,m!==v&&(V[m-1]=d),M=b*T[m]+x*V[m],V[m]=b*V[m]-x*T[m],C=x*T[m+1],T[m+1]=b*T[m+1],h)for(g=0;s>g;g++)d=b*O[g][m]+x*O[g][m+1],O[g][m+1]=-x*O[g][m]+b*O[g][m+1],O[g][m]=d;if(d=i(M,C),b=M/d,x=C/d,T[m]=d,M=b*V[m]+x*T[m+1],T[m+1]=-x*V[m]+b*T[m+1],C=x*V[m+1],V[m+1]=b*V[m+1],u&&a-1>m)for(g=0;a>g;g++)d=b*I[g][m]+x*I[g][m+1],I[g][m+1]=-x*I[g][m]+b*I[g][m+1],I[g][m]=d}V[y-2]=M,_+=1;break;case 4:if(T[v]<=0&&(T[v]=T[v]<0?-T[v]:0,h))for(g=0;j>=g;g++)O[g][v]=-O[g][v];for(;j>v&&!(T[v]>=T[v+1]);){if(d=T[v],T[v]=T[v+1],T[v+1]=d,h&&s-1>v)for(g=0;s>g;g++)d=O[g][v+1],O[g][v+1]=O[g][v],O[g][v]=d;if(u&&a-1>v)for(g=0;a>g;g++)d=I[g][v+1],I[g][v+1]=I[g][v],I[g][v]=d;v++}_=0,y--}}if(c){var $=O;O=I,I=$}this.m=a,this.n=s,this.s=T,this.U=I,this.V=O}var o=e(26),i=e(29).hypotenuse;n.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),r=Math.max(this.m,this.n)*this.s[0]*t,e=0,n=this.s,o=0,i=n.length;i>o;o++)n[o]>r&&e++;return e},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return o.diag(this.s)},solve:function(t){var r,e=t,n=this.threshold,i=this.s.length,a=o.zeros(i,i);for(r=0;i>r;r++)Math.abs(this.s[r])<=n?a[r][r]=0:a[r][r]=1/this.s[r];var s,f,u,h=this.V.mmul(a),l=this.V.rows,c=this.U.rows,p=o.zeros(l,c);for(r=0;l>r;r++)for(s=0;c>s;s++){for(u=0,f=0;i>f;f++)u+=h[r][f]*this.U[s][f];p[r][s]=u}return p.mmul(e)},solveForDiagonal:function(t){return this.solve(o.diag(t))},inverse:function(){var t,r,e=this.threshold,n=this.V.rows,i=this.V.columns,a=new o(n,this.s.length);for(t=0;n>t;t++)for(r=0;i>r;r++)Math.abs(this.s[r])>e?a[t][r]=this.V[t][r]/this.s[r]:a[t][r]=0;var s,f,u=this.U.rows,h=this.U.columns,l=new o(n,u);for(t=0;n>t;t++)for(r=0;u>r;r++){for(f=0,s=0;h>s;s++)f+=a[t][s]*this.U[r][s];l[t][r]=f}return l}},t.exports=n},function(t,r){"use strict";r.hypotenuse=function(t,r){var e;return Math.abs(t)>Math.abs(r)?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0!==r?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0}},function(t,r,e){"use strict";function n(t){if(!(this instanceof n))return new n(t);if(t=u.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");var r,e,f=t.columns,h=u.zeros(f,f),l=new Array(f),c=new Array(f),p=t;if(t.isSymmetric()){for(r=0;f>r;r++)for(e=0;f>e;e++)h[r][e]=p[r][e];o(f,c,l,h),i(f,c,l,h)}else{var g=u.zeros(f,f),m=new Array(f);for(e=0;f>e;e++)for(r=0;f>r;r++)g[r][e]=p[r][e];a(f,g,m,h),s(f,c,l,h,g)}this.n=f,this.e=c,this.d=l,this.V=h}function o(t,r,e,n){var o,i,a,s,f,u,h,l;for(f=0;t>f;f++)e[f]=n[t-1][f];for(s=t-1;s>0;s--){for(l=0,a=0,u=0;s>u;u++)l+=Math.abs(e[u]);if(0===l)for(r[s]=e[s-1],f=0;s>f;f++)e[f]=n[s-1][f],n[s][f]=0,n[f][s]=0;else{for(u=0;s>u;u++)e[u]/=l,a+=e[u]*e[u];for(o=e[s-1],i=Math.sqrt(a),o>0&&(i=-i),r[s]=l*i,a-=o*i,e[s-1]=o-i,f=0;s>f;f++)r[f]=0;for(f=0;s>f;f++){for(o=e[f],n[f][s]=o,i=r[f]+n[f][f]*o,u=f+1;s-1>=u;u++)i+=n[u][f]*e[u],r[u]+=n[u][f]*o;r[f]=i}for(o=0,f=0;s>f;f++)r[f]/=a,o+=r[f]*e[f];for(h=o/(a+a),f=0;s>f;f++)r[f]-=h*e[f];for(f=0;s>f;f++){for(o=e[f],i=r[f],u=f;s-1>=u;u++)n[u][f]-=o*r[u]+i*e[u];e[f]=n[s-1][f],n[s][f]=0}}e[s]=a}for(s=0;t-1>s;s++){if(n[t-1][s]=n[s][s],n[s][s]=1,a=e[s+1],0!==a){for(u=0;s>=u;u++)e[u]=n[u][s+1]/a;for(f=0;s>=f;f++){for(i=0,u=0;s>=u;u++)i+=n[u][s+1]*n[u][f];for(u=0;s>=u;u++)n[u][f]-=i*e[u]}}for(u=0;s>=u;u++)n[u][s+1]=0}for(f=0;t>f;f++)e[f]=n[t-1][f],n[t-1][f]=0;n[t-1][t-1]=1,r[0]=0}function i(t,r,e,n){var o,i,a,s,f,u,l,c,p,g,m,v,y,d,w,M,b;for(a=1;t>a;a++)r[a-1]=r[a];r[t-1]=0;var x=0,A=0,S=Math.pow(2,-52);for(u=0;t>u;u++){for(A=Math.max(A,Math.abs(e[u])+Math.abs(r[u])),l=u;t>l&&!(Math.abs(r[l])<=S*A);)l++;if(l>u){b=0;do{for(b+=1,o=e[u],c=(e[u+1]-o)/(2*r[u]),p=h(c,1),0>c&&(p=-p),e[u]=r[u]/(c+p),e[u+1]=r[u]*(c+p),g=e[u+1],i=o-e[u],a=u+2;t>a;a++)e[a]-=i;for(x+=i,c=e[l],m=1,v=m,y=m,d=r[u+1],w=0,M=0,a=l-1;a>=u;a--)for(y=v,v=m,M=w,o=m*r[a],i=m*c,p=h(c,r[a]),r[a+1]=w*p,w=r[a]/p,m=c/p,c=m*e[a]-w*o,e[a+1]=i+w*(m*o+w*e[a]),f=0;t>f;f++)i=n[f][a+1],n[f][a+1]=w*n[f][a]+m*i,n[f][a]=m*n[f][a]-w*i;c=-w*M*y*d*r[u]/g,r[u]=w*c,e[u]=m*c}while(Math.abs(r[u])>S*A)}e[u]=e[u]+x,r[u]=0}for(a=0;t-1>a;a++){for(f=a,c=e[a],s=a+1;t>s;s++)e[s]<c&&(f=s,c=e[s]);if(f!==a)for(e[f]=e[a],e[a]=c,s=0;t>s;s++)c=n[s][a],n[s][a]=n[s][f],n[s][f]=c}}function a(t,r,e,n){var o,i,a,s,f,u,h,l=0,c=t-1;for(u=l+1;c-1>=u;u++){for(h=0,s=u;c>=s;s++)h+=Math.abs(r[s][u-1]);if(0!==h){for(a=0,s=c;s>=u;s--)e[s]=r[s][u-1]/h,a+=e[s]*e[s];for(i=Math.sqrt(a),e[u]>0&&(i=-i),a-=e[u]*i,e[u]=e[u]-i,f=u;t>f;f++){for(o=0,s=c;s>=u;s--)o+=e[s]*r[s][f];for(o/=a,s=u;c>=s;s++)r[s][f]-=o*e[s]}for(s=0;c>=s;s++){for(o=0,f=c;f>=u;f--)o+=e[f]*r[s][f];for(o/=a,f=u;c>=f;f++)r[s][f]-=o*e[f]}e[u]=h*e[u],r[u][u-1]=h*i}}for(s=0;t>s;s++)for(f=0;t>f;f++)n[s][f]=s===f?1:0;for(u=c-1;u>=l+1;u--)if(0!==r[u][u-1]){for(s=u+1;c>=s;s++)e[s]=r[s][u-1];for(f=u;c>=f;f++){for(i=0,s=u;c>=s;s++)i+=e[s]*n[s][f];for(i=i/e[u]/r[u][u-1],s=u;c>=s;s++)n[s][f]+=i*e[s]}}}function s(t,r,e,n,o){var i,a,s,u,h,l,c,p,g,m,v,y,d,w,M,b=t-1,x=0,A=t-1,S=Math.pow(2,-52),D=0,E=0,R=0,k=0,P=0,F=0,X=0,Y=0;for(i=0;t>i;i++)for((x>i||i>A)&&(e[i]=o[i][i],r[i]=0),a=Math.max(i-1,0);t>a;a++)E+=Math.abs(o[i][a]);for(;b>=x;){for(u=b;u>x&&(F=Math.abs(o[u-1][u-1])+Math.abs(o[u][u]),0===F&&(F=E),!(Math.abs(o[u][u-1])<S*F));)u--;if(u===b)o[b][b]=o[b][b]+D,e[b]=o[b][b],r[b]=0,b--,Y=0;else if(u===b-1){if(c=o[b][b-1]*o[b-1][b],R=(o[b-1][b-1]-o[b][b])/2,k=R*R+c,X=Math.sqrt(Math.abs(k)),o[b][b]=o[b][b]+D,o[b-1][b-1]=o[b-1][b-1]+D,p=o[b][b],k>=0){for(X=R>=0?R+X:R-X,e[b-1]=p+X,e[b]=e[b-1],0!==X&&(e[b]=p-c/X),r[b-1]=0,r[b]=0,p=o[b][b-1],F=Math.abs(p)+Math.abs(X),R=p/F,k=X/F,P=Math.sqrt(R*R+k*k),R/=P,k/=P,a=b-1;t>a;a++)X=o[b-1][a],o[b-1][a]=k*X+R*o[b][a],o[b][a]=k*o[b][a]-R*X;for(i=0;b>=i;i++)X=o[i][b-1],o[i][b-1]=k*X+R*o[i][b],o[i][b]=k*o[i][b]-R*X;for(i=x;A>=i;i++)X=n[i][b-1],n[i][b-1]=k*X+R*n[i][b],n[i][b]=k*n[i][b]-R*X}else e[b-1]=p+R,e[b]=p+R,r[b-1]=X,r[b]=-X;b-=2,Y=0}else{if(p=o[b][b],g=0,c=0,b>u&&(g=o[b-1][b-1],c=o[b][b-1]*o[b-1][b]),10===Y){for(D+=p,i=x;b>=i;i++)o[i][i]-=p;F=Math.abs(o[b][b-1])+Math.abs(o[b-1][b-2]),p=g=.75*F,c=-.4375*F*F}if(30===Y&&(F=(g-p)/2,F=F*F+c,F>0)){for(F=Math.sqrt(F),p>g&&(F=-F),F=p-c/((g-p)/2+F),i=x;b>=i;i++)o[i][i]-=F;D+=F,p=g=c=.964}for(Y+=1,h=b-2;h>=u&&(X=o[h][h],P=p-X,F=g-X,R=(P*F-c)/o[h+1][h]+o[h][h+1],k=o[h+1][h+1]-X-P-F,P=o[h+2][h+1],F=Math.abs(R)+Math.abs(k)+Math.abs(P),R/=F,k/=F,P/=F,h!==u)&&!(Math.abs(o[h][h-1])*(Math.abs(k)+Math.abs(P))<S*(Math.abs(R)*(Math.abs(o[h-1][h-1])+Math.abs(X)+Math.abs(o[h+1][h+1]))));)h--;for(i=h+2;b>=i;i++)o[i][i-2]=0,i>h+2&&(o[i][i-3]=0);for(s=h;b-1>=s&&(w=s!==b-1,s!==h&&(R=o[s][s-1],k=o[s+1][s-1],P=w?o[s+2][s-1]:0,p=Math.abs(R)+Math.abs(k)+Math.abs(P),0!==p&&(R/=p,k/=p,P/=p)),0!==p);s++)if(F=Math.sqrt(R*R+k*k+P*P),0>R&&(F=-F),0!==F){for(s!==h?o[s][s-1]=-F*p:u!==h&&(o[s][s-1]=-o[s][s-1]),R+=F,p=R/F,g=k/F,X=P/F,k/=R,P/=R,a=s;t>a;a++)R=o[s][a]+k*o[s+1][a],w&&(R+=P*o[s+2][a],o[s+2][a]=o[s+2][a]-R*X),o[s][a]=o[s][a]-R*p,o[s+1][a]=o[s+1][a]-R*g;for(i=0;i<=Math.min(b,s+3);i++)R=p*o[i][s]+g*o[i][s+1],w&&(R+=X*o[i][s+2],o[i][s+2]=o[i][s+2]-R*P),o[i][s]=o[i][s]-R,o[i][s+1]=o[i][s+1]-R*k;for(i=x;A>=i;i++)R=p*n[i][s]+g*n[i][s+1],w&&(R+=X*n[i][s+2],n[i][s+2]=n[i][s+2]-R*P),n[i][s]=n[i][s]-R,n[i][s+1]=n[i][s+1]-R*k}}}if(0!==E){for(b=t-1;b>=0;b--)if(R=e[b],k=r[b],0===k)for(u=b,o[b][b]=1,i=b-1;i>=0;i--){for(c=o[i][i]-R,P=0,a=u;b>=a;a++)P+=o[i][a]*o[a][b];if(r[i]<0)X=c,F=P;else if(u=i,0===r[i]?o[i][b]=0!==c?-P/c:-P/(S*E):(p=o[i][i+1],g=o[i+1][i],k=(e[i]-R)*(e[i]-R)+r[i]*r[i],l=(p*F-X*P)/k,o[i][b]=l,o[i+1][b]=Math.abs(p)>Math.abs(X)?(-P-c*l)/p:(-F-g*l)/X),l=Math.abs(o[i][b]),S*l*l>1)for(a=i;b>=a;a++)o[a][b]=o[a][b]/l}else if(0>k)for(u=b-1,Math.abs(o[b][b-1])>Math.abs(o[b-1][b])?(o[b-1][b-1]=k/o[b][b-1],o[b-1][b]=-(o[b][b]-R)/o[b][b-1]):(M=f(0,-o[b-1][b],o[b-1][b-1]-R,k),o[b-1][b-1]=M[0],o[b-1][b]=M[1]),o[b][b-1]=0,o[b][b]=1,i=b-2;i>=0;i--){for(m=0,v=0,a=u;b>=a;a++)m+=o[i][a]*o[a][b-1],v+=o[i][a]*o[a][b];if(c=o[i][i]-R,r[i]<0)X=c,P=m,F=v;else if(u=i,0===r[i]?(M=f(-m,-v,c,k),o[i][b-1]=M[0],o[i][b]=M[1]):(p=o[i][i+1],g=o[i+1][i],y=(e[i]-R)*(e[i]-R)+r[i]*r[i]-k*k,d=2*(e[i]-R)*k,0===y&&0===d&&(y=S*E*(Math.abs(c)+Math.abs(k)+Math.abs(p)+Math.abs(g)+Math.abs(X))),M=f(p*P-X*m+k*v,p*F-X*v-k*m,y,d),o[i][b-1]=M[0],o[i][b]=M[1],Math.abs(p)>Math.abs(X)+Math.abs(k)?(o[i+1][b-1]=(-m-c*o[i][b-1]+k*o[i][b])/p,o[i+1][b]=(-v-c*o[i][b]-k*o[i][b-1])/p):(M=f(-P-g*o[i][b-1],-F-g*o[i][b],X,k),o[i+1][b-1]=M[0],o[i+1][b]=M[1])),l=Math.max(Math.abs(o[i][b-1]),Math.abs(o[i][b])),S*l*l>1)for(a=i;b>=a;a++)o[a][b-1]=o[a][b-1]/l,o[a][b]=o[a][b]/l}for(i=0;t>i;i++)if(x>i||i>A)for(a=i;t>a;a++)n[i][a]=o[i][a];for(a=t-1;a>=x;a--)for(i=x;A>=i;i++){for(X=0,s=x;s<=Math.min(a,A);s++)X+=n[i][s]*o[s][a];n[i][a]=X}}}function f(t,r,e,n){var o,i;return Math.abs(e)>Math.abs(n)?(o=n/e,i=e+o*n,[(t+o*r)/i,(r-o*t)/i]):(o=e/n,i=n+o*e,[(o*t+r)/i,(o*r-t)/i])}var u=e(26),h=e(29).hypotenuse;n.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var t,r,e=this.n,n=this.e,o=this.d,i=new u(e,e);for(t=0;e>t;t++){for(r=0;e>r;r++)i[t][r]=0;i[t][t]=o[t],n[t]>0?i[t][t+1]=n[t]:n[t]<0&&(i[t][t-1]=n[t])}return i}},t.exports=n},function(t,r,e){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=o.checkMatrix(t);var r,e,i,a,s,f,u,h,l,c,p=t.clone(),g=p.rows,m=p.columns,v=new Array(g),y=1;for(r=0;g>r;r++)v[r]=r;for(l=new Array(g),e=0;m>e;e++){for(r=0;g>r;r++)l[r]=p[r][e];for(r=0;g>r;r++){for(h=p[r],c=Math.min(r,e),s=0,i=0;c>i;i++)s+=h[i]*l[i];h[e]=l[r]-=s}for(a=e,r=e+1;g>r;r++)Math.abs(l[r])>Math.abs(l[a])&&(a=r);if(a!==e){for(i=0;m>i;i++)f=p[a][i],p[a][i]=p[e][i],p[e][i]=f;u=v[a],v[a]=v[e],v[e]=u,y=-y}if(g>e&&0!==p[e][e])for(r=e+1;g>r;r++)p[r][e]/=p[e][e]}this.LU=p,this.pivotVector=v,this.pivotSign=y}var o=e(26);n.prototype={isSingular:function(){for(var t=this.LU,r=t.columns,e=0;r>e;e++)if(0===t[e][e])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,e=t.columns,n=0;e>n;n++)r*=t[n][n];return r},get lowerTriangularFactor(){for(var t=this.LU,r=t.rows,e=t.columns,n=new o(r,e),i=0;r>i;i++)for(var a=0;e>a;a++)i>a?n[i][a]=t[i][a]:i===a?n[i][a]=1:n[i][a]=0;return n},get upperTriangularFactor(){for(var t=this.LU,r=t.rows,e=t.columns,n=new o(r,e),i=0;r>i;i++)for(var a=0;e>a;a++)a>=i?n[i][a]=t[i][a]:n[i][a]=0;return n},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=o.checkMatrix(t);var r=this.LU,e=r.rows;if(e!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,i,a,s=t.columns,f=t.subMatrixRow(this.pivotVector,0,s-1),u=r.columns;for(a=0;u>a;a++)for(n=a+1;u>n;n++)for(i=0;s>i;i++)f[n][i]-=f[a][i]*r[n][a];for(a=u-1;a>=0;a--){for(i=0;s>i;i++)f[a][i]/=r[a][a];for(n=0;a>n;n++)for(i=0;s>i;i++)f[n][i]-=f[a][i]*r[n][a]}return f}},t.exports=n},function(t,r,e){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=o.checkMatrix(t);var r,e,a,s,f=t.clone(),u=t.rows,h=t.columns,l=new Array(h);for(a=0;h>a;a++){var c=0;for(r=a;u>r;r++)c=i(c,f[r][a]);if(0!==c){for(f[a][a]<0&&(c=-c),r=a;u>r;r++)f[r][a]/=c;for(f[a][a]+=1,e=a+1;h>e;e++){for(s=0,r=a;u>r;r++)s+=f[r][a]*f[r][e];for(s=-s/f[a][a],r=a;u>r;r++)f[r][e]+=s*f[r][a]}}l[a]=-c}this.QR=f,this.Rdiag=l}var o=e(26),i=e(29).hypotenuse;n.prototype={solve:function(t){t=o.checkMatrix(t);var r=this.QR,e=r.rows;if(t.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,i,a,s,f=t.columns,u=t.clone(),h=r.columns;for(a=0;h>a;a++)for(i=0;f>i;i++){for(s=0,n=a;e>n;n++)s+=r[n][a]*u[n][i];for(s=-s/r[a][a],n=a;e>n;n++)u[n][i]+=s*r[n][a]}for(a=h-1;a>=0;a--){for(i=0;f>i;i++)u[a][i]/=this.Rdiag[a];for(n=0;a>n;n++)for(i=0;f>i;i++)u[n][i]-=u[a][i]*r[n][a]}return u.subMatrix(0,h-1,0,f-1)},isFullRank:function(){for(var t=this.QR.columns,r=0;t>r;r++)if(0===this.Rdiag[r])return!1;return!0},get upperTriangularFactor(){var t,r,e=this.QR,n=e.columns,i=new o(n,n);for(t=0;n>t;t++)for(r=0;n>r;r++)r>t?i[t][r]=e[t][r]:t===r?i[t][r]=this.Rdiag[t]:i[t][r]=0;return i},get orthogonalFactor(){var t,r,e,n,i=this.QR,a=i.rows,s=i.columns,f=new o(a,s);for(e=s-1;e>=0;e--){for(t=0;a>t;t++)f[t][e]=0;for(f[e][e]=1,r=e;s>r;r++)if(0!==i[e][e]){for(n=0,t=e;a>t;t++)n+=i[t][e]*f[t][r];for(n=-n/i[e][e],t=e;a>t;t++)f[t][r]+=n*i[t][e]}}return f}},t.exports=n},function(t,r,e){"use strict";function n(t){if(!(this instanceof n))return new n(t);if(t=o.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");var r,e,i,a=t,s=a.rows,f=new o(s,s),u=!0;for(e=0;s>e;e++){var h=f[e],l=0;for(i=0;e>i;i++){var c=f[i],p=0;for(r=0;i>r;r++)p+=c[r]*h[r];h[i]=p=(a[e][i]-p)/f[i][i],l+=p*p}for(l=a[e][e]-l,u&=l>0,f[e][e]=Math.sqrt(Math.max(l,0)),i=e+1;s>i;i++)f[e][i]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=f}var o=e(26);n.prototype={get leftTriangularFactor(){return this.L},solve:function(t){t=o.checkMatrix(t);var r=this.L,e=r.rows;if(t.rows!==e)throw new Error("Matrix dimensions do not match");var n,i,a,s=t.columns,f=t.clone();for(a=0;e>a;a++)for(i=0;s>i;i++){for(n=0;a>n;n++)f[a][i]-=f[n][i]*r[a][n];f[a][i]/=r[a][a]}for(a=e-1;a>=0;a--)for(i=0;s>i;i++){for(n=a+1;e>n;n++)f[a][i]-=f[n][i]*r[n][a];f[a][i]/=r[a][a]}return f}},t.exports=n},function(t,r,e){function n(t,r,e){var e=Object.create(e||{});void 0===e.minMaxRatio&&(e.minMaxRatio=25e-5),void 0===e.broadRatio&&(e.broadRatio=0),void 0===e.noiseLevel&&(e.noiseLevel=0),void 0===e.maxCriteria&&(e.maxCriteria=!0),void 0===e.smoothY&&(e.smoothY=!0),void 0===e.realTopDetection&&(e.realTopDetection=!1);var n=a({},f,e.sgOptions),u={m:1,b:0};if(!e.maxCriteria||e.noiseLevel>0){if(r=[].concat(r),!e.maxCriteria){u={m:-1,b:i.array.max(r)};for(var h=0;h<r.length;h++)r[h]=-r[h]+u.b;e.noiseLevel=-e.noiseLevel+u.b}if(e.noiseLevel>0)for(var h=0;h<r.length;h++)Math.abs(r[h])<e.noiseLevel&&(r[h]=0)}for(var l,c=0,p=Number.MAX_VALUE,h=0;h<t.length-1;h++){var l=Math.abs(t[h+1]-t[h]);p>l&&(p=l),l>c&&(c=l)}if(.05>(c-p)/c)var g=s(r,t[1]-t[0],{windowSize:n.windowSize,polynomial:n.polynomial,derivative:0}),m=s(r,t[1]-t[0],{windowSize:n.windowSize,polynomial:n.polynomial,derivative:1}),v=s(r,t[1]-t[0],{windowSize:n.windowSize,polynomial:n.polynomial,derivative:2});else var g=s(r,t,{windowSize:n.windowSize,polynomial:n.polynomial,derivative:0}),m=s(r,t,{windowSize:n.windowSize,polynomial:n.polynomial,derivative:1}),v=s(r,t,{windowSize:n.windowSize,polynomial:n.polynomial,derivative:2});for(var y=t,d=t[1]-t[0],w=0,M=0,h=0;h<g.length;h++)Math.abs(v[h])>w&&(w=Math.abs(v[h])),Math.abs(g[h])>M&&(M=Math.abs(g[h]));for(var b=[],x=[],A=[],S=null,D=null,E=new Array,h=1;h<g.length-1;h++)(m[h]<m[h-1]&&m[h]<=m[h+1]||m[h]<=m[h-1]&&m[h]<m[h+1])&&(D=y[h],d>0&&null!=S&&(x.push(S),A.push(D))),(m[h]>=m[h-1]&&m[h]>m[h+1]||m[h]>m[h-1]&&m[h]>=m[h+1])&&(S=y[h],0>d&&null!=D&&(x.push(S),A.push(D))),v[h]<v[h-1]&&v[h]<v[h+1]&&(b.push(h),Math.abs(v[h])>e.broadRatio*w?E.push(!1):E.push(!0));e.realTopDetection&&o(b,y,g);for(var R,k,P,F,X,Y,N=[],C=0,T=0;T<b.length;T++){for(P=y[b[T]],R=-1,k=C+1,X=Number.MAX_VALUE,F=0,Y=!0;-1==R&&k<x.length&&Y;)F=Math.abs(P-(x[k]+A[k])/2),X>F?X=F:Y=!1,F<Math.abs(x[k]-A[k])/2&&(R=k,C=k),k++;-1!=R&&Math.abs(g[b[T]])>e.minMaxRatio*M&&N.push({x:P,y:(g[b[T]]-u.b)/u.m,width:Math.abs(A[R]-x[R]),soft:E[T]})}return N.sort(function(t,r){return t.x-r.x}),N}function o(t,r,e){for(var n,o,i,a,s,f=0;f<t.length;f++)s=t[f],e[s-1]>=e[s-2]&&e[s-1]>=e[s]?s--:e[s+1]>=e[s]&&e[s+1]>=e[s+2]?s++:e[s-2]>=e[s-3]&&e[s-2]>=e[s-1]?s-=2:e[s+2]>=e[s+1]&&e[s+2]>=e[s+3]&&(s+=2),e[s-1]>0&&e[s+1]>0&&e[s]>=e[s-1]&&e[s]>=e[s+1]&&(n=20*Math.log10(e[s-1]),o=20*Math.log10(e[s]),i=20*Math.log10(e[s+1]),a=.5*(n-i)/(n-2*o+i),r[t[f]]=r[s]+(r[s]-r[s-1])*a,e[t[f]]=e[s]-.25*(e[s-1]-[s+1])*a)}var i=(e(12),e(35)),a=e(6),s=e(38),f={windowSize:5,polynomial:3};t.exports=n},function(t,r,e){"use strict";r.array=e(36),r.matrix=e(37)},function(t,r){"use strict";function e(t,r){return t-r}r.sum=function n(t){for(var n=0,r=0;r<t.length;r++)n+=t[r];return n},r.max=function o(t){for(var o=-(1/0),r=t.length,e=0;r>e;e++)t[e]>o&&(o=t[e]);return o},r.min=function i(t){for(var i=1/0,r=t.length,e=0;r>e;e++)t[e]<i&&(i=t[e]);return i},r.minMax=function(t){for(var r=1/0,e=-(1/0),n=t.length,o=0;n>o;o++)t[o]<r&&(r=t[o]),t[o]>e&&(e=t[o]);return{min:r,max:e}},r.arithmeticMean=function(t){for(var r=0,e=t.length,n=0;e>n;n++)r+=t[n];return r/e},r.mean=r.arithmeticMean,r.geometricMean=function(t){for(var r=1,e=t.length,n=0;e>n;n++)r*=t[n];return Math.pow(r,1/e)},r.logMean=function(t){for(var r=0,e=t.length,n=0;e>n;n++)r+=Math.log(t[n]);return r/e},r.grandMean=function(t,r){for(var e=0,n=0,o=t.length,i=0;o>i;i++)e+=r[i]*t[i],n+=r[i];return e/n},r.truncatedMean=function(t,r,n){void 0===n&&(n=!1),n||(t=t.slice().sort(e));for(var o=t.length,i=Math.floor(o*r),a=0,s=i;o-i>s;s++)a+=t[s];return a/(o-2*i)},r.harmonicMean=function(t){for(var r=0,e=t.length,n=0;e>n;n++){if(0===t[n])throw new RangeError("value at index "+n+"is zero");r+=1/t[n]}return e/r},r.contraHarmonicMean=function(t){for(var r=0,e=0,n=t.length,o=0;n>o;o++)r+=t[o]*t[o],e+=t[o];if(0>e)throw new RangeError("sum of values is negative");return r/e},r.median=function(t,r){void 0===r&&(r=!1),r||(t=t.slice().sort(e));var n=t.length,o=Math.floor(n/2);return n%2===0?.5*(t[o-1]+t[o]):t[o]},r.variance=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=0,i=t.length,a=0;i>a;a++){
var s=t[a]-n;o+=s*s}return e?o/(i-1):o/i},r.standardDeviation=function(t,e){return Math.sqrt(r.variance(t,e))},r.standardError=function(t){return r.standardDeviation(t)/Math.sqrt(t.length)},r.quartiles=function(t,n){"undefined"==typeof n&&(n=!1),n||(t=t.slice(),t.sort(e));var o=t.length/4,i=t[Math.ceil(o)-1],a=r.median(t,!0),s=t[Math.ceil(3*o)-1];return{q1:i,q2:a,q3:s}},r.pooledStandardDeviation=function(t,e){return Math.sqrt(r.pooledVariance(t,e))},r.pooledVariance=function(t,e){"undefined"==typeof e&&(e=!0);for(var n=0,o=0,i=t.length,a=0;i>a;a++){var s=t[a],f=r.variance(s);n+=(s.length-1)*f,o+=e?s.length-1:s.length}return n/o},r.mode=function(t){var r,e=t.length,n=new Array(e);for(r=0;e>r;r++)n[r]=0;var o=new Array(e),i=0;for(r=0;e>r;r++){var a=o.indexOf(t[r]);a>=0?n[a]++:(o[i]=t[r],n[i]=1,i++)}var s=0,f=0;for(r=0;i>r;r++)n[r]>s&&(s=n[r],f=r);return o[f]},r.covariance=function(t,e,n){"undefined"==typeof n&&(n=!0);var o=r.mean(t),i=r.mean(e);if(t.length!==e.length)throw"Vectors do not have the same dimensions";for(var a=0,s=t.length,f=0;s>f;f++){var u=t[f]-o,h=e[f]-i;a+=u*h}return n?a/(s-1):a/s},r.skewness=function(t,e){"undefined"==typeof e&&(e=!0);for(var n=r.mean(t),o=0,i=0,a=t.length,s=0;a>s;s++){var f=t[s]-n;o+=f*f,i+=f*f*f}var u=o/a,h=i/a,l=h/Math.pow(u,1.5);if(e){var c=Math.sqrt(a*(a-1)),p=a-2;return c/p*l}return l},r.kurtosis=function(t,e){"undefined"==typeof e&&(e=!0);for(var n=r.mean(t),o=t.length,i=0,a=0,s=0;o>s;s++){var f=t[s]-n;i+=f*f,a+=f*f*f*f}var u=i/o,h=a/o;if(e){var l=i/(o-1),c=o*(o+1)/((o-1)*(o-2)*(o-3)),p=a/(l*l),g=(o-1)*(o-1)/((o-2)*(o-3));return c*p-3*g}return h/(u*u)-3},r.entropy=function(t,r){"undefined"==typeof r&&(r=0);for(var e=0,n=t.length,o=0;n>o;o++)e+=t[o]*Math.log(t[o]+r);return-e},r.weightedMean=function(t,r){for(var e=0,n=t.length,o=0;n>o;o++)e+=t[o]*r[o];return e},r.weightedStandardDeviation=function(t,e){return Math.sqrt(r.weightedVariance(t,e))},r.weightedVariance=function(t,e){for(var n=r.weightedMean(t,e),o=0,i=t.length,a=0,s=0,f=0;i>f;f++){var u=t[f]-n,h=e[f];o+=h*(u*u),s+=h,a+=h*h}return o*(s/(s*s-a))},r.center=function(t,e){"undefined"==typeof e&&(e=!1);var n=t;e||(n=t.slice());for(var o=r.mean(n),i=n.length,a=0;i>a;a++)n[a]-=o},r.standardize=function(t,e,n){"undefined"==typeof e&&(e=r.standardDeviation(t)),"undefined"==typeof n&&(n=!1);for(var o=t.length,i=n?t:new Array(o),a=0;o>a;a++)i[a]=t[a]/e;return i},r.cumulativeSum=function(t){var r=t.length,e=new Array(r);e[0]=t[0];for(var n=1;r>n;n++)e[n]=e[n-1]+t[n];return e}},function(t,r,e){"use strict";function n(t,r){"undefined"==typeof r&&(r=0);for(var e=0,n=t.length,o=t[0].length,i=0;n>i;i++)for(var a=0;o>a;a++)e+=t[i][a]*Math.log(t[i][a]+r);return-e}function o(t,r){"undefined"==typeof r&&(r=0);var e,n,o,i,a=t.length,s=t[0].length;if(-1===r){for(e=[0],n=a*s,o=0;a>o;o++)for(i=0;s>i;i++)e[0]+=t[o][i];e[0]/=n}else if(0===r)for(e=new Array(s),n=a,i=0;s>i;i++){for(e[i]=0,o=0;a>o;o++)e[i]+=t[o][i];e[i]/=n}else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(a),n=s,i=0;a>i;i++){for(e[i]=0,o=0;s>o;o++)e[i]+=t[i][o];e[i]/=n}}return e}function i(t,r,e){for(var n=a(t,r,e),o=n.length,i=0;o>i;i++)n[i]=Math.sqrt(n[i]);return n}function a(t,r,e){"undefined"==typeof e&&(e=!0),r=r||o(t);var n=t.length;if(0===n)return[];for(var i=t[0].length,a=new Array(i),s=0;i>s;s++){for(var f=0,u=0,h=0,l=0;n>l;l++)h=t[l][s]-r[s],f+=h,u+=h*h;e?a[s]=(u-f*f/n)/(n-1):a[s]=(u-f*f/n)/n}return a}function s(t){for(var r=t.length,e=t[0].length,n=new Array(e),o=0;e>o;o++){for(var i=new Array(r),a=0;r>a;a++)i[a]=t[a][o];i.sort();var s=i.length;s%2===0?n[o]=.5*(i[s/2]+i[s/2-1]):n[o]=i[Math.floor(s/2)]}return n}function f(t){var r,e,n=t.length,o=t[0].length,i=new Array(o);for(r=0;o>r;r++){for(var a=new Array(n),s=0;n>s;s++)a[s]=0;var f=new Array(n),u=0;for(e=0;n>e;e++){var h=f.indexOf(t[e][r]);h>=0?a[h]++:(f[u]=t[e][r],a[u]=1,u++)}var l=0,c=0;for(e=0;u>e;e++)a[e]>l&&(l=a[e],c=e);i[r]=f[c]}return i}function u(t,r){"undefined"==typeof r&&(r=!0);for(var e=o(t),n=t.length,i=e.length,a=new Array(i),s=0;i>s;s++){for(var f=0,u=0,h=0;n>h;h++){var l=t[h][s]-e[s];f+=l*l,u+=l*l*l}var c=f/n,p=u/n,g=p/Math.pow(c,1.5);if(r){var m=Math.sqrt(n*(n-1)),v=n-2;a[s]=m/v*g}else a[s]=g}return a}function h(t,r){"undefined"==typeof r&&(r=!0);for(var e=o(t),n=t.length,i=t[0].length,a=new Array(i),s=0;i>s;s++){for(var f=0,u=0,h=0;n>h;h++){var l=t[h][s]-e[s];f+=l*l,u+=l*l*l*l}var c=f/n,p=u/n;if(r){var g=f/(n-1),m=n*(n+1)/((n-1)*(n-2)*(n-3)),v=u/(g*g),y=(n-1)*(n-1)/((n-2)*(n-3));a[s]=m*v-3*y}else a[s]=p/(c*c)-3}return a}function l(t){for(var r=t.length,e=i(t),n=e.length,o=new Array(n),a=Math.sqrt(r),s=0;n>s;s++)o[s]=e[s]/a;return o}function c(t,r){return p(t,void 0,r)}function p(t,r,e){"undefined"==typeof e&&(e=0),"undefined"==typeof r&&(0===e?r=t.length-1:1===e&&(r=t[0].length-1));var n=o(t,e),i=t.length;if(0===i)return[[]];var a,s,f,u,h,l=t[0].length;if(0===e){for(a=new Array(l),s=0;l>s;s++)a[s]=new Array(l);for(s=0;l>s;s++)for(f=s;l>f;f++){for(u=0,h=0;i>h;h++)u+=(t[h][f]-n[f])*(t[h][s]-n[s]);u/=r,a[s][f]=u,a[f][s]=u}}else{if(1!==e)throw new Error("Invalid dimension");for(a=new Array(i),s=0;i>s;s++)a[s]=new Array(i);for(s=0;i>s;s++)for(f=s;i>f;f++){for(u=0,h=0;l>h;h++)u+=(t[f][h]-n[f])*(t[s][h]-n[s]);u/=r,a[s][f]=u,a[f][s]=u}}return a}function g(t){var r,e,n=o(t),a=i(t,!0,n),s=m(t,n,a),f=t.length,u=t[0].length,h=new Array(u);for(r=0;u>r;r++)h[r]=new Array(u);for(r=0;u>r;r++)for(e=r;u>e;e++){for(var l=0,c=0,p=s.length;p>c;c++)l+=s[c][e]*s[c][r];l/=f-1,h[r][e]=l,h[e][r]=l}return h}function m(t,r,e){return r=r||o(t),"undefined"==typeof e&&(e=i(t,!0,r)),y(v(t,r,!1),e,!0)}function v(t,r,e){r=r||o(t);var n,i,a,s=t,f=t.length;if(!e)for(s=new Array(f),n=0;f>n;n++)s[n]=new Array(t[n].length);for(n=0;f>n;n++){var u=s[n];for(i=0,a=u.length;a>i;i++)u[i]=t[n][i]-r[i]}return s}function y(t,r,e){"undefined"==typeof r&&(r=i(t));var n,o,a,s=t,f=t.length;if(!e)for(s=new Array(f),n=0;f>n;n++)s[n]=new Array(t[n].length);for(n=0;f>n;n++){var u=s[n],h=t[n];for(o=0,a=u.length;a>o;o++)0===r[o]||isNaN(r[o])||(u[o]=h[o]/r[o])}return s}function d(t,r){var e=o(t),n=t.length;if(0===n)return[];for(var i=t[0].length,a=new Array(i),s=0;i>s;s++){for(var f=0,u=0,h=0,l=0;n>l;l++){var c=t[l][s]-e[s],p=r[l];f+=p*(c*c),h+=p,u+=p*p}a[s]=f*(h/(h*h-u))}return a}function w(t,r,e){"undefined"==typeof e&&(e=0);var n=t.length;if(0===n)return[];var o,i,a,s,f,u,h=t[0].length;if(0===e){for(o=new Array(h),i=0;h>i;i++)o[i]=0;for(i=0;n>i;i++)for(u=t[i],f=r[i],s=0;h>s;s++)o[s]+=u[s]*f}else{if(1!==e)throw new Error("Invalid dimension");for(o=new Array(n),i=0;n>i;i++)o[i]=0;for(s=0;n>s;s++)for(u=t[s],f=r[s],i=0;h>i;i++)o[s]+=u[i]*f}var l=x.sum(r);if(0!==l)for(i=0,a=o.length;a>i;i++)o[i]/=l;return o}function M(t,r,e,n){n=n||0,e=e||w(t,r,n);for(var o=0,i=0,a=0,s=r.length;s>a;a++)o+=r[a],i+=r[a]*r[a];var f=o/(o*o-i);return b(t,r,e,f,n)}function b(t,r,e,n,o){o=o||0,e=e||w(t,r,o),"undefined"==typeof n&&(n=1);var i=t.length;if(0===i)return[[]];var a,s,f,u,h,l=t[0].length;if(0===o){for(a=new Array(l),s=0;l>s;s++)a[s]=new Array(l);for(s=0;l>s;s++)for(f=s;l>f;f++){for(h=0,u=0;i>u;u++)h+=r[u]*(t[u][f]-e[f])*(t[u][s]-e[s]);a[s][f]=h*n,a[f][s]=h*n}}else{if(1!==o)throw new Error("Invalid dimension");for(a=new Array(i),s=0;i>s;s++)a[s]=new Array(i);for(s=0;i>s;s++)for(f=s;i>f;f++){for(h=0,u=0;l>u;u++)h+=r[u]*(t[f][u]-e[f])*(t[s][u]-e[s]);a[s][f]=h*n,a[f][s]=h*n}}return a}var x=e(36);t.exports={entropy:n,mean:o,standardDeviation:i,variance:a,median:s,mode:f,skewness:u,kurtosis:h,standardError:l,covariance:c,scatter:p,correlation:g,zScores:m,center:v,standardize:y,weightedVariance:d,weightedMean:w,weightedCovariance:M,weightedScatter:b}},function(t,r,e){function n(t,r,e){if(e=u({},h,e),e.windowSize%2===0||e.windowSize<5||!Number.isInteger(e.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(e.windowSize>t.length)throw new RangeError("Window size is higher than the data length "+e.windowSize+">"+t.length);if(e.derivative<0||!Number.isInteger(e.derivative))throw new RangeError("Derivative should be a positive integer");if(e.polynomial<1||!Number.isInteger(e.polynomial))throw new RangeError("Polynomial should be a positive integer");e.polynomial>=6&&console.warn("You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems");var n=e.windowSize,i=Math.floor(n/2),a=t.length,s=new Array(a),l=f(n,e.polynomial,e.derivative),c=0,p=!0;"[object Array]"===Object.prototype.toString.call(r)?p=!1:c=Math.pow(r,e.derivative);for(var g=0;i>g;g++){for(var m=l[i-g-1],v=l[i+g+1],y=0,d=0,w=0;n>w;w++)y+=m[w]*t[w],d+=v[w]*t[a-n+w-1];p?(s[i-g-1]=y/c,s[a-i+g]=d/c):(c=o(r,i-g-1,i,e.derivative),s[i-g-1]=y/c,c=o(r,a-i+g,i,e.derivative),s[a-i+g]=d/c)}for(var M=l[i],g=n;a+1>g;g++){for(var b=0,w=0;n>w;w++)b+=M[w]*t[w+g-n];p||(c=o(r,g-i-1,i,e.derivative)),s[g-i-1]=b/c}return s}function o(t,r,e,n){for(var o=0,i=0,a=r-e;r+e>a;a++)a>=0&&a<t.length-1&&(o+=t[a+1]-t[a],i++);return Math.pow(o/i,n)}function i(t,r,e,n){var o=0;return o=e>0?(4*e-2)/(e*(2*r-e+1))*(t*i(t,r,e-1,n)+n*i(t,r,e-1,n-1))-(e-1)*(2*r+e)/(e*(2*r-e+1))*i(t,r,e-2,n):0==e&&0==n?1:0}function a(t,r){var e=1;if(t>=r)for(var n=t-r+1;t>=n;n++)e*=n;return e}function s(t,r,e,n,o){for(var s=0,f=0;n>=f;f++)s+=(2*f+1)*(a(2*e,f)/a(2*e+f+1,f+1))*i(t,e,f,0)*i(r,e,f,o);return s}function f(t,r,e){for(var n=new Array(t),o=Math.floor(t/2),i=-o;o>=i;i++){n[i+o]=new Array(t);for(var a=-o;o>=a;a++)n[i+o][a+o]=s(a,i,o,r,e)}return n}var u=e(6),h=(e(39),{windowSize:11,derivative:0,polynomial:2});t.exports=n},function(t,r,e){"use strict";r.array=e(40),r.matrix=e(41)},function(t,r){"use strict";function e(t,r){return t-r}r.sum=function n(t){for(var n=0,r=0;r<t.length;r++)n+=t[r];return n},r.max=function o(t){for(var o=-(1/0),r=t.length,e=0;r>e;e++)t[e]>o&&(o=t[e]);return o},r.min=function i(t){for(var i=1/0,r=t.length,e=0;r>e;e++)t[e]<i&&(i=t[e]);return i},r.minMax=function(t){for(var r=1/0,e=-(1/0),n=t.length,o=0;n>o;o++)t[o]<r&&(r=t[o]),t[o]>e&&(e=t[o]);return{min:r,max:e}},r.arithmeticMean=function(t){for(var r=0,e=t.length,n=0;e>n;n++)r+=t[n];return r/e},r.mean=r.arithmeticMean,r.geometricMean=function(t){for(var r=1,e=t.length,n=0;e>n;n++)r*=t[n];return Math.pow(r,1/e)},r.logMean=function(t){for(var r=0,e=t.length,n=0;e>n;n++)r+=Math.log(t[n]);return r/e},r.grandMean=function(t,r){for(var e=0,n=0,o=t.length,i=0;o>i;i++)e+=r[i]*t[i],n+=r[i];return e/n},r.truncatedMean=function(t,r,n){void 0===n&&(n=!1),n||(t=t.slice().sort(e));for(var o=t.length,i=Math.floor(o*r),a=0,s=i;o-i>s;s++)a+=t[s];return a/(o-2*i)},r.harmonicMean=function(t){for(var r=0,e=t.length,n=0;e>n;n++){if(0===t[n])throw new RangeError("value at index "+n+"is zero");r+=1/t[n]}return e/r},r.contraHarmonicMean=function(t){for(var r=0,e=0,n=t.length,o=0;n>o;o++)r+=t[o]*t[o],e+=t[o];if(0>e)throw new RangeError("sum of values is negative");return r/e},r.median=function(t,r){void 0===r&&(r=!1),r||(t=t.slice().sort(e));var n=t.length,o=Math.floor(n/2);return n%2===0?.5*(t[o-1]+t[o]):t[o]},r.variance=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=0,i=t.length,a=0;i>a;a++){var s=t[a]-n;o+=s*s}return e?o/(i-1):o/i},r.standardDeviation=function(t,e){return Math.sqrt(r.variance(t,e))},r.standardError=function(t){return r.standardDeviation(t)/Math.sqrt(t.length)},r.quartiles=function(t,n){"undefined"==typeof n&&(n=!1),n||(t=t.slice(),t.sort(e));var o=t.length/4,i=t[Math.ceil(o)-1],a=r.median(t,!0),s=t[Math.ceil(3*o)-1];return{q1:i,q2:a,q3:s}},r.pooledStandardDeviation=function(t,e){return Math.sqrt(r.pooledVariance(t,e))},r.pooledVariance=function(t,e){"undefined"==typeof e&&(e=!0);for(var n=0,o=0,i=t.length,a=0;i>a;a++){var s=t[a],f=r.variance(s);n+=(s.length-1)*f,o+=e?s.length-1:s.length}return n/o},r.mode=function(t){var r,e=t.length,n=new Array(e);for(r=0;e>r;r++)n[r]=0;var o=new Array(e),i=0;for(r=0;e>r;r++){var a=o.indexOf(t[r]);a>=0?n[a]++:(o[i]=t[r],n[i]=1,i++)}var s=0,f=0;for(r=0;i>r;r++)n[r]>s&&(s=n[r],f=r);return o[f]},r.covariance=function(t,e,n){"undefined"==typeof n&&(n=!0);var o=r.mean(t),i=r.mean(e);if(t.length!==e.length)throw"Vectors do not have the same dimensions";for(var a=0,s=t.length,f=0;s>f;f++){var u=t[f]-o,h=e[f]-i;a+=u*h}return n?a/(s-1):a/s},r.skewness=function(t,e){"undefined"==typeof e&&(e=!0);for(var n=r.mean(t),o=0,i=0,a=t.length,s=0;a>s;s++){var f=t[s]-n;o+=f*f,i+=f*f*f}var u=o/a,h=i/a,l=h/Math.pow(u,1.5);if(e){var c=Math.sqrt(a*(a-1)),p=a-2;return c/p*l}return l},r.kurtosis=function(t,e){"undefined"==typeof e&&(e=!0);for(var n=r.mean(t),o=t.length,i=0,a=0,s=0;o>s;s++){var f=t[s]-n;i+=f*f,a+=f*f*f*f}var u=i/o,h=a/o;if(e){var l=i/(o-1),c=o*(o+1)/((o-1)*(o-2)*(o-3)),p=a/(l*l),g=(o-1)*(o-1)/((o-2)*(o-3));return c*p-3*g}return h/(u*u)-3},r.entropy=function(t,r){"undefined"==typeof r&&(r=0);for(var e=0,n=t.length,o=0;n>o;o++)e+=t[o]*Math.log(t[o]+r);return-e},r.weightedMean=function(t,r){for(var e=0,n=t.length,o=0;n>o;o++)e+=t[o]*r[o];return e},r.weightedStandardDeviation=function(t,e){return Math.sqrt(r.weightedVariance(t,e))},r.weightedVariance=function(t,e){for(var n=r.weightedMean(t,e),o=0,i=t.length,a=0,s=0,f=0;i>f;f++){var u=t[f]-n,h=e[f];o+=h*(u*u),s+=h,a+=h*h}return o*(s/(s*s-a))},r.center=function(t,e){"undefined"==typeof e&&(e=!1);var n=t;e||(n=t.slice());for(var o=r.mean(n),i=n.length,a=0;i>a;a++)n[a]-=o},r.standardize=function(t,e,n){"undefined"==typeof e&&(e=r.standardDeviation(t)),"undefined"==typeof n&&(n=!1);for(var o=t.length,i=n?t:new Array(o),a=0;o>a;a++)i[a]=t[a]/e;return i},r.cumulativeSum=function(t){var r=t.length,e=new Array(r);e[0]=t[0];for(var n=1;r>n;n++)e[n]=e[n-1]+t[n];return e}},function(t,r,e){"use strict";function n(t,r){"undefined"==typeof r&&(r=0);for(var e=0,n=t.length,o=t[0].length,i=0;n>i;i++)for(var a=0;o>a;a++)e+=t[i][a]*Math.log(t[i][a]+r);return-e}function o(t,r){"undefined"==typeof r&&(r=0);var e,n,o,i,a=t.length,s=t[0].length;if(-1===r){for(e=[0],n=a*s,o=0;a>o;o++)for(i=0;s>i;i++)e[0]+=t[o][i];e[0]/=n}else if(0===r)for(e=new Array(s),n=a,i=0;s>i;i++){for(e[i]=0,o=0;a>o;o++)e[i]+=t[o][i];e[i]/=n}else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(a),n=s,i=0;a>i;i++){for(e[i]=0,o=0;s>o;o++)e[i]+=t[i][o];e[i]/=n}}return e}function i(t,r,e){for(var n=a(t,r,e),o=n.length,i=0;o>i;i++)n[i]=Math.sqrt(n[i]);return n}function a(t,r,e){"undefined"==typeof e&&(e=!0),r=r||o(t);var n=t.length;if(0===n)return[];for(var i=t[0].length,a=new Array(i),s=0;i>s;s++){for(var f=0,u=0,h=0,l=0;n>l;l++)h=t[l][s]-r[s],f+=h,u+=h*h;e?a[s]=(u-f*f/n)/(n-1):a[s]=(u-f*f/n)/n}return a}function s(t){for(var r=t.length,e=t[0].length,n=new Array(e),o=0;e>o;o++){for(var i=new Array(r),a=0;r>a;a++)i[a]=t[a][o];i.sort();var s=i.length;s%2===0?n[o]=.5*(i[s/2]+i[s/2-1]):n[o]=i[Math.floor(s/2)]}return n}function f(t){var r,e,n=t.length,o=t[0].length,i=new Array(o);for(r=0;o>r;r++){for(var a=new Array(n),s=0;n>s;s++)a[s]=0;var f=new Array(n),u=0;for(e=0;n>e;e++){var h=f.indexOf(t[e][r]);h>=0?a[h]++:(f[u]=t[e][r],a[u]=1,u++)}var l=0,c=0;for(e=0;u>e;e++)a[e]>l&&(l=a[e],c=e);i[r]=f[c]}return i}function u(t,r){"undefined"==typeof r&&(r=!0);for(var e=o(t),n=t.length,i=e.length,a=new Array(i),s=0;i>s;s++){for(var f=0,u=0,h=0;n>h;h++){var l=t[h][s]-e[s];f+=l*l,u+=l*l*l}var c=f/n,p=u/n,g=p/Math.pow(c,1.5);if(r){var m=Math.sqrt(n*(n-1)),v=n-2;a[s]=m/v*g}else a[s]=g}return a}function h(t,r){"undefined"==typeof r&&(r=!0);for(var e=o(t),n=t.length,i=t[0].length,a=new Array(i),s=0;i>s;s++){for(var f=0,u=0,h=0;n>h;h++){var l=t[h][s]-e[s];f+=l*l,u+=l*l*l*l}var c=f/n,p=u/n;if(r){var g=f/(n-1),m=n*(n+1)/((n-1)*(n-2)*(n-3)),v=u/(g*g),y=(n-1)*(n-1)/((n-2)*(n-3));a[s]=m*v-3*y}else a[s]=p/(c*c)-3}return a}function l(t){for(var r=t.length,e=i(t),n=e.length,o=new Array(n),a=Math.sqrt(r),s=0;n>s;s++)o[s]=e[s]/a;return o}function c(t,r){return p(t,void 0,r)}function p(t,r,e){"undefined"==typeof e&&(e=0),"undefined"==typeof r&&(0===e?r=t.length-1:1===e&&(r=t[0].length-1));var n=o(t,e),i=t.length;if(0===i)return[[]];var a,s,f,u,h,l=t[0].length;if(0===e){for(a=new Array(l),s=0;l>s;s++)a[s]=new Array(l);for(s=0;l>s;s++)for(f=s;l>f;f++){for(u=0,h=0;i>h;h++)u+=(t[h][f]-n[f])*(t[h][s]-n[s]);u/=r,a[s][f]=u,a[f][s]=u}}else{if(1!==e)throw new Error("Invalid dimension");for(a=new Array(i),s=0;i>s;s++)a[s]=new Array(i);for(s=0;i>s;s++)for(f=s;i>f;f++){for(u=0,h=0;l>h;h++)u+=(t[f][h]-n[f])*(t[s][h]-n[s]);u/=r,a[s][f]=u,a[f][s]=u}}return a}function g(t){var r,e,n=o(t),a=i(t,!0,n),s=m(t,n,a),f=t.length,u=t[0].length,h=new Array(u);for(r=0;u>r;r++)h[r]=new Array(u);for(r=0;u>r;r++)for(e=r;u>e;e++){for(var l=0,c=0,p=s.length;p>c;c++)l+=s[c][e]*s[c][r];l/=f-1,h[r][e]=l,h[e][r]=l}return h}function m(t,r,e){return r=r||o(t),"undefined"==typeof e&&(e=i(t,!0,r)),y(v(t,r,!1),e,!0)}function v(t,r,e){r=r||o(t);var n,i,a,s=t,f=t.length;if(!e)for(s=new Array(f),n=0;f>n;n++)s[n]=new Array(t[n].length);for(n=0;f>n;n++){var u=s[n];for(i=0,a=u.length;a>i;i++)u[i]=t[n][i]-r[i]}return s}function y(t,r,e){"undefined"==typeof r&&(r=i(t));var n,o,a,s=t,f=t.length;if(!e)for(s=new Array(f),n=0;f>n;n++)s[n]=new Array(t[n].length);for(n=0;f>n;n++){var u=s[n],h=t[n];for(o=0,a=u.length;a>o;o++)0===r[o]||isNaN(r[o])||(u[o]=h[o]/r[o])}return s}function d(t,r){var e=o(t),n=t.length;if(0===n)return[];for(var i=t[0].length,a=new Array(i),s=0;i>s;s++){for(var f=0,u=0,h=0,l=0;n>l;l++){var c=t[l][s]-e[s],p=r[l];f+=p*(c*c),h+=p,u+=p*p}a[s]=f*(h/(h*h-u))}return a}function w(t,r,e){"undefined"==typeof e&&(e=0);var n=t.length;if(0===n)return[];var o,i,a,s,f,u,h=t[0].length;if(0===e){for(o=new Array(h),i=0;h>i;i++)o[i]=0;for(i=0;n>i;i++)for(u=t[i],f=r[i],s=0;h>s;s++)o[s]+=u[s]*f}else{if(1!==e)throw new Error("Invalid dimension");for(o=new Array(n),i=0;n>i;i++)o[i]=0;for(s=0;n>s;s++)for(u=t[s],f=r[s],i=0;h>i;i++)o[s]+=u[i]*f}var l=x.sum(r);if(0!==l)for(i=0,a=o.length;a>i;i++)o[i]/=l;return o}function M(t,r,e,n){n=n||0,e=e||w(t,r,n);for(var o=0,i=0,a=0,s=r.length;s>a;a++)o+=r[a],i+=r[a]*r[a];var f=o/(o*o-i);return b(t,r,e,f,n)}function b(t,r,e,n,o){o=o||0,e=e||w(t,r,o),"undefined"==typeof n&&(n=1);var i=t.length;if(0===i)return[[]];var a,s,f,u,h,l=t[0].length;if(0===o){for(a=new Array(l),s=0;l>s;s++)a[s]=new Array(l);for(s=0;l>s;s++)for(f=s;l>f;f++){for(h=0,u=0;i>u;u++)h+=r[u]*(t[u][f]-e[f])*(t[u][s]-e[s]);a[s][f]=h*n,a[f][s]=h*n}}else{if(1!==o)throw new Error("Invalid dimension");for(a=new Array(i),s=0;i>s;s++)a[s]=new Array(i);for(s=0;i>s;s++)for(f=s;i>f;f++){for(h=0,u=0;l>u;u++)h+=r[u]*(t[f][u]-e[f])*(t[s][u]-e[s]);a[s][f]=h*n,a[f][s]=h*n}}return a}var x=e(40);t.exports={entropy:n,mean:o,standardDeviation:i,variance:a,median:s,mode:f,skewness:u,kurtosis:h,standardError:l,covariance:c,scatter:p,correlation:g,zScores:m,center:v,standardize:y,weightedVariance:d,weightedMean:w,weightedCovariance:M,weightedScatter:b}},function(t,r,e){function n(t){o.call(this,t)}var o=e(1),i=e(43),a=e(47),s=e(3);n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.fromJcamp=function(t,r){r=r||{xy:!0,keepSpectra:!0,keepRecordsRegExp:/^.+$/};var e=s.convert(t,r);return new n(e)},n.prototype.isHomoNuclear=function(){return this.sd.xType==this.sd.yType},n.prototype.observeFrequencyX=function(){return this.sd.spectra[0].observeFrequency},n.prototype.observeFrequencyY=function(){return this.sd.indirectFrequency},n.prototype.getSolventName=function(){return(this.sd.info[".SOLVENTNAME"]||this.sd.info.$SOLVENT).replace("<","").replace(">","")},n.prototype.getXUnits=function(){return this.sd.ntuples[1].units},n.prototype.getYUnits=function(){return this.sd.ntuples[0].units},n.prototype.getZUnits=function(){return this.sd.ntuples[2].units},n.prototype.getLastY=function(){return this.sd.minMax.maxY},n.prototype.getFirstY=function(){return this.sd.minMax.minY},n.prototype.getDeltaY=function(){return(this.getLastY()-this.getFirstY())/(this.getNbSubSpectra()-1)},n.prototype.nmrPeakDetection2D=function(t){t=t||{},t.thresholdFactor||(t.thresholdFactor=1);var r=Math.round(255*Math.random());t.id&&(r=t.id);for(var e=i.findPeaks2D(this,t.thresholdFactor),n=0;n<e.length;n++)e[n]._highlight=[r+"_"+n],e[n].signalID=r+"_"+n;return t.references&&a.alignDimensions(e,t.references),e},n.prototype.getNMRPeakThreshold=function(t){return"1H"==t?3:"13C"==t?5:1},n.prototype.getNucleus=function(t){return 1==t?this.sd.xType:2==t?this.sd.yType:this.sd.xType},t.exports=n},function(t,r,e){var n=e(44),o=e(47),i=e(48),a=e(2),s=n.FFTUtils,f={DEBUG:!1,smallFilter:[[0,0,1,2,2,2,1,0,0],[0,1,4,7,7,7,4,1,0],[1,4,5,3,0,3,5,4,1],[2,7,3,-12,-23,-12,3,7,2],[2,7,0,-23,-40,-23,0,7,2],[2,7,3,-12,-23,-12,3,7,2],[1,4,5,3,0,3,5,4,1],[0,1,3,7,7,7,3,1,0],[0,0,1,2,2,2,1,0,0]],getLoGnStdDevNMR:function(t){return t.isHomoNuclear()?1.5:3},findPeaks2D:function(t,r){0==r&&(r=1),0>r&&(r=-r);for(var e=t.getNbPoints(),n=t.getNbSubSpectra(),i=new Array(e*n),a=t.isHomoNuclear(),s=0;n>s;s++)for(var f=t.getYData(s),u=0;e>u;u++)a?i[s*e+u]=f[u]>0?f[u]:0:i[s*e+u]=Math.abs(f[u]);var h=this.getLoGnStdDevNMR(t);if(a){for(var l=this.convoluteWithLoG(i,n,e),c=this.findPeaks2DLoG(i,l,n,e,h*r),p=this.findPeaks2DMax(i,l,n,e,(h+.5)*r),g=0;g<c.length;g++)p.push(c[g]);return o.enhanceSymmetry(this.createSignals2D(p,t,24))}var l=this.convoluteWithLoG(i,n,e),c=this.findPeaks2DLoG(i,l,n,e,h*r);return this.createSignals2D(o.clean(c,.05),t,24)},convoluteWithLoG:function(t,r,e){for(var n=new Array(e*r),o=r*e-1;o>=0;o--)n[o]=t[o];n=s.fft2DArray(n,r,e);for(var i=this.smallFilter.length,a=new Array(e*r),o=e*r-1;o>=0;o--)a[o]=0;for(var f,u,h=(i-1)/2,l=0;i>l;l++){f=(l-h+r)%r;for(var c=0;i>c;c++)u=(c-h+e)%e,a[f*e+u]=this.smallFilter[l][c]}a=s.fft2DArray(a,r,e);var p=2*r,g=e/2+1;return s.convolute2DI(n,a,p,g),s.ifft2DArray(n,p,g)},findPeaks2DLoG:function(t,r,e,n,o){for(var i=0,a=n*e-2;a>=0;a--)i+=Math.pow(r[a]-r[a+1],2);i=-Math.sqrt(i),i*=o/e;for(var s=new Array(n*e),a=n*e-1;a>=0;a--)s[a]=0;for(var f=0,a=r.length-1;a>=0;a--)r[a]<i&&(s[a]=1,f++);for(var u=0,h=[];0!=f;){for(u;u<s.length&&0==s[u];u++);if(u==s.length)break;f-=this.extractArea(t,r,s,u,e,n,h,i)}return h.length>0&&this.DEBUG&&console.log("No peak found"),h},findPeaks2DMax:function(t,r,e,n,o){for(var i=0,a=n*e-2;a>=0;a--)i+=Math.pow(r[a]-r[a+1],2);i=-Math.sqrt(i),i*=o/e;for(var s,f,u=[],h=0,a=0;a<r.length;a++)r[a]<i&&(s=Math.floor(a/n),f=a%n,s>0&&e>s+1&&n>f+1&&f>0&&r[a]<r[a+1]&&r[a]<r[a-1]&&(h=(s-1)*n+f,r[a]<r[h-1]&&r[a]<r[h]&&r[a]<r[h+1]&&(h=(s+1)*n+f,r[a]<r[h-1]&&r[a]<r[h]&&r[a]<r[h+1]&&u.push({x:f,y:s,z:t[a]}))));return u},extractArea:function(t,r,e,n,o,i,s,f){var u=Math.floor(n/i),h=n%i,l=[];this.scanBitmask(e,o,i,u,h,l);var c=new Array(l.length),p=new Array(l.length),g=new Array(l.length),m=l.length,v=0,y=0,d=0;if(m>=9){this.DEBUG&&console.log("nValues="+m);for(var w=Number.NEGATIVE_INFINITY,M=-1,b=0;m>b;b++){var x=l.splice(0,1)[0];c[b]=x[0],p[b]=x[1],g[b]=t[x[1]*i+x[0]],v+=c[b]*g[b],y+=p[b]*g[b],d+=g[b],g[b]>w&&(w=g[b],M=b)}if(-1!=M){v/=d,y/=d;var A,S={x:v,y:y,z:d};A=a.minMax(c),S.minX=A.min,S.maxX=A.max,A=a.minMax(p),S.minY=A.min,S.maxY=A.max,s.push(S)}}return m},scanBitmask:function(t,r,e,n,o,i){0>n||0>o||o==e||n==r||t[n*e+o]&&(t[n*e+o]=0,i.push([o,n]),this.scanBitmask(t,r,e,n+1,o,i),this.scanBitmask(t,r,e,n-1,o,i),this.scanBitmask(t,r,e,n,o+1,i),this.scanBitmask(t,r,e,n,o-1,i))},createSignals2D:function(t,r,e){for(var n=[],o=(r.getNbSubSpectra(),r.observeFrequencyX()),a=r.observeFrequencyY(),s=r.getFirstY(),f=(r.getLastY(),r.getDeltaY()),u=t.length-1;u>=0;u--)t[u].x=r.arrayPointToUnits(t[u].x),t[u].y=s+f*t[u].y,(t[u].y<-1||t[u].y>=210)&&t.splice(u,1);var h=[],l=0;e*=e;for(var u=0;u<t.length;u++)for(var c=u;c<t.length;c++)l=Math.pow((t[u].x-t[c].x)*o,2)+Math.pow((t[u].y-t[c].y)*a,2),e>l?h.push(1):h.push(0);var p=i.fullClusterGenerator(h),n=[];if(null!=t)for(var g=0;g<p.length;g++){var m={nucleusX:r.getNucleus(1),nucleusY:r.getNucleus(2)};m.resolutionX=(r.getLastX()-r.getFirstX())/r.getNbPoints(),m.resolutionY=f;var v=[];m.shiftX=0,m.shiftY=0;for(var y=0,d=p[g].length-1;d>=0;d--)1==p[g][d]&&(v.push(t[d]),m.shiftX+=t[d].x*t[d].z,m.shiftY+=t[d].y*t[d].z,y+=t[d].z);m.shiftX/=y,m.shiftY/=y,m.peaks=v,n.push(m)}return n}};t.exports=f},function(t,r,e){"use strict";r.FFTUtils=e(45),r.FFT=e(46)},function(t,r,e){var n=e(46),o={DEBUG:!1,ifft2DArray:function(t,r,e){var o=new Array(r*e),i=r/2,a=2*(e-1);n.init(i);for(var s={re:new Array(i),im:new Array(i)},f=0;e>f;f++){for(var u=i-1;u>=0;u--)s.re[u]=t[2*u*e+f],s.im[u]=t[(2*u+1)*e+f];n.bt(s.re,s.im);for(var u=i-1;u>=0;u--)o[2*u*e+f]=s.re[u],o[(2*u+1)*e+f]=s.im[u]}var h=new Array(i*a);n.init(a);for(var l={re:new Array(a),im:new Array(a)},c=a*i,u=0;r>u;u+=2){l.re[0]=o[u*e],l.im[0]=o[(u+1)*e];for(var f=1;e>f;f++)l.re[f]=o[u*e+f],l.im[f]=o[(u+1)*e+f],l.re[a-f]=o[u*e+f],l.im[a-f]=-o[(u+1)*e+f];n.bt(l.re,l.im);for(var p=u/2*a,f=a-1;f>=0;f--)h[p+f]=l.re[f]/c}return h},fft2DArray:function(t,r,e){var o=e/2+1,i=2*r,a=new Array(i*o);n.init(e);for(var s,f,u,h,l,c={re:new Array(e),im:new Array(e)},p={re:new Array(e),im:new Array(e)},g={re:new Array(e),im:new Array(e)},m=0;r/2>m;m++){s=2*m*e,c.re=t.slice(s,s+e),s=(2*m+1)*e,c.im=t.slice(s,s+e),n.fft1d(c.re,c.im),this.reconstructTwoRealFFT(c,p,g),f=4*m*o,u=(4*m+1)*o,h=(4*m+2)*o,l=(4*m+3)*o;for(var v=o-1;v>=0;v--)a[f+v]=p.re[v],a[u+v]=p.im[v],a[h+v]=g.re[v],a[l+v]=g.im[v]}p=null,g=null;var y=new Array(i*o);n.init(r);for(var d={re:new Array(r),im:new Array(r)},w=o-1;w>=0;w--){for(var m=r-1;m>=0;m--)d.re[m]=a[2*m*o+w],d.im[m]=a[(2*m+1)*o+w];n.fft1d(d.re,d.im);for(var m=r-1;m>=0;m--)y[2*m*o+w]=d.re[m],y[(2*m+1)*o+w]=d.im[m]}return y},reconstructTwoRealFFT:function(t,r,e){var n=t.re.length;r.re[0]=t.re[0],r.im[0]=0,e.re[0]=t.im[0],e.im[0]=0;for(var o,i,a,s,f,u=n/2;u>0;u--)f=n-u,o=.5*(t.re[u]-t.re[f]),i=.5*(t.re[u]+t.re[f]),a=.5*(t.im[u]-t.im[f]),s=.5*(t.im[u]+t.im[f]),r.re[u]=i,r.im[u]=a,r.re[f]=i,r.im[f]=-a,e.re[u]=s,e.im[u]=-o,e.re[f]=s,e.im[f]=o},convolute2DI:function(t,r,e,n){for(var o,i,a=0;e/2>a;a++)for(var s=0;n>s;s++)o=t[2*a*n+s]*r[2*a*n+s]-t[(2*a+1)*n+s]*r[(2*a+1)*n+s],i=t[2*a*n+s]*r[(2*a+1)*n+s]+t[(2*a+1)*n+s]*r[2*a*n+s],t[2*a*n+s]=o,t[(2*a+1)*n+s]=i},convolute:function(t,r,e,n){for(var o=new Array(n*e),i=0;e*n>i;i++)o[i]=t[i];o=this.fft2DArray(o,e,n);for(var a=r.length,s=new Array(n*e),i=0;n*e>i;i++)s[i]=0;for(var f,u,h=(a-1)/2,l=0;a>l;l++){f=(l-h+e)%e;for(var c=0;a>c;c++)u=(c-h+n)%n,s[f*n+u]=r[l][c]}s=this.fft2DArray(s,e,n);var p=2*e,g=n/2+1;return this.convolute2DI(o,s,p,g),this.ifft2DArray(o,p,g)}};t.exports=o},function(t,r,e){(function(){var t;t=r;var e={release:"0.3.0",date:"2013-03"};t.toString=function(){return"version "+e.release+", released "+e.date};for(var n=0,o=null,i=null,a={init:function(t){if(0===t||0!==(t&t-1))throw new Error("init: radix-2 required");n=t,a._initArray(),a._makeBitReversalTable(),a._makeCosSinTable()},fft1d:function(t,r){a.fft(t,r,1)},ifft1d:function(t,r){var e=1/n;a.fft(t,r,-1);for(var o=0;n>o;o++)t[o]*=e,r[o]*=e},bt1d:function(t,r){a.fft(t,r,-1)},fft2d:function(t,r){for(var e=[],o=[],i=0,s=0;n>s;s++){i=s*n;for(var f=0;n>f;f++)e[f]=t[f+i],o[f]=r[f+i];a.fft1d(e,o);for(var u=0;n>u;u++)t[u+i]=e[u],r[u+i]=o[u]}for(var h=0;n>h;h++){for(var l=0;n>l;l++)i=h+l*n,e[l]=t[i],o[l]=r[i];a.fft1d(e,o);for(var c=0;n>c;c++)i=h+c*n,t[i]=e[c],r[i]=o[c]}},ifft2d:function(t,r){for(var e=[],o=[],i=0,s=0;n>s;s++){i=s*n;for(var f=0;n>f;f++)e[f]=t[f+i],o[f]=r[f+i];a.ifft1d(e,o);for(var u=0;n>u;u++)t[u+i]=e[u],r[u+i]=o[u]}for(var h=0;n>h;h++){for(var l=0;n>l;l++)i=h+l*n,e[l]=t[i],o[l]=r[i];a.ifft1d(e,o);for(var c=0;n>c;c++)i=h+c*n,t[i]=e[c],r[i]=o[c]}},fft:function(t,r,e){for(var a,s,f,u,h,l,c,p,g,m=n>>2,v=0;n>v;v++)u=o[v],u>v&&(h=t[v],t[v]=t[u],t[u]=h,h=r[v],r[v]=r[u],r[u]=h);for(var y=1;n>y;y<<=1){s=0,a=n/(y<<1);for(var d=0;y>d;d++){l=i[s+m],c=e*i[s];for(var w=d;n>w;w+=y<<1)f=w+y,p=l*t[f]+c*r[f],g=l*r[f]-c*t[f],t[f]=t[w]-p,t[w]+=p,r[f]=r[w]-g,r[w]+=g;s+=a}}},_initArray:function(){o="undefined"!=typeof Uint32Array?new Uint32Array(n):[],i="undefined"!=typeof Float64Array?new Float64Array(1.25*n):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,r=0,e=0;for(o[0]=0;++t<n;){for(e=n>>1;r>=e;)r-=e,e>>=1;r+=e,o[t]=r}},_makeCosSinTable:function(){var t=n>>1,r=n>>2,e=n>>3,o=t+r,a=Math.sin(Math.PI/n),s=2*a*a,f=Math.sqrt(s*(2-s)),u=i[r]=1,h=i[0]=0;a=2*s;for(var l=1;e>l;l++)u-=s,s+=a*u,h+=f,f-=a*h,i[l]=h,i[r-l]=u;0!==e&&(i[e]=Math.sqrt(.5));for(var c=0;r>c;c++)i[t-c]=i[c];for(var p=0;o>p;p++)i[p+t]=-i[p]}},s=["init","fft1d","ifft1d","fft2d","ifft2d"],f=0;f<s.length;f++)t[s[f]]=a[s[f]];return t.bt=a.bt1d,t.fft=a.fft1d,t.ifft=a.ifft1d,t}).call(this)},function(t,r){var e={diagonalError:.05,tolerance:.05,DEBUG:!1,toleranceX:.025,toleranceY:.5,clean:function(t,r){var e,n=Number.NEGATIVE_INFINITY;for(e=t.length-1;e>=0;e--)Math.abs(t[e].z)>n&&(n=Math.abs(t[e].z));for(n*=r,e=t.length-1;e>=0;e--)Math.abs(t[e].z)<n&&t.splice(e,1);return t},enhanceSymmetry:function(t){var r=this.initializeProperties(t),e=t;this.DEBUG&&console.log("Before optimization size: "+e.size());var n,o,i,a;for(n=e.length-1;n>=0;n--)a=e[n],a.peaks.length>1&&r[n][1]++,1==r[n][0]&&(i=this.exist(e,r,a,-1,!0),i>=0&&(r[n][1]+=2,r[i][1]+=2));for(n=e.length-1;n>=0;n--)a=e[n],0==r[n][0]&&(o=this.checkCrossPeaks(e,r,a,!0),r[n][1]+=o);var s=0;for(n=e.length-1;n>=0;n--)0!==r[n][0]&&r[n][1]>2&&(s++,s+=this.completeMissingIfNeeded(e,r,e[n],r[n])),r[n][1]>=2&&0===r[n][0]&&s++;this.DEBUG&&console.log("After optimization size: "+s);var f=new Array(s);for(s--,n=e.length-1;n>=0;n--)0!==r[n][0]&&r[n][1]>2||0===r[n][0]&&r[n][1]>1?f[s--]=e[n]:console.log("Removed "+n+" "+e[n].peaks.length);return f},completeMissingIfNeeded:function(t,r,e,n){var o=this.exist(t,r,e,-n[0],!0),i=0,a=null,s=null;0>o&&(a={nucleusX:e.nucleusX,nucleusY:e.nucleusY},a.resolutionX=e.resolutionX,a.resolutionY=e.resolutionY,a.shiftX=e.shiftY,a.shiftY=e.shiftX,a.peaks=[{x:e.shiftY,y:e.shiftX,z:1}],t.push(a),s=[-n[0],n[1]],r.push(s),i++);var f,u=0,h=!1,l=!1;for(u=t.length-1;u>=0;u--)f=t[u],0===r[u][0]&&(Math.abs(f.shiftX-e.shiftX)<this.diagonalError&&(h=!0),Math.abs(f.shiftY-e.shiftY)<this.diagonalError&&(l=!0));return h===!1&&(a={nucleusX:e.nucleusX,nucleusY:e.nucleusY},a.resolutionX=e.resolutionX,a.resolutionY=e.resolutionY,a.shiftX=e.shiftX,a.shiftY=e.shiftX,a.peaks=[{x:e.shiftX,y:e.shiftX,z:1}],t.push(a),s=[0,n[1]],r.push(s),i++),l===!1&&(a={nucleusX:e.nucleusX,nucleusY:e.nucleusY},a.resolutionX=e.resolutionX,a.resolutionY=e.resolutionY,a.shiftX=e.shiftY,a.shiftY=e.shiftY,a.peaks=[{x:e.shiftY,y:e.shiftY,z:1}],t.push(a),s=[0,n[1]],r.push(s),i++),i},checkCrossPeaks:function(t,r,e,n){var o,i=0,a=0,s=4*e.shiftX,f=[],u=[];for(a=t.length-1;a>=0;a--)o=t[a],0!==r[a][0]&&(Math.abs(o.shiftX-e.shiftX)<this.diagonalError?(i++,n&&r[a][1]++,f.push(a),s+=o.shiftX):Math.abs(o.shiftY-e.shiftY)<this.diagonalError&&(i++,n&&r[a][1]++,u.push(a),s+=o.shiftY));if(s/=f.length+u.length+4,f.length>0)for(a=f.length-1;a>=0;a--)t[f[a]].shiftX=s;if(u.length>0)for(a=u.length-1;a>=0;a--)t[u[a]].shiftY=s;return e.shiftX=s,e.shiftY=s,i},exist:function(t,r,e,n,o){for(var i=t.length-1;i>=0;i--)if(r[i][0]==n&&this.distanceTo(e,t[i],o)<this.tolerance){if(o){var a=e.shiftX,s=t[i].shiftX;t[i].shiftY=a,e.shiftY=s}else{var a=(t[i].shiftX+e.shiftX)/2,s=(t[i].shiftY+e.shiftY)/2;t[i].shiftX=a,t[i].shiftY=s,e.shiftX=a,e.shiftY=s}return i}return-1},initializeProperties:function(t){for(var r=new Array(t.length),e=t.length-1;e>=0;e--)if(r[e]=[0,0],Math.abs(t[e].shiftX-t[e].shiftY)<=this.diagonalError){r[e][1]=1;var n=(2*t[e].shiftX+t[e].shiftY)/3;t[e].shiftX=n,t[e].shiftY=n}else t[e].shiftX-t[e].shiftY>0?r[e][0]=1:r[e][0]=-1;return r},distanceTo:function(t,r,e){return e?Math.sqrt(Math.pow(t.shiftX-r.shiftY,2)+Math.pow(t.shiftY-r.shiftX,2)):Math.sqrt(Math.pow(t.shiftX-r.shiftX,2)+Math.pow(t.shiftY-r.shiftY,2))},alignDimensions:function(t,r){for(var e=0;e<r.length;e++){var n=r[e];n&&this._alignSingleDimension(t,n)}},_alignSingleDimension:function(t,r){var e,n,o=0,i=0;for(e=0;e<t.length;e++){var a=t[e];for(n=0;n<r.length;n++)o=(r[n].startX+r[n].stopX)/2,i=Math.abs(r[n].startX-r[n].stopX)/2,a.nucleusX==r[n].nucleus&&Math.abs(a.shiftX-o)<=i&&a._highlight.push(r[n]._highlight[0]),
a.nucleusY==r[n].nucleus&&Math.abs(a.shiftY-o)<=i&&a._highlight.push(r[n]._highlight[0])}}};t.exports=e},function(t,r){var e={fullClusterGenerator:function(t){var r=Math.sqrt(2*t.length+.25)-.5,e=[],n=new Array(r),o=r,i=0,a=[];for(i=r-1;i>=0;i--)n[i]=1;for(var s=-1,f=[];o>0;){if(0===f.length){for(a=new Array(r),i=r-1;i>=0;i--)a[i]=0;for(e.push(a),s=r-1;0==n[s];s--);}else s=f.splice(0,1);a[s]=1,n[s]=0,o--;var u=new Array(r);for(i=r-1;i>=0;i--){var h=Math.max(s,i),l=Math.min(s,i);u[i]=t[l*(2*r-l-1)/2+h],1==u[i]&&1==n[i]&&0==a[i]&&(f.push(i),a[i]=1)}}return e}};t.exports=e},function(t,r){var e=e||{};e.formater=function(){function t(t,e){m="",v="",y="";var n=null;return e&&e.solvent&&(n=e.solvent),e&&void 0!=e.rangeForMultiplet&&(rangeForMultiplet=e.rangeForMultiplet),e&&e.ascending?t.sort(function(t,r){return r.delta1-t.delta1}):t.sort(function(t,r){return t.delta1-r.delta1}),t.type="NMR SPEC","1H"==t[0].nucleus?r(t,!1,2,1,n):"13C"==t[0].nucleus&&r(t,!1,1,0,n),m.length>0&&(m+="."),m}function r(t,r,i,a,s){c(),e(t,s);for(var f=t.length,u=0;f>u;u++){if(r)var h=t[u];else var h=t[f-u-1];h&&(c(),n(h,i),o(h,a))}}function e(t,r){"NMR SPEC"==t.type?(t[0].nucleus&&(m+=l(t[0].nucleus)),m+=" NMR",(r||t[0].observe)&&(m+=" (",t[0].observe&&(m+=(1*t[0].observe).toFixed(0)+" MHz",r&&(m+=", ")),r&&(m+=h(r)),m+=")"),m+=" δ "):"IR"==t.type?m+=" IR ":"MASS"==t.type&&(m+=" MASS ")}function n(t,r){var e=0,n=0,o=0;t.startX&&(e="string"==typeof t.startX?parseFloat(t.startX):t.startX),t.stopX&&(n="string"==typeof t.stopX?parseFloat(t.stopX):t.stopX),t.delta1&&(o="string"==typeof t.delta1?parseFloat(t.delta1):t.delta1),t.asymmetric===!0||"m"==t.multiplicity&&rangeForMultiplet===!0?t.startX&&t.stopX?m+=n>e?e.toFixed(r)+"-"+n.toFixed(r):n.toFixed(r)+"-"+e.toFixed(r):t.delta1&&(m+=o.toFixed(r)):t.delta1?m+=o.toFixed(r):t.startX&&t.stopX&&(m+=((e+n)/2).toFixed(r))}function o(t,r){v="",s(t),i(t),f(t,r),a(t),v.length>0&&(m+=" ("+v+")")}function i(t){t.pubIntegration?(p(),v+=t.pubIntegration):t.integralData&&(p(),v+=t.integralData.value.toFixed(0)+" H")}function a(t){t.pubAssignment?(p(),v+=u(t.pubAssignment)):t.assignment&&(p(),v+=u(t.assignment))}function s(t){t.pubMultiplicity?(p(),v+=t.pubMultiplicity):t.multiplicity&&(p(),v+=t.multiplicity)}function f(t,r){if(t.nmrJs){for(var e="<i>J</i> = ",n=0;n<t.nmrJs.length;n++){var o=t.nmrJs[n].coupling;e.length>11&&(e+=", "),e+=o.toFixed(r)}p(),v+=e+" Hz"}}function u(t){return t=t.replace(/([0-9])/g,"<sub>$1</sub>"),t=t.replace(/\"([^\"]*)\"/g,"<i>$1</i>")}function h(t){return t=t.replace(/([0-9])/g,"<sub>$1</sub>")}function l(t){return t=t.replace(/([0-9])/g,"<sup>$1</sup>")}function c(){m.length>0&&!m.match(/ $/)&&(m+=", ")}function p(){v.length>0&&!v.match(", $")&&(v+=", ")}function g(t){return JSON.parse(SDAPI.AcsParserAsJSONString(t))}var m="",v="",y="";return rangeForMultiplet=!1,{toACS:t,toNMRSignal:g}}(),t.exports=e}])});
//# sourceMappingURL=spectra-data.min.js.map